<!DOCTYPE html>
<html lang="utf-8">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	
		<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)'], ['$', '$']]        
    }
  };
</script>
	
	
    
    <title>文献_定量药理学中的协变量建模_附件1和附件2 - Yongchao Fu | 付永超</title>
    <meta property="og:title" content="文献_定量药理学中的协变量建模_附件1和附件2 - Yongchao Fu | 付永超">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="原文链接：https://ascpt.onlinelibrary.wiley.com/doi/10.1002/psp4.13115
原文作者：Kinjal Sanghavi, Jakob Ribbing, James A. Rogers, Mariam A. Ahmed, Mats O. Karlsson, Nick Holford, Estelle Chasseloup, Malidi &amp;hellip;">
      <meta property="og:description" content="原文链接：https://ascpt.onlinelibrary.wiley.com/doi/10.1002/psp4.13115
原文作者：Kinjal Sanghavi, Jakob Ribbing, James A. Rogers, Mariam A. Ahmed, Mats O. Karlsson, Nick Holford, Estelle Chasseloup, Malidi &amp;hellip;">
      
    

    
    

    


<link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
<script async src="/js/load-typekit.js"></script>


<link rel="stylesheet" href="/css/custom.css" />

  </head>

  
  <body class="cn">
    <header class="masthead">
      

<h1><a href="/"><img src="/images/logo.png" alt="Yongchao Fu" /></a></h1>



      <nav class="menu">
  <ul>
  
  
  <li><a href="/">主页</a></li>
  
  <li><a href="/cn/about/">关于</a></li>
  
  <li><a href="/cn/">博客</a></li>
  
  <li><a href="/cn/vitae/">简历</a></li>
  
  <li><a href="/en/">English</a></li>
  
  <li><a href="/cn/gift/">捐助</a></li>
  
  

<li class="menu-extra"></li>



<li><a href="https://github.com/s0521/Phoenix/edit/master/content/cn/2024/06/%e6%96%87%e7%8c%ae_%e5%ae%9a%e9%87%8f%e8%8d%af%e7%90%86%e5%ad%a6%e4%b8%ad%e7%9a%84%e5%8d%8f%e5%8f%98%e9%87%8f%e5%bb%ba%e6%a8%a1_%e9%99%84%e4%bb%b61%e5%92%8c%e9%99%84%e4%bb%b62.md" target="_blank">编辑</a></li>


<li><a href="/cn/index.xml" type="application/rss+xml" title="RSS feed">订阅</a></li>

<li><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="Attribution-NonCommercial-ShareAlike 4.0 International">版权</a></li>


  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>文献_定量药理学中的协变量建模_附件1和附件2</h1>


<h3>付永超 / 
2024-06-24</h3>

<hr>


      </header>


<p><strong>原文链接</strong>：https://ascpt.onlinelibrary.wiley.com/doi/10.1002/psp4.13115</p>
<p><strong>原文作者</strong>：Kinjal Sanghavi, Jakob Ribbing, James A. Rogers, Mariam A. Ahmed, Mats O. Karlsson, Nick Holford, Estelle Chasseloup, Malidi Ahamadi, Kenneth G. Kowalski, Susan Cole, Essam Kerwash, Janet R. Wade, Chao Liu, Yaning Wang, Mirjam N. Trame, Hao Zhu, Justin J. Wilkins, for the ISoP Standards &amp; Best Practices Committee</p>
<p><strong>原文协议</strong>：CC BY-NC 4.0</p>
<p><strong>译者注</strong>：主要由Edge浏览器自带的网页翻译功能翻译，译者额外校对了部分词汇的中文翻译比如“pharmacodynamics”在本文应翻译为“药效动力学”，而不是“药效学”。</p>
<p>目录</p>
<p><nav id="TableOfContents">
  <ul>
    <li><a href="#附件一">附件一：</a></li>
    <li><a href="#1-引言">1 引言</a></li>
    <li><a href="#2-茶碱数据">2 茶碱数据</a>
      <ul>
        <li><a href="#21-数据说明">2.1 数据说明</a></li>
        <li><a href="#22--图形探索">2.2  图形探索</a>
          <ul>
            <li><a href="#221-因变量意大利面条图">2.2.1 因变量：意大利面条图</a></li>
            <li><a href="#222-协变量散点图矩阵">2.2.2 协变量：散点图矩阵</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#3模型">3模型</a>
      <ul>
        <li><a href="#31出版物中的模型">3.1出版物中的模型</a></li>
        <li><a href="#32---不带协变量的基础模型">3.2   不带协变量的基础模型</a></li>
        <li><a href="#33-全固定效应模型ffem">3.3 全固定效应模型(FFEM)</a></li>
        <li><a href="#34-用于协变量模型的函数形式">3.4 用于协变量模型的函数形式</a></li>
      </ul>
    </li>
    <li><a href="#4-基于模型的协变量筛选">4 基于模型的协变量筛选</a>
      <ul>
        <li><a href="#41协变量与单个随机效应">4.1协变量与单个随机效应</a></li>
        <li><a href="#42-广义加和模型-gam-generalized-additive-model-">4.2 广义加和模型 （GAM, Generalized additive model ）</a></li>
        <li><a href="#43-瓦尔德近似法wam-wald-approximation-method">4.3 瓦尔德近似法(WAM, Wald approximation method)</a></li>
        <li><a href="#44-逐步协变量建模scm-stepwise-covariate-modelling">4.4 逐步协变量建模(SCM, Stepwise covariate modelling)</a></li>
        <li><a href="#45-最小绝对收缩和选择算法lasso-the-least-absolute-shrinkage-and-selection-operator">4.5 最小绝对收缩和选择算法（LASSO, The Least absolute shrinkage and selection operator）</a></li>
        <li><a href="#46---全随机效应模型frem-full-random-effect-model">4.6   全随机效应模型（FREM, Full random effect model）</a></li>
      </ul>
    </li>
    <li><a href="#5-协变量效应的模型诊断">5 协变量效应的模型诊断</a></li>
    <li><a href="#6-协变量效应总结和报告">6 协变量效应总结和报告</a></li>
    <li><a href="#7参考文献中文翻译">7.参考文献(中文翻译)</a></li>
    <li><a href="#7-参考文献英文原文">7 参考文献(英文原文)</a></li>
    <li><a href="#8-附录">8 附录</a>
      <ul>
        <li><a href="#a-nonmem代码">A NONMEM代码</a>
          <ul>
            <li><a href="#a1--出版物中的协变量模型covariate-model-from-the-publication-run20">A.1  出版物中的协变量模型(Covariate model from the publication) (run20)</a></li>
            <li><a href="#a2--基础模型base-model-run11">A.2  基础模型(Base model) (run11)</a></li>
            <li><a href="#a3--ffem-run22">A.3  FFEM (run22)</a></li>
            <li><a href="#a4--wam-run24">A.4  WAM (run24)</a></li>
            <li><a href="#a5--最终的lasso模型final-lasso-model-run26">A.5  最终的LASSO模型(Final LASSO model) (run26)</a></li>
            <li><a href="#a6--最终的scm模型final-scm-model-run25">A.6  最终的SCM模型(Final SCM model) (run25)</a></li>
            <li><a href="#a7--最终的frem模型final-frem-model-run28">A.7  最终的FREM模型(Final FREM model) (run28)</a></li>
          </ul>
        </li>
        <li><a href="#b-r代码">B R代码</a>
          <ul>
            <li><a href="#b1--数据管理data-management">B.1  数据管理(Data management)</a></li>
            <li><a href="#b2--数值摘要numerical-summary">B.2  数值摘要(Numerical summary)</a></li>
            <li><a href="#b3--茶碱数据文件详情theophylline-data-file-details">B.3  茶碱数据文件详情(Theophylline data file details)</a></li>
            <li><a href="#b4--意大利面条图spaghettis-plots">B.4  意大利面条图(Spaghettis plots)</a></li>
            <li><a href="#b5--散点图矩阵scatter-plot-matrix">B.5  散点图矩阵(Scatter plot matrix)</a></li>
            <li><a href="#b6--拟合优度图goodness-of-fit-plots">B.6  拟合优度图(Goodness-of-fit plots)</a></li>
            <li><a href="#b7--协变量对经验贝叶斯估计值图covariates-vs-ebes">B.7  协变量对经验贝叶斯估计值图(Covariates vs EBEs)</a></li>
            <li><a href="#b8--协变量对η抽样值图covariates-vs-η-samples">B.8  协变量对η抽样值图(Covariates vs η samples)</a></li>
            <li><a href="#b9--gam图">B.9  GAM图</a></li>
            <li><a href="#b10-wam">B.10 WAM</a></li>
            <li><a href="#b11-scm">B.11 SCM</a></li>
            <li><a href="#b12-frem">B.12 FREM</a></li>
            <li><a href="#b13-森林图forest-plots">B.13 森林图(Forest plots)</a></li>
            <li><a href="#b14-vpcs">B.14 VPCs</a></li>
          </ul>
        </li>
        <li><a href="#c-添加包与环境libraries-and-environment">C 添加包与环境(Libraries and environment)</a></li>
      </ul>
    </li>
    <li><a href="#附件二">附件二：</a></li>
    <li><a href="#组合协变量关系的示例">组合协变量关系的示例</a></li>
    <li><a href="#参考文献中文翻译">参考文献(中文翻译):</a></li>
    <li><a href="#参考文献英文原文">参考文献(英文原文):</a></li>
  </ul>
</nav></p>
<h1 id="附件一">附件一：</h1>
<p><strong>图示ISOP的最佳实践：定量药理学中的协变量分析——使用茶碱数据案例研究</strong></p>
<h1 id="1-引言">1 引言</h1>
<p>本文档在一定程度上说明了本文中介绍的不同协变量选择方法。使用真实的纵向药效动力学数据：在给予药物茶碱的临床试验期间收集的“呼气峰值流速（PEFR, peak expiratory flow rate）”测量值。该文档分为介绍数据（第2节）、模型（第3节）、不同协变量选择方法的结果（第4节）、诊断协变量效应的一些示例（第5节）以及如何呈现协变量模型的示例（第6节）。模型部分仅详细介绍了已发布的带有协变量的模型，该模型用作这项工作的起点[1]，没有协变量的衍生基础模型用作大多数协变量选择方法的起点，以及完整的固定效应模型（FFEM）。但是，所有代码都在文档的附录中报告：附录A中的NONMEM模型代码，附录B中的R代码。</p>
<p>协变量模型的默认参数化方式会因所选方法中的可用实现而不同。</p>
<h1 id="2-茶碱数据">2 茶碱数据</h1>
<h2 id="21-数据说明">2.1 数据说明</h2>
<p>茶碱数据由NickHolford提供[1,2]。细节和实验设计详见其他地方报道[2]，摘要如下。用于准备分析数据的R代码可在附录B.1中找到。从数据集中删除了缺失信息的行，缺失信息的范围在初始出版物中提供[1]。本说明练习仅保留了四个协变量（两个分类和两个连续）。</p>
<p>符合静脉注射茶碱治疗条件的急性气道阻塞患者被随机分配到目标浓度为10或20mg/L的双盲试验中。初始剂量和随后的调整由每位患者的医生使用实际茶碱浓度的缩放报告确定，以保持盲法但模仿实际临床实践。在最初的24小时内多次获得“呼气峰值流速（PEFR, peak expiratory flow rate）”和茶碱浓度，并且至少每天获得一次，直到出院。</p>
<p>表S1提供了数值描述。每个受试者的平均采样次数为4次。用于计算数值汇总的R代码在附录B.2中提供，有关数据文件的更多详细信息见附录B.3：表S9中对数据文件的描述，以及表S10中前十行的概述。</p>
<p>表格 S1：茶碱数据集的数值描述</p>
<table>
<thead>
<tr>
<th>变量</th>
<th>类别</th>
<th>度量*</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>因变量(526个观测值)</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>茶碱浓度(mg/L)</td>
<td></td>
<td>13 (8, 18)</td>
</tr>
<tr>
<td>呼气峰值流速(PEFR, L/min)</td>
<td></td>
<td>220 (160, 300)</td>
</tr>
<tr>
<td><strong>连续协变量(132个受试者)</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>年龄(years)</td>
<td></td>
<td>34.5 (21.0, 55.0)</td>
</tr>
<tr>
<td>体重(kg)</td>
<td></td>
<td>66.0 (56.0, 76.0)</td>
</tr>
<tr>
<td><strong>分类协变量(132个受试者)</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>性别</td>
<td>0:女性</td>
<td>82.0 (62.1%)</td>
</tr>
<tr>
<td></td>
<td>1:男性</td>
<td>50.0 (37.9%)</td>
</tr>
<tr>
<td>诊断</td>
<td>1:哮喘</td>
<td>108.0 (81.8%)</td>
</tr>
<tr>
<td></td>
<td>2:慢性阻塞性肺病</td>
<td>22.0 (16.7%)</td>
</tr>
<tr>
<td></td>
<td>3: COPD和哮喘</td>
<td>2.0 (1.5%)</td>
</tr>
</tbody>
</table>
<p>* 连续变量的中位数（四分位距）;n（%） 表示分类变量。</p>
<h2 id="22--图形探索">2.2  图形探索</h2>
<h3 id="221-因变量意大利面条图">2.2.1 因变量：意大利面条图</h3>
<p>观察到的药效动力学数据（即PEFR）与时间的关系图如图S1所示，与浓度的关系图如图S2所示。用于图S2的R代码可在附录B.4中找到。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image002.png" alt="img">
图S1：观察到的“呼气峰值流速（PEFR, peak expiratory flow rate）”与时间的关系。点代表观测值，每个人的观测值都由一条线连接。红线是平滑的。数据使用正常比例显示，在前100小时（中面板）上缩放，在前25小时（右面板）上缩放。PEFR：峰值呼气流速。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image004.png" alt="img">
图S2：观察到的“呼气峰值流速（PEFR, peak expiratory flow rate）”与观察到的茶碱血清浓度。点代表观测值，每个人的观测值都由一条线连接。红线是平滑的。数据使用正常比例显示。PEFR：峰值呼气流速。</p>
<h3 id="222-协变量散点图矩阵">2.2.2 协变量：散点图矩阵</h3>
<p>散点图矩阵（图S3）显示了每对协变量之间的关系。用于生成散点图矩阵的R代码在附录B.5中提供。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image006.png" alt="img">
图S3：对每对可用协变量之间关系的可视化探索。对角线图表示每个协变量的分布。</p>
<h1 id="3模型">3模型</h1>
<p>“呼气峰值流速（PEFR, peak expiratory flow rate）”的药效动力学模型是根据先前的出版物[1]开发的，没有（run11）或协变量（run20）。从无协变量的模型出发，根据不同的协变量选择方法构建了不同的协变量模型，以提供说明性算例。获得的不同模型以及最终参数数列在表S4中。</p>
<h2 id="31出版物中的模型">3.1出版物中的模型</h2>
<p>先前在已发表的论文中的参数模型被复制为表S4中的run20。参数值如表S2所示，NONMEM代码见附录A.1。此处显示的run20与已发布的模型不同，因为通过删除缺少数据的行来减小数据集。</p>
<p>如已发表的论文所述，支气管狭窄因子（BCF，broncho-constriction factor）通过一阶过程消除，其特征是半衰期T50和基线BCF0值（方程（1））。根据方程（2）中描述的抑制性药效动力学模型，PEFR（t）是由于BCF引起的支气管收缩，与BCF浓度有关，其中Normal是BCF为零时的PEFR，C50BCF是使PEFR从正常降低50%的浓度。假设Base是t=0时的PEFR，方程（3）给出了此时BCF的浓度（BCF0）。茶碱对PEFR的影响仅限于低于正常的PEFR，并根据方程（4）表示，其中C50_Theo是茶碱浓度C产生50%的潜在可回收PEFR时的值，Hill是控制曲线陡峭度的指数。BCF和茶碱对PEFR的综合影响可以通过时间和茶碱浓度的函数来预测，如式（5），其中ε_theo描述了茶碱相对于BCF介导的时间效应的疗效。</p>
<p>所有协变量均线性添加到Normal典型值。分类诊断协变量作为连续协变量包含在已发布的模型中，使用分配给每个类别的数值。在本文档中提供的示例中，只要有可能，它就被作为分类协变量包含在内。</p>
$$
BCF (t) = BCF0 \cdot e^{(-ln(2)/(T50 \cdot))} \tag{1}
$$
$$
PEFR(t) = Normal \cdot [ 1- \frac{BCF(t)}{BCF(t)+C50_{BCF}} ] \tag{2}
$$
$$
BCF_0=C50_{BCF} \cdot ( Normal/Base -1 ) \tag{3}
$$
$$
PEFR(c,t) = [Normal – PEFR(t)] \cdot \frac{C^{Hill}}{ C^{Hill} + C^{Hill}_{Theo} } \tag{4}
$$
$$
PEFR = PEFR(t) + ε_{theo} \cdot PEFR(c,t) \tag{5}
$$
<p>表格 S2: 出版物中的协变量模型参数表（run20）.</p>
<table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th>描述</th>
<th>单位</th>
<th>数值</th>
<th>相对标准误*</th>
<th>收缩值 (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Base</td>
<td>基线时的呼气峰值流速(PEFR)</td>
<td>L/min</td>
<td>136</td>
<td>0.0642</td>
<td>-</td>
</tr>
<tr>
<td style="text-align:center">Normal</td>
<td>在不包含支气管狭窄因子(BCF)下的呼气峰值流速(PEFR)†</td>
<td>L/min</td>
<td>481</td>
<td>0.0621</td>
<td>-</td>
</tr>
<tr>
<td style="text-align:center"><em>T</em>50</td>
<td>支气管狭窄因子(BCF)的半衰期</td>
<td>h</td>
<td>19.6</td>
<td>0.263</td>
<td>-</td>
</tr>
<tr>
<td style="text-align:center"><em>C</em>50</td>
<td>生产50%的可回收呼气峰值流速(PEFR)时的茶碱浓度</td>
<td>mg/L</td>
<td>8.48</td>
<td>0.268</td>
<td>-</td>
</tr>
<tr>
<td style="text-align:center"><em>ε**theo</em></td>
<td>茶碱相对于支气管狭窄因子(BCF)效应的疗效</td>
<td>-</td>
<td>0.373</td>
<td>0.197</td>
<td>-</td>
</tr>
<tr>
<td style="text-align:center">Hill exponent</td>
<td>曲线陡度指数</td>
<td>-</td>
<td>2.59</td>
<td>0.3</td>
<td>-</td>
</tr>
<tr>
<td style="text-align:center">Diagnosis on Normal</td>
<td>每个类别的典型值分数</td>
<td>-</td>
<td>0.202</td>
<td>0.174</td>
<td>-</td>
</tr>
<tr>
<td style="text-align:center">Female on Normal</td>
<td>女性的典型值分数</td>
<td>-</td>
<td>-0.258</td>
<td>0.193</td>
<td>-</td>
</tr>
<tr>
<td style="text-align:center">Years on Normal</td>
<td>缩放因子</td>
<td>-</td>
<td>-0.012</td>
<td>0.12</td>
<td>-</td>
</tr>
<tr>
<td style="text-align:center">IIV Base</td>
<td></td>
<td>-</td>
<td>0.405</td>
<td>0.256</td>
<td>18.9</td>
</tr>
<tr>
<td style="text-align:center">IIV Normal</td>
<td></td>
<td>-</td>
<td>0.164</td>
<td>0.364</td>
<td>43.4</td>
</tr>
<tr>
<td style="text-align:center">IIV <em>T</em>50</td>
<td></td>
<td>-</td>
<td>1.55</td>
<td>0.281</td>
<td>29.6</td>
</tr>
<tr>
<td style="text-align:center">IIV <em>C</em>50</td>
<td></td>
<td>-</td>
<td>0.664</td>
<td>0.609</td>
<td>48.2</td>
</tr>
<tr>
<td style="text-align:center">Proportional RUV</td>
<td></td>
<td>-</td>
<td>0.159</td>
<td>0.123</td>
<td>25.8</td>
</tr>
</tbody>
</table>
<p>IIV和RUV值报告为对角线元素的标准偏差。
IIV和RUV的RSE，以近似标准差标度报告（标准误差/方差估计值）/2。收缩值对应于标准差收缩。
PEFR：呼气峰值流速，BCF：支气管狭窄因子，RUV：残余的不明变异性，IIV：个体间变异，RSE：相对标准误差。SIR:抽样密集重采样。
*使用SIR获得的RSE
† 典型个体:男性，40公斤，患有哮喘。</p>
<h2 id="32---不带协变量的基础模型">3.2   不带协变量的基础模型</h2>
<p>从已发表的模型（run20）中删除了协变量效应，从而产生了一个没有协变量的基础模型，该模型将用作大多数协变量选择方法的起点（表S4中的run11）。参数值如表S3所示，图S4中提供了图形说明，附录A.2中提供了NONMEM代码。RSE值来自方差协方差矩阵。</p>
<p>表格 S3: 无协变量的 PEFR 药效动力学模型的 arameters 表 （run11）。</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>单位</th>
<th>数值</th>
<th>相对标准误*</th>
<th>收缩值 (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Base</td>
<td>基线时的呼气峰值流速(PEFR)</td>
<td>L/min</td>
<td>143</td>
<td>0.0534</td>
<td>-</td>
</tr>
<tr>
<td>Normal</td>
<td>在不包含支气管狭窄因子(BCF)下的呼气峰值流速(PEFR)</td>
<td>L/min</td>
<td>332</td>
<td>0.0546</td>
<td>-</td>
</tr>
<tr>
<td><em>T</em>50</td>
<td>支气管狭窄因子(BCF)的半衰期</td>
<td>h</td>
<td>9.54</td>
<td>0.37</td>
<td>-</td>
</tr>
<tr>
<td><em>C</em>50</td>
<td>生产50%的可回收呼气峰值流速(PEFR)时的茶碱浓度</td>
<td>mg/L</td>
<td>10.3</td>
<td>0.215</td>
<td>-</td>
</tr>
<tr>
<td><em>ε**theo</em></td>
<td>茶碱相对于支气管狭窄因子(BCF)效应的疗效</td>
<td>-</td>
<td>0.414</td>
<td>0.207</td>
<td>-</td>
</tr>
<tr>
<td>Hill exponent</td>
<td>曲线陡度指数</td>
<td>-</td>
<td>3.25</td>
<td>0.25</td>
<td>-</td>
</tr>
<tr>
<td>IIV Base</td>
<td></td>
<td>-</td>
<td>0.404</td>
<td>0.229</td>
<td>20.3</td>
</tr>
<tr>
<td>IIV Normal</td>
<td></td>
<td>-</td>
<td>0.389</td>
<td>0.221</td>
<td>16.6</td>
</tr>
<tr>
<td>IIV <em>T</em>50</td>
<td></td>
<td>-</td>
<td>1.22</td>
<td>0.413</td>
<td>34</td>
</tr>
<tr>
<td>IIV <em>C</em>50</td>
<td></td>
<td>-</td>
<td>0.68</td>
<td>0.638</td>
<td>48.6</td>
</tr>
<tr>
<td>Proportional RUV</td>
<td></td>
<td>-</td>
<td>0.145</td>
<td>0.14</td>
<td>30.4</td>
</tr>
</tbody>
</table>
<p>IIV和RUV值报告为对角线元素的标准偏差。
IIV和RUV的RSE，以近似标准差标度报告（标准误差/方差估计值）/2。收缩值对应于标准差收缩。
PEFR：呼气峰值流速，BCF：支气管狭窄因子，RUV：残余的不明变异性，IIV：个体间变异，RSE：相对标准误差。
* 使用SIR获得的RSE</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image008.png" alt="img">
图S4:使用已发表的不带协变量(run11)的模型典的型值的图形说明。Base：基线时的呼气峰值流速(PEFR)，Normal：在不包含支气管狭窄因子(BCF)下的呼气峰值流速(PEFR)，PEFR：呼气峰值流速，PEFR(t)：时间依赖性呼气峰值流速(PEFR)，PEFR(c,t)：茶碱浓度和时间依赖性呼气峰值流速(PEFR)。</p>
<p>表 S4：被插图说明的不同模型的详细信息。</p>
<table>
<thead>
<tr>
<th>描述</th>
<th>协变量范围</th>
<th>运行编号(Run nb)</th>
</tr>
</thead>
<tbody>
<tr>
<td>不带协变量的基础模型    (Base model without covariate)</td>
<td></td>
<td>11</td>
</tr>
<tr>
<td>出版物中的协变量模型    (Covariate model from the publication)</td>
<td></td>
<td>20</td>
</tr>
<tr>
<td>FFEM模型    (FFEM model)</td>
<td>Normal和Base参数的饱和†模型</td>
<td>22</td>
</tr>
<tr>
<td>基于WAM的协变量模型    (Covariate model based on WAM)</td>
<td>从FFEM模型开始</td>
<td>24</td>
</tr>
<tr>
<td>基于SCM的协变量模型    (Covariate model based on SCM)</td>
<td>所有参数上的所有协变量</td>
<td>25</td>
</tr>
<tr>
<td>基于LASSO的协变量模型    (Covariate model based on LASSO)</td>
<td>Normal参数上的所有协变量</td>
<td>26</td>
</tr>
<tr>
<td>FREM最终模型    (FREM final model)</td>
<td>所有参数上的所有协变量</td>
<td>28</td>
</tr>
<tr>
<td>GAM分析    (GAM analysis)</td>
<td>Normal参数上的所有协变量</td>
<td>-*</td>
</tr>
</tbody>
</table>
<p>Run nb.: 模型标识符。
* 被确定的协变量参数关系未在新的NONMEM模型中被实现。
† 所有参数的所有协变量。</p>
<h2 id="33-全固定效应模型ffem">3.3 全固定效应模型(FFEM)</h2>
<p>在两个参数（参数Base和参数Normal）上创建饱和FFEM（表S4中的run22）。参数值如表S5所示，参数-协变量关系的图形示意图见图S5，NONMEM代码见附录A.3。</p>
<p>Table S5: FFEM 的参数表 （run22）。</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>单位</th>
<th>数值</th>
<th>相对标准误*</th>
<th>收缩值 (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Base</td>
<td>基线时的呼气峰值流速(PEFR)</td>
<td>L/min</td>
<td>165</td>
<td>0.0742</td>
<td>-</td>
</tr>
<tr>
<td>Normal</td>
<td>在不包含支气管狭窄因子(BCF)下的呼气峰值流速(PEFR)†</td>
<td>L/min</td>
<td>421</td>
<td>0.139</td>
<td>-</td>
</tr>
<tr>
<td><em>T</em>50</td>
<td>支气管狭窄因子(BCF)的半衰期</td>
<td>h</td>
<td>12.3</td>
<td>0.452</td>
<td>-</td>
</tr>
<tr>
<td><em>C</em>50</td>
<td>生产50%的可回收呼气峰值流速(PEFR)时的茶碱浓度</td>
<td>mg/L</td>
<td>10</td>
<td>0.197</td>
<td>-</td>
</tr>
<tr>
<td><em>ε**theo</em></td>
<td>茶碱相对于支气管狭窄因子(BCF)效应的疗效</td>
<td>-</td>
<td>0.36</td>
<td>0.124</td>
<td>-</td>
</tr>
<tr>
<td>Hill exponent</td>
<td>曲线陡度指数</td>
<td>-</td>
<td>4.54</td>
<td>0.612</td>
<td>-</td>
</tr>
<tr>
<td>Diagnosis on Base</td>
<td>每个类别的典型值分数</td>
<td>-</td>
<td>0.0425</td>
<td>2.48</td>
<td>-</td>
</tr>
<tr>
<td>Sex on Base</td>
<td>女性的典型值分数</td>
<td>-</td>
<td>-0.169</td>
<td>0.429</td>
<td>-</td>
</tr>
<tr>
<td>Age on Base</td>
<td>缩放因子</td>
<td>-</td>
<td>-0.00534</td>
<td>0.394</td>
<td>-</td>
</tr>
<tr>
<td>Weight on Base</td>
<td>缩放因子</td>
<td>-</td>
<td>0.00598</td>
<td>0.606</td>
<td>-</td>
</tr>
<tr>
<td>Diagnosis on Normal</td>
<td>每个类别的典型值分数</td>
<td>-</td>
<td>0.211</td>
<td>0.294</td>
<td>-</td>
</tr>
<tr>
<td>Sex on Normal</td>
<td>女性的典型值分数</td>
<td>-</td>
<td>-0.193</td>
<td>0.496</td>
<td>-</td>
</tr>
<tr>
<td>Age on Normal</td>
<td>缩放因子</td>
<td>-</td>
<td>-0.0111</td>
<td>0.153</td>
<td>-</td>
</tr>
<tr>
<td>Weight on Normal</td>
<td>缩放因子</td>
<td>-</td>
<td>0.00643</td>
<td>0.534</td>
<td>-</td>
</tr>
<tr>
<td>IIV Base</td>
<td></td>
<td>-</td>
<td>0.375</td>
<td>0.105</td>
<td>17.4</td>
</tr>
<tr>
<td>IIV Normal</td>
<td></td>
<td>-</td>
<td>0.285</td>
<td>0.139</td>
<td>25.6</td>
</tr>
<tr>
<td>IIV <em>T</em>50</td>
<td></td>
<td>-</td>
<td>1.03</td>
<td>0.341</td>
<td>34.5</td>
</tr>
<tr>
<td>IIV <em>C</em>50</td>
<td></td>
<td>-</td>
<td>0.565</td>
<td>0.158</td>
<td>52.6</td>
</tr>
<tr>
<td>Proportional RUV</td>
<td></td>
<td>-</td>
<td>0.153</td>
<td>0.069</td>
<td>27.7</td>
</tr>
</tbody>
</table>
<p>IIV和RUV值报告为对角线元素的标准偏差。
IIV和RUV的RSE，以近似标准差标度报告（标准误差/方差估计值）/2。收缩值对应于标准差收缩。
PEFR：呼气峰值流速，BCF：支气管狭窄因子，RUV：残余的不明变异性，IIV：个体间变异，RSE：相对标准误差。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image010.png" alt="img">
图 S5: 表示协变量、固定效应估计值和不确定性的森林图，以 FFEM 的大小效应百分比表示 （run22）。</p>
<h2 id="34-用于协变量模型的函数形式">3.4 用于协变量模型的函数形式</h2>
<p>图S6说明了连续关系的不同函数形式，相应的公式在方程 6 至 10 中表示。将不同的模型与Normal和Age数据进行拟合，从不含协变量的模型中获得个体的Normal参数值(Run 11)。</p>
<p>线性模型(Linear model) $y(x)=ax+b $  (6)</p>
<p>指数模型(Exponential model) $y(x)=ae^{bx} $ (7)</p>
<p>幂模型(Power model) $y(x)=ax^b $ (8)</p>
<p>S型模型(Sigmoid model) $y(x)=ax/(b+x) $ (9)</p>
<p>分片模型(Piece-wise model)      $ y(x)=\left\{\begin{array}{l}a(x-\bar{x})+b &&{如果 x \leq \bar{x}} \\ c(x-\bar{x})+b &&{如果 x >\bar{x}}\end{array} \right.$     (10)</p>
<p>其中$\bar{x}$协变量的中位数。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image024.png" alt="img">
图 S6:拟合Normal和Age数据的连续协变量的协变量模型示例。个体Normal值是模型中不带协变量的EBE（run11）。虚线部分表示超出观测的协变量范围的外推。EBE：经验贝叶斯估计。</p>
<h1 id="4-基于模型的协变量筛选">4 基于模型的协变量筛选</h1>
<h2 id="41协变量与单个随机效应">4.1协变量与单个随机效应</h2>
<p>可以通过包含预测变量（即协变量）来减少单个随机效应。根据可用的协变量绘制这些个体的随机效应（EBE）有助于证明参数-协变量关系，从而建议在哪个参数上包含哪个协变量。图S7的左侧面板（附录B.7中提供的R代码）显示了茶碱数据，使用第3.2节中介绍的无协变量模型（run11）。</p>
<p>然而，在存在重要的η收缩（根据[3]&gt;20-30）的情况下，当用于协变量筛选时，这些图可以指示错误关系或隐藏真实关系。另一种方法是使用来自单个条件分布的随机抽样来生成η样本，而不是EBE，如[4]所示。η样本的个体均值和个体方差可在NONMEM生成的.phi文件中找到。图S7的右侧面板说明了协变量与η样本之间的关系（附录B.8中提供了R代码）。</p>
<p>基础模型（run11）的EBE与协变量图和η样本与协变量图的比较表明，样本的分布略有扩大。从视觉上看，线性回归的斜率没有明显的差异（见图S7）。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image026.png" alt="img">
图S7：EBE（左图）和etas样本（右图）与没有协变量的基础模型的协变量（run11）。连续协变量在左侧面板上使用散点图显示，红线是线性回归。分类协变量使用箱线图显示。S（SD）是根据标准差计算的收缩率。Base、Normal、C50和T50在表S3中定义。</p>
<h2 id="42-广义加和模型-gam-generalized-additive-model-">4.2 广义加和模型 （GAM, Generalized additive model ）</h2>
<p>广义加法模型（GAM）是在单个参数上逐步搜索协变量[5]。在Xpose4[6,7]中，在函数xpose.gam()中，使用逐步方法提供了一种实现。下面提供了一个说明示例，使用不带协变量的基础模型的残差（表S4中的run11）。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>xpdb11 <span style="color:#f92672">&lt;-</span> xpose4<span style="color:#f92672">::</span><span style="color:#a6e22e">xpose.data</span>(runno <span style="color:#f92672">=</span> <span style="color:#ae81ff">11</span>,<span style="color:#75715e"># Read base model output with xpose4</span>
</span></span><span style="display:flex;"><span>                             directory <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;models&#34;</span>)
</span></span><span style="display:flex;"><span>xpgam <span style="color:#f92672">&lt;-</span> xpose4<span style="color:#f92672">::</span><span style="color:#a6e22e">xpose.gam</span>( <span style="color:#75715e"># Run GAM </span>
</span></span><span style="display:flex;"><span>    object <span style="color:#f92672">=</span> xpdb11, parnam <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;NORMAL&#34;</span>,
</span></span><span style="display:flex;"><span>    covnams <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;AGE&#34;</span>, <span style="color:#e6db74">&#34;WT&#34;</span>, <span style="color:#e6db74">&#34;SEX&#34;</span>, <span style="color:#e6db74">&#34;DIAG&#34;</span>)
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fortran" data-lang="fortran"><span style="display:flex;"><span><span style="color:#75715e">## Start: NORMAL ~ 1; AIC= 1621.422
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Step:1 NORMAL ~ AGE ; AIC= 1575.53
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Step:2 NORMAL ~ AGE + DIAG ; AIC= 1571.575
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Step:3 NORMAL ~ AGE + SEX + DIAG ; AIC= 1566.629
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Step:4 NORMAL ~ ns(AGE, df = 2) + SEX + DIAG ; AIC= 1566.61
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Call:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## gam(formula = NORMAL ~ ns(AGE, df = 2) + SEX + DIAG, data = gamdata,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##   trace = FALSE)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Degrees of Freedom: 131 total; 126 Residual
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Residual Deviance: 991643.3
</span></span></span></code></pre></div><p>命令xpose.gam()在Normal参数上筛选了以下协变量：年龄AGE和体重WT（连续）以及性别SEX和诊断DIAG（分类）。协变量是使用AIC标准逐步添加的。ns选项是一种非线性关系，其特征是指示的自由度的数值。在这种情况下，首先包含AGE，首先是线性关系，然后是DIAG和SEX，然后允许年龄两个自由度。可以使用函数xp.summary()访问更详细的摘要，如下所示，包括参数估计。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>xpose4<span style="color:#f92672">::</span><span style="color:#a6e22e">xp.summary</span>(xpgam)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fortran" data-lang="fortran"><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## SUMMARY
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Call: gam(formula = NORMAL ~ ns(AGE, df = 2) + SEX + DIAG, data = gamdata,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  trace = FALSE)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Deviance Residuals:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  Min 1Q Median  3Q  Max
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## -174.33 -64.82   10.59   51.91  280.08
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## (Dispersion Parameter for gaussian family taken to be 7870.185)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  Null Deviance: 1620295 on 131 degrees of freedom
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Residual Deviance: 991643.3 on 126 degrees of freedom
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## AIC: 1566.61
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Number of Local Scoring Iterations: 2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Anova for Parametric Effects
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  Df Sum Sq Mean Sq Fvalue Pr(&gt;F)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## ns(AGE, df = 2) 2 493384  246692 31.3451 8.936e-12 ***
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## SEX  1 29667    29667 3.7696  0.054425 .
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## DIAG 2 105601 52800 6.7089 0.001703 **
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Residuals 126 991643  7870
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## ---
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Signif. codes:  0 ’***’ 0.001 ’**’ 0.01 ’*’ 0.05 ’.’ 0.1 ’ ’ 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## PATH TO FINAL MODEL
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Stepwise Model Path
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Analysis of Deviance Table
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Initial Model:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMAL ~ 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Final Model:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMAL ~ ns(AGE, df = 2) + SEX + DIAG
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Scale: 12368.67
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  From   To Df Deviance Resid. Df Resid. Dev    AIC
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## 1 &lt;start&gt;  131 1620295.4 1621.422
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## 2 AGE -1 -493034.2 130 1127261.2 1575.530
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## 3 DIAG -2  -65921.9   128 1061339.3 1571.575
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## 4 SEX -1  -54412.6 127 1006926.7 1566.629
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## 5  aGE ns(AGE, df = 2) -1 -15283.4 126 991643.3 1566.610
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## COEFFICIENTS
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  (Intercept) ns(AGE, df = 2)1 ns(AGE, df = 2)2  SEX1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  75.16201 -187.79854   -80.36751   43.67164
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  DIAG2  DIAG3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  -106.94693   -48.29317
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## PRERUN RESULTS
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Dispersion:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## DATA
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Subset expression:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Only first value of covariate considered
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## for each individual: TRUE
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Covariates normalized to median: TRUE
</span></span></span></code></pre></div><p>图S8提供了逐步搜索的图示，其中所有尝试的残差模型都根据其赤池信息判据（AIC）进行排序。图S9中提供了所选协变量与筛选参数的基础模型（run11）残差之间的相关性图示。</p>
<p>数字对应于受试者唯一标识符，并允许发现异常值。用于生成这两个图的R代码可在附录B.9中找到。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image028.png" alt="img">
图S8：在Normal上逐步搜索基础模型（run11）的每个模型的赤池信息判据值。名为1的模型是不带协变量的模型。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image030.png" alt="img">
图S9：基础模型（run11）中Normal参数的残差对GAM所选协变量的协变量。这些数字对应于受试者唯一标识符。</p>
<h2 id="43-瓦尔德近似法wam-wald-approximation-method">4.3 瓦尔德近似法(WAM, Wald approximation method)</h2>
<p>WAM的起点是FFEM，它包含所有考虑的参数-协变量关系，这些关系被建模为固定效应。协变量效应如图S5所示。如前所述，FFEM仅限于Base和Normal上的饱和协变量模型。附录A.3中提供了NONMEM代码。</p>
<p>协变量固定效应的不确定性由NONMEM协方差步骤获得。使用协变量的固定效应估计值和不确定性这两个信息，可以近似计算出每个简化的子模型和FFEM之间的OFV差异。因此，瓦尔德近似法(WAM)是似然比检验（LRT）的近似。然后可以根据aLRT（近似LRT）进行模型选择，选择具有最低aLRT值和较少参数的模型。然而，由于aLRT是一个近似值，因此建议将”施瓦茨贝叶斯判据(SBC，Schwarz&rsquo;s Bayesian criterion)”作为选择标准，以支持更简洁的模型[8]，选择具有最高SBC值的模型。然后，建议通过运行WAM建议的15个最佳模型来检查近似假设，以比较和检查真实LRT和SBC与近似模型之间的相关性。</p>
<p>用于计算FFEM（run22）的所有协变量子模型的LRT统计量的Wald近似值的R代码可在附录B.10中找到。结果如表S6所示。在与该FFEM的2k个可能的协变量模型相对应的256行中，仅显示表的前15行（即根据SBC标准的15个最佳模型）。</p>
<p>SBC建议的最终协变量模型在表S6中排名第一，在NONMEM中运行（表S4中的run24，附录A.4中提供的NONMEM代码），与FFEM模型相比，删除了4个协变量效应的模型的OFV增加了+23点。相应的χ2阈值为9.49（α=0.05）。</p>
<p>表S6：使用FFEM拟合的WAM选择方法的结果（run22）。假设的受限模型根据SBC进行排序，仅显示表格的前15行。</p>
<table>
<thead>
<tr>
<th>排序</th>
<th>包含的协变量参数</th>
<th>近似似然比检验(aLRT)</th>
<th>施瓦茨贝叶斯判据(SBC)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Sex on Base, Age on  Base, Diag on Normal, Age on Normal</td>
<td>9.74</td>
<td>-51.86</td>
</tr>
<tr>
<td>2</td>
<td>Sex on Base, Age on  Base, Age on Normal</td>
<td>16.61</td>
<td>-52.16</td>
</tr>
<tr>
<td>3</td>
<td>Sex on Base, Age on  Base, WT on Base, Diag on Normal, Age on Normal</td>
<td>5.94</td>
<td>-53.09</td>
</tr>
<tr>
<td>4</td>
<td>Sex on Base, Age on  Base, WT on Base, Age on Normal</td>
<td>12.74</td>
<td>-53.36</td>
</tr>
<tr>
<td>5</td>
<td>Sex on Base, Age on  Base, Diag on Normal, Sex on Normal, Age on</td>
<td>6.66</td>
<td>-53.45</td>
</tr>
<tr>
<td>6</td>
<td>Sex on Base, Diag  on Normal, Age on Normal</td>
<td>20.16</td>
<td>-53.94</td>
</tr>
<tr>
<td>7</td>
<td>Diag on Normal, Sex  on Normal, Age on Normal</td>
<td>20.34</td>
<td>-54.03</td>
</tr>
<tr>
<td>8</td>
<td>Sex on Base, Age on  Normal</td>
<td>26.77</td>
<td>-54.11</td>
</tr>
<tr>
<td>9</td>
<td>Sex on Base, Age on  Base, Diag on Normal, Age on Normal, WT on Normal</td>
<td>8.16</td>
<td>-54.20</td>
</tr>
<tr>
<td>10</td>
<td>Diag on Normal, Sex  on Normal, Age on Normal, WT on Normal</td>
<td>14.76</td>
<td>-54.37</td>
</tr>
<tr>
<td>11</td>
<td>Age on Base, Diag  on Normal, Sex on Normal, Age on Normal, WT on Normal</td>
<td>8.61</td>
<td>-54.43</td>
</tr>
<tr>
<td>12</td>
<td>Age on Base, Diag  on Normal, Sex on Normal, Age on Normal</td>
<td>15.27</td>
<td>-54.62</td>
</tr>
<tr>
<td>13</td>
<td>Diag on Base, Sex  on Base, Diag on Normal, Age on Normal</td>
<td>15.46</td>
<td>-54.72</td>
</tr>
<tr>
<td>14</td>
<td>Sex on Base, Age on  Base, Age on Normal, WT on Normal</td>
<td>15.63</td>
<td>-54.81</td>
</tr>
<tr>
<td>15</td>
<td>Diag on Base, Sex  on Base, Age on Base, Diag on Normal, Age on Normal</td>
<td>9.42</td>
<td>-54.83</td>
</tr>
</tbody>
</table>
<p>aLRT：近似似然比统计量，SBC：施瓦茨贝叶斯判据，Schwarz&rsquo;s Bayesian criterion。</p>
<h2 id="44-逐步协变量建模scm-stepwise-covariate-modelling">4.4 逐步协变量建模(SCM, Stepwise covariate modelling)</h2>
<p>SCM（逐步协变量模型）方法包括对模型的协变量效应的前向选择和向后消除。简而言之，每个相关参数-协变量关系的一个模型以单变量方式进行检验。在第一步中，根据某些条件提供最佳数据拟合的模型将被保留并推进到下一步。在以下步骤中，将测试所有剩余的参数协变量组合，直到没有更多的协变量满足包含在模型中的标准。“前向选择”（Forward Selection）之后可以进行“后向消除”（Backward Elimination），后者将作为前向选择进行，但反过来，使用更严格的模型改进标准。PsN[9,10]中的函数scm中提供了一个实现。下面给出了一个使用PsN实现的应用示例。</p>
<p>由于运行 SCM 有许多选项，因此在命令行上指定所有选项是不切实际的，因此 PsN 要求用户编写一个以 .scm 扩展名保存的专用配置文件。然后，可以使用以下命令运行 SCM 配置：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>scm -config_file=theophylline.scm
</span></span></code></pre></div><p>下面提供了“茶碱（theophylline）”数据配置文件的示例，称为theophylline.scm，使用不带协变量的基础模型（表S4中的run11）作为起点，以在所有固定效应参数上筛选所有可用协变量。有关详细信息，请参阅PsN文档（https://uupharmacometrics.github.io/PsN/docs.html）。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fortran" data-lang="fortran"><span style="display:flex;"><span><span style="color:#75715e">## model=run11.mod
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## search_direction=both
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## p_forward=0.05
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## p_backward=0.01
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  continuous_covariates=AGE,WT
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## categorical_covariates=SEX,DIAG
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## [test_relations]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASE=AGE,WT,SEX,DIAG
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMAL=AGE,WT,SEX,DIAG
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50=AGE,WT,SEX,DIAG
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50=AGE,WT,SEX,DIAG
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## [valid_states]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## continuous = 1,2,3,4,5
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## categorial = 1,2,3,4,5
</span></span></span></code></pre></div><p>PsN以多种格式输出SCM选择的结果，其中选择两种格式来说明该方法。第一个图示表示在前向搜索过程中每个步骤实现的OFV下降，如图S10所示（附录B.11.1中提供的R代码）。选择的第二个输出是总结整个SCM搜索（scmlog.txt）和最终模型中包含的最终参数协变量关系的文本文件，可在附录B.11.2中找到。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image032.png" alt="img">
图S10：与所选参数-协变量选择关联的SCM前向搜索的每个步骤的OFV下降。Base、Normal、C50和T50在表S3中定义。红线对应于每个步骤的显著性阈值。</p>
<p>下面的代码显示了与没有协变量的基础模型相比，最终SCM模型中添加的代码行，这显示了协变量是如何包含在模型中的。完整的NONMEM代码可在附录A.6中找到。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#75715e">## &gt; $THETA  (-0.016,0.00557403,0.032) ; BASEWT1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $THETA (-0.024,0.0226863,0.051) ; C50AGE1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $THETA (-1,-0.496745,5) ; NORMALDIAG1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; (-1,-0.2698,5) ; NORMALDIAG2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $THETA (-0.024,0.0442177,0.051) ; T50AGE1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $THETA (-1,-0.780861,5) ; T50SEX1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $THETA (-0.016,-0.0129475,0.032) ; T50WT1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $OMEGA 0.118039 ; IIV_BASE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; 0.0044012 ; IIV_NORMAL</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; 2.8273  ; IIV_T50</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; 0.328448 ;  IIV_C50</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $SIGMA 0.0249899 ; RUV_PROP</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; T50WT = ( 1 + THETA(13)*(WT - 66))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; IF(SEX.EQ.0) T50SEX = 1 ; Most common</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; IF(SEX.EQ.1) T50SEX = ( 1 + THETA(12))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; T50AGE = ( 1 + THETA(11)*(AGE - 34.5))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; T50COV=T50AGE*T50SEX*T50WT</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; IF(DIAG.EQ.1) NORMALDIAG = 1 ; Most common</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; IF(DIAG.EQ.2) NORMALDIAG = ( 1 + THETA(9))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; IF(DIAG.EQ.3) NORMALDIAG = ( 1 + THETA(10))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; NORMALCOV=NORMALDIAG</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; C50AGE = ( 1 + THETA(8)*(AGE - 34.5))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; C50COV=C50AGE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; BASEWT = ( 1 + THETA(7)*(WT - 66))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; BASECOV=BASEWT</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; TVBASE = BASECOV*TVBASE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; TVNORMAL = NORMALCOV*TVNORMAL</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; TVT50 = T50COV*TVT50</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; TVC50 = C50COV*TVC50</span>
</span></span></code></pre></div><p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image034.png" alt="img">
图S11：森林图，表示协变量对基于已发布模型（run20）的Normal参数的影响，相对于数据集中的典型参与者（患有哮喘的40岁男性），由垂直虚线表示。条形符号表示适用子群体类别的Normal值中位数，胡须表示基于SIR不精确估计值的中值的95%置信区间。相应的具体数值显示在右侧。</p>
<h2 id="45-最小绝对收缩和选择算法lasso-the-least-absolute-shrinkage-and-selection-operator">4.5 最小绝对收缩和选择算法（LASSO, The Least absolute shrinkage and selection operator）</h2>
<p>群体药代动力学和药效动力学的协变量模型通常采用逐步协变量建模程序构建。在分析小型数据集时，这种方法可能会产生一个协变量模型，该模型存在选择偏差和较差的预测性能。LASSO工具[11]是解决这些问题的方法。它也可能比SCM工具更快，并提供协变量模型的验证。</p>
<p>在LASSO工具中，所有协变量必须标准化为均值为零，标准差为1。随后，包含所有潜在协变量-参数关系的模型具有一个限制：绝对协变量系数的总和必须小于值t。该限制将迫使某些系数趋于零，而其他系数则通过收缩来估计。在实践中，这意味着在拟合模型时，在估计包含关系的同时测试协变量关系是否包含。对于给定的SCM分析，模型大小取决于选择所需的p值。在LASSO工具中，模型大小取决于t的值，该值可以使用交叉验证进行估计。LASSO方法在PsN中实现[9,10]，包括估计t值所需的交叉验证步骤。下面给出了一个使用PsN实现的应用示例。图S12说明了如何根据交叉验证结果选择最佳t值。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image036.png" alt="img">
图S12：五个交叉验证组中每个组的预测OFV和五个组的总和。</p>
<p>每个参数（例如NORMAL）与强制选项-relations一起列出，其典型值必须编码为模型中的TV参数，例如TVNORMAL。协变量效应将以乘法方式添加到TV变量中。在下面的代码中，年龄和体重（连续，命令中用-2表示）以及性别和诊断（分类，命令中用-1表示）在基础模型的normal参数上进行测试（参见第3.2节）。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>lasso run11.mod -dir=lasso_run11_normal -relations=NORMAL:AGE-2,WT-2,SEX-1,DIAG-1
</span></span></code></pre></div><p>此命令的主要输出如表S7所示。</p>
<p>表S7：用LASSO测试的感兴趣参数（NORMAL）的参数的最终系数。</p>
<table>
<thead>
<tr>
<th>NORMALAGE</th>
<th>NORMALDIAG2</th>
<th>NORMALDIAG3</th>
<th>NORMALSEX1</th>
<th>NORMALWT</th>
<th>FACTOR</th>
<th>CONVERGED</th>
</tr>
</thead>
<tbody>
<tr>
<td>-0.0512465</td>
<td>-0.1487535</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1.000057</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>系数为0表示未选择协变量。FACTOR是应用于变量的校正因子，以确保添加协变量效应的绝对值的和与t值之间的比率等于1。CONVERGED表示最终协变量模型收敛。</p>
<p>下面的代码显示了添加到不带协变量的基础模型中的代码行，以及如何将协变量包含在模型中。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#75715e">## &gt; $THETA (-0.49650,0.0001,0.79798) ; TH7 NORMALAGE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $THETA (-0.44892,0.0001,2.24459) ; TH8 NORMALDIAG2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $THETA (-0.12451,0.0001,8.09297) ; TH9 NORMALDIAG3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $THETA (-0.78384,0.0001,1.28550) ; TH10 NORMALSEX1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $THETA (-0.23442,0.0001,0.44966) ; TH11 NORMALWT</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $THETA  (-1000000,0.2) FIX ; TH12 T-VALUE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $OMEGA 0.164643 ;  IIV_BASE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; 0.160737 ; IIV_NORMAL</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; 1.59823 ;   IIV_T50</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; 0.41132 ;   IIV_C50</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $SIGMA  0.0190902  ;   RUV_PROP</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; $PRED</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt; ;;; LASSO-BEGIN</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    TVALUE = THETA(12)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    ABSSUM = aBS(THETA(7))+ABS(THETA(8))+ABS(THETA(9))+ABS(THETA(10))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    ABSSUM = aBSSUM+ABS(THETA(11))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    RATIO = ABSSUM/TVALUE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    IF (RATIO .GT. 5) EXIT 1 1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    FACTOR = EXP(1-RATIO)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    DIAG2 = 0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    DIAG3 = 0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    SEX1 = 0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    IF (DIAG .EQ. 2) DIAG2=1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    IF (DIAG .EQ. 3) DIAG3=1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    IF (SEX .EQ. 1) SEX1=1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    NORMALAGE =  THETA(7)*(AGE-38.78030)/18.97621*FACTOR</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    NORMALDIAG2 = THETA(8)*(DIAG2-0.16667)/0.37410*FACTOR</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    NORMALDIAG3 = THETA(9)*(DIAG3-0.01515)/0.12262*FACTOR</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    NORMALSEX1 =  THETA(10)*(SEX1-0.37879)/0.48693*FACTOR</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;    NORMALWT = THETA(11)*(WT-67.22576)/14.71551*FACTOR</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &gt;</span>
</span></span></code></pre></div><h2 id="46---全随机效应模型frem-full-random-effect-model">4.6   全随机效应模型（FREM, Full random effect model）</h2>
<p>使用FREM[12‒14]选择感兴趣的协变量时无需考虑它们的相关性。协变量作为观测变量输入到数据集中，其多变量分布被建模为随机效应。参数和协变量的随机效应之间的全协方差矩阵与其他模型组件一起估计。FREM方法是在PsN中实现的[9,10]，下面给出了一个使用PsN实现的应用示例。使用了以下命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>frem run11.mod -covariates=SEX,WT,AGE,DIAG -categorical=SEX,DIAG -dir=frem_run11 -bipp
</span></span></code></pre></div><p>森林图（图S13）说明了估计的协变量效应，表示为每个参数的效应大小（以百分比为单位）及其不确定性。这类曲线图通常用于说明预先指定的协变量方法的任何协变量效应，其中置信度区间不受选择偏倚的影响。在这个例子中，慢性阻塞性肺病和哮喘诊断类别只有两个人，导致参数具有非常高的不确定性（值&gt;1e+20）。绘制这些值不是为了保持绘图的其余部分可读性。</p>
<p>最终的FREM模型代码在附录A.7中提供。用于创建图S13和图S14的数据在PsN生成的文件夹中找到，并根据附录中提供的代码进行处理。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image038.png" alt="img">
图S13：协变量效应，以百分比表示，每个参数和协变量都有不确定性。这些数字是第5个和第95个百分位数的协变量值，虚线是无效线虚线划定了临床无关区域(±20%)。没有绘制无限大的值，导致面为空。Base、Normal、C50和T50在表S3中定义。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image040.png" alt="img">
图S14：所有参数和协变量组合的原始无法解释的变异性以及不确定性。点是观测到的标准差（SD），条形表示第5和第95个SD不确定度。Base、Normal、C50和T50在表S3中定义。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image042.png" alt="img">
图S15：来自FREM模型的相关矩阵（run28）。</p>
<h1 id="5-协变量效应的模型诊断">5 协变量效应的模型诊断</h1>
<p>本节提供了如何使用VPC和EBE-协变量关系图诊断协变量效应的示例。值得注意的是，VPC区间被认为具有不同的名称[15,16]。</p>
<p>图S16显示了没有协变量的模型（表S4中的run11）和通过运行SCM获得的协变量模型（表S4中的run25）之间的VPC有所改善。在这种情况下，协变量纳入改善了对最高观测值的预测，因为第95个预测百分位数的95%CI更窄，观测值的中位数也得到了更好的预测。</p>
<p>图S17显示了与图S16相同的VPC，但根据年龄协变量分层，该协变量包含在使用SCM获得的协变量模型中，使用中位年龄创建两个年龄类别。分层强调，年轻个体的PEFR较高，并且每个类别的典型观测值中位数不是在预测区间的极端值，而是协变量的纳入导致预测区间中位数更好地以中位观测值为中心。附录B.14详细介绍了如何创建不同的VPC。</p>
<p>图S18显示了纳入协变量之前(左图)和之后(右图)作为年龄协变量函数的PEFR预测。结果表明，在协变量纳入后，PEFR对年龄的依赖性可以更好地预测。中位预测区间更好地以观测值为中心，最老个体的PEFR和最高PEFR值的预测效果更好。在所介绍的三种不同VPC中，基于SCM的协变量模型的不精确性和拟合度都得到了改善。</p>
<p>图S19显示了在包含协变量之前(左图)和之后(右图)作为茶碱浓度函数的PEFR预测。SCM协变量效应估计对PEFR的中位预测没有任何明显影响，但确实有助于将预测的上半分位数和下限更接近观察到的百分位数。这一模式支持选择茶碱效应的Emax药效动力学模型，但无法确定SCM确定的协变量或协变量组合解释了受试者之间的变异性。应用FREM方法(图S13)确定的T50的年龄和诊断将是一个起点，看看这两个协变量是否有助于预测VPC的变异性。T50参数描述了气道阻塞的恢复速度，随着年龄的增长和COPD，预计恢复速度会更长。</p>
<p>还可以检查纳入协变量前后EBEs-协变量关系的差异(图S7)。预期的模式是EBE和协变量之间的相关性降低。图S20显示了按照SCM方法（run25）包含协变量后的EBE-协变量关系。线性回归趋势被扁平化，表明现有的相关性现在包含在模型中。有关SCM协变量模型的详细信息，请参见第4.4节。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image044.png" alt="img">
图S16：PEFR对时间曲线的可视化预测检验图。该图基于500次模拟。虚线和阴影区域表示模型模拟的中位数、第5个和第95个百分位数及其相应的95%置信区间。实线表示观测数据的中位数、第5个和第95个百分位数。PEFR：峰值呼气流速。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image046.png" alt="img">
图S17：PEFR对时间曲线在协变量纳入之前（顶部）和之后（底部）的可视化预测检验图，根据年龄协变量分层。该图基于500次模拟。虚线和阴影区域表示模型模拟的中位数、第5个和第95个百分位数及其相应的95%置信区间。实线表示观测数据的中位数、第5个和第95个百分位数。PEFR：峰值呼气流速。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image048.png" alt="img">
图S18：PEFR对年龄的可视化预测检验图。该图基于500次模拟。虚线和阴影区域表示模型模拟的中位数、第5个和第95个百分位数及其相应的95%置信区间。实线表示观测数据的中位数、第5个和第95个百分位数。PEFR：峰值呼气流速。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image050.png" alt="img">
图S19：PEFR对茶碱浓度的可视化预测检验图。该图基于500次模拟。虚线和阴影区域表示模型模拟的中位数、第5个和第95个百分位数及其相应的95%置信区间。实线表示观测数据的中位数、第5个和第95个百分位数。PEFR：峰值呼气流速。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/clip_image052.png" alt="img">
图S20：基于SCM的协变量模型的EBE与协变量（run25）。连续协变量在左侧面板上使用散点图显示，红线是线性回归。分类协变量使用箱线图显示。S（SD）是根据标准差计算的收缩率。Base、Normal、C50和T50在表S3中定义。</p>
<h1 id="6-协变量效应总结和报告">6 协变量效应总结和报告</h1>
<p>本节旨在提供一个示例，说明如何使用协变量模型和出版物的结果（表S4中的run20）总结和报告模型中包含的协变量效应。</p>
<p>协变量模型构建过程后获得的模型介绍如下。表S8提供了协变量模型(run20)与没有协变量的模型(run11)的未变换最终估计，包括IIV参数的RSE和收缩。两个模型的RSE均通过SIR（重要性重抽样，sampling importance resampling）获得。一位40岁男性哮喘患者入院时的PEFR（Base）估计值为136L/min，预测完全恢复值的PEFR为481L/min。支气管狭窄因子的半衰期为19.6小时。茶碱的最大作用是产生与时间相关的最大效应的37.3%（ε_theo）。8.48mg/L的浓度可达到茶碱50%的潜在效应。曲线的陡峭程度用2.59的指数来描述。通过修改Normal参数的诊断、年龄和性别方面的，模型预测得到了明显改善。Normal参数随着COPD的诊断而增加，女性通常较低，并且与年龄成反比。</p>
<p>纳入协变量后，除了Normal参数、T50参数和Normal参数的IIV外，其他参数都发生了微小的变化。Normal参数的变化是意料之中的，因为它是被添加协变量的参数。该参数表示模型中没有协变量时的整个群体的典型值，而在纳入协变量后因为归一化关系，它表示协变量模型中子集（患有哮喘的40岁男性）的典型值。由于协变量纳入解释了群体中参数变异性的一部分，因此Normal参数的IIV也会降低。</p>
<p>使用图S21森林图通过图示的方式表示了所包含效应。所有协变量效应都会降低PEFR，但与较高PEFR相关的年轻年龄除外。用于创建绘图的代码在附录B.13中提供。</p>
<p><img src="/images/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%99%84%E4%BB%B61%E5%92%8C%E9%99%84%E4%BB%B62/image-20240625011159324.png" alt="image-20240625011159324">
图S21：森林图，表示协变量对基于已发布模型（run20）的Normal参数的影响，相对于数据集中的典型受试者（患有哮喘的40岁男性），由垂直虚线表示。条形符号表示适用子群体类别的Normal值的中位数，胡须表示基于SIR不精确估计值的中值的95%置信区间。相应的数值显示在右侧。</p>
<p>表S8：不带协变量的基础模型（run11）和基于已发布的协变量模型的模型（run20）的参数表。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th>无协变量的基础模型  (run11)</th>
<th></th>
<th>基于文献的协变量模型(run20)</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>参数</td>
<td>描述</td>
<td>单位</td>
<td>数值</td>
<td>相对标准误*</td>
<td>收缩值 (%)</td>
<td></td>
<td>数值</td>
<td>相对标准误*</td>
<td>收缩值 (%)</td>
</tr>
<tr>
<td>Base</td>
<td>基线时的呼气峰值流速(PEFR)</td>
<td>L/min</td>
<td>143</td>
<td>0.0534</td>
<td>-</td>
<td></td>
<td>136</td>
<td>0.0642</td>
<td>-</td>
</tr>
<tr>
<td>Normal</td>
<td>在不包含支气管狭窄因子(BCF)下的呼气峰值流速(PEFR)†</td>
<td>L/min</td>
<td>332</td>
<td>0.0546</td>
<td>-</td>
<td></td>
<td>481</td>
<td>0.0621</td>
<td>-</td>
</tr>
<tr>
<td><em>T</em>50</td>
<td>支气管狭窄因子(BCF)的半衰期</td>
<td>h</td>
<td>9.54</td>
<td>0.37</td>
<td>-</td>
<td></td>
<td>19.6</td>
<td>0.263</td>
<td>-</td>
</tr>
<tr>
<td><em>C</em>50</td>
<td>生产50%的可回收呼气峰值流速(PEFR)时的茶碱浓度</td>
<td>mg/L</td>
<td>10.3</td>
<td>0.215</td>
<td>-</td>
<td></td>
<td>8.48</td>
<td>0.268</td>
<td>-</td>
</tr>
<tr>
<td><em>εtheo</em></td>
<td>茶碱相对于支气管狭窄因子(BCF)效应的疗效</td>
<td>-</td>
<td>0.414</td>
<td>0.207</td>
<td>-</td>
<td></td>
<td>0.373</td>
<td>0.197</td>
<td>-</td>
</tr>
<tr>
<td>Hill exponent</td>
<td>曲线陡度指数</td>
<td>-</td>
<td>3.25</td>
<td>0.25</td>
<td>-</td>
<td></td>
<td>2.59</td>
<td>0.3</td>
<td>-</td>
</tr>
<tr>
<td>IIV Base</td>
<td></td>
<td>-</td>
<td>0.404</td>
<td>0.229</td>
<td>20.3</td>
<td></td>
<td>0.405</td>
<td>0.256</td>
<td>18.9</td>
</tr>
<tr>
<td>IIV Normal</td>
<td></td>
<td>-</td>
<td>0.389</td>
<td>0.221</td>
<td>16.6</td>
<td></td>
<td>0.164</td>
<td>0.364</td>
<td>43.4</td>
</tr>
<tr>
<td>IIV <em>T</em>50</td>
<td></td>
<td>-</td>
<td>1.22</td>
<td>0.413</td>
<td>34</td>
<td></td>
<td>1.55</td>
<td>0.281</td>
<td>29.6</td>
</tr>
<tr>
<td>IIV <em>C</em>50</td>
<td></td>
<td>-</td>
<td>0.68</td>
<td>0.638</td>
<td>48.6</td>
<td></td>
<td>0.664</td>
<td>0.609</td>
<td>48.2</td>
</tr>
<tr>
<td>Proportional RUV</td>
<td></td>
<td>-</td>
<td>0.145</td>
<td>0.14</td>
<td>30.4</td>
<td></td>
<td>0.159</td>
<td>0.123</td>
<td>25.8</td>
</tr>
<tr>
<td>Diagnosis on Normal</td>
<td>每个类别的典型值分数</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td></td>
<td>0.202</td>
<td>0.174</td>
<td>-</td>
</tr>
<tr>
<td>Female on Normal</td>
<td>女性的典型值分数</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td></td>
<td>-0.258</td>
<td>0.193</td>
<td>-</td>
</tr>
<tr>
<td>Years on Normal</td>
<td>缩放因子</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td></td>
<td>-0.012</td>
<td>0.12</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>IIV和RUV值报告为对角线元素的标准偏差。
IIV和RUV的RSE，即NONMEM的方差-协方差矩阵估计值，以近似标准差标度报告（标准误差/方差估计值）/2。收缩值对应于标准差收缩。
PEFR：呼气峰值流速，BCF：支气管狭窄因子，RUV：残余的不明变异性，IIV：个体间变异，RSE：相对标准误差。
*使用SIR获得的RSE。
†对应于协变量模型具有以下特征的典型个体的值：男性，40岁，患有哮喘。</p>
<h1 id="7参考文献中文翻译">7.参考文献(中文翻译)</h1>
<ol>
<li>Holford, N.; Hashimoto, Y.; Sheiner, L.B.时间和茶碱浓度有助于解释急性气道阻塞后峰值流量的恢复。Clinical pharmacokinetics 1993, 25, 506–515.</li>
<li>Holford, N.; Black, P.; Couch, R.; Kennedy, J.; Briant, R.严重气道阻塞中的茶碱目标浓度 - 10 或 20 mg/l？Clinical pharmacokinetics 1993, 25, 495–505.</li>
<li>Savic, R.M.; Karlsson, M.O.收缩在诊断经验贝叶斯估计中的重要性：问题和解决方案。The AAPS journal 2009, 11, 558–569.</li>
<li>Lavielle, M.; Ribba, B.诊断定量药理学模型的增强方法：从条件分布中随机抽样。Pharmaceutical research 2016, 33, 2979–2988.</li>
<li>Mandema, J.W.; Verotta, D.; Sheiner, L.B.建立群体药代动力学药效动力学模型。I. Models for Covariate Effects. Journal of pharmacokinetics and biopharmaceutics 1992, 20, 511–528.</li>
<li>Jonsson, E.N.; Karlsson, M.O.Xpose–一种基于 s-PLUS 的 NONMEM 群体药代动力学/药效动力学模型构建辅助工具。Computer Methods and Programs in Biomedicine 1999, 58, 51–64, doi:10.1016/s0169-2607(98)00067-4.</li>
<li>Keizer, R.J.; Karlsson, M.O.; Hooker, A.C.NONMEM 建模和仿真工作台：关于 Pirana、PsN 和 Xpose 的教程。CPT: Pharmacometrics &amp; Systems Pharmacology 2013, 2, doi:10.1038/psp.2013.24.</li>
<li>Kowalski, K.G.; Hutmacher, M.M.使用 Wald 似然比检验对群体模型中的协变量进行有效筛选。Journal of pharmacokinetics and pharmacodynamics 2001, 28, 253–275.</li>
<li>Lindbom, L.; Ribbing, J.; Jonsson, E.N.Perl-speaks-NONMEM （PsN） — 用于 NONMEM 相关编程的 Perl 模块。Computer methods and programs in biomedicine 2004, 75, 85–94.</li>
<li>Lindbom, L.; Pihlgren, P.; Jonsson, N.PsN-Toolkit — 使用 NONMEM 进行非线性混合效应建模的计算机密集型统计方法集合。Computer methods and programs in biomedicine 2005, 79, 241–257.</li>
<li>Ribbing, J.; Nyberg, J.; Caster, O.; Jonsson, E.N.Lasso——一种在非线性混合效应模型中构建预测协变量模型的新方法。Journal of pharmacokinetics and pharmacodynamics 2007, 34, 485–517.</li>
<li>Karlsson, M.O.基于参数和协变量协方差矩阵的全模型方法，PAGE 2012。</li>
<li>Ivaturi, V.; Keizer, R.; Karlsson, M.O.表征协变量关系的全随机效应模型 WCOP 2012。</li>
<li>Yun, H.; Niebecker, R.; Svensson, E.; Karlsson, M.O.FREM和FFEM的评估，包括模型线性化的使用，PAGE 2013。</li>
<li>Hu, C.变异性和不确定性：定量药理学模拟和间隔的解释和使用。Journal of Pharmacokinetics and Pharmacodynamics 2022, 1–5.</li>
<li>Jonsson, E.N.; Nyberg, J.在 Bootstrap 和视觉预测检验分析中选择百分位数估计样本数量的定量方法。CPT: Pharmacometrics &amp; Systems Pharmacology 2022.</li>
</ol>
<h1 id="7-参考文献英文原文">7 参考文献(英文原文)</h1>
<ol>
<li>Holford, N.; Hashimoto, Y.; Sheiner, L.B. Time and Theophylline Concentration Help Explain the Recovery of Peak Flow Following Acute Airways Obstruction. Clinical pharmacokinetics 1993, 25, 506–515.</li>
<li>Holford, N.; Black, P.; Couch, R.; Kennedy, J.; Briant, R. Theophylline Target Concentration in Severe Airways Obstruction—10 or 20 Mg/l? Clinical pharmacokinetics 1993, 25, 495–505.</li>
<li>Savic, R.M.; Karlsson, M.O. Importance of Shrinkage in Empirical Bayes Estimates for Diagnostics: Problems and Solutions. The AAPS journal 2009, 11, 558–569.</li>
<li>Lavielle, M.; Ribba, B. Enhanced Method for Diagnosing Pharmacometric Models: Random Sampling from Conditional Distributions. Pharmaceutical research 2016, 33, 2979–2988.</li>
<li>Mandema, J.W.; Verotta, D.; Sheiner, L.B. Building Population Pharmacokineticpharmacodynamic Models. I. Models for Covariate Effects. Journal of pharmacokinetics and biopharmaceutics 1992, 20, 511–528.</li>
<li>Jonsson, E.N.; Karlsson, M.O. Xpose–an s-PLUS Based Population Pharmacokinetic/Pharmacodynamic Model Building Aid for NONMEM. Computer Methods and Programs in Biomedicine 1999, 58, 51–64, doi:10.1016/s0169-2607(98)00067-4.</li>
<li>Keizer, R.J.; Karlsson, M.O.; Hooker, A.C. Modeling and Simulation Workbench for NONMEM: Tutorial on Pirana, PsN, and Xpose. CPT: Pharmacometrics &amp; Systems Pharmacology 2013, 2, doi:10.1038/psp.2013.24.</li>
<li>Kowalski, K.G.; Hutmacher, M.M. Efficient Screening of Covariates in Population Models Using Wald’s Approximation to the Likelihood Ratio Test. Journal of pharmacokinetics and pharmacodynamics 2001, 28, 253–275.</li>
<li>Lindbom, L.; Ribbing, J.; Jonsson, E.N. Perl-Speaks-NONMEM (PsN)—a Perl Module for NONMEM Related Programming. Computer methods and programs in biomedicine 2004, 75, 85–94.</li>
<li>Lindbom, L.; Pihlgren, P.; Jonsson, N. PsN-Toolkit—a Collection of Computer Intensive Statistical Methods for Non-Linear Mixed Effect Modeling Using NONMEM. Computer methods and programs in biomedicine 2005, 79, 241–257.</li>
<li>Ribbing, J.; Nyberg, J.; Caster, O.; Jonsson, E.N. The Lasso—a Novel Method for Predictive Covariate Model Building in Nonlinear Mixed Effects Models. Journal of pharmacokinetics and pharmacodynamics 2007, 34, 485–517.</li>
<li>Karlsson, M.O. a Full Model Approach Based on the Covariance Matrix of Parameters and Covariates PAGE 2012.</li>
<li>Ivaturi, V.; Keizer, R.; Karlsson, M.O. a Full Random Effects Model for Characterising Covariate Relations WCOP 2012.</li>
<li>Yun, H.; Niebecker, R.; Svensson, E.; Karlsson, M.O. Evaluation of FREM and FFEM Including Use of Model Linearization PAGE 2013.</li>
<li>Hu, C. Variability and Uncertainty: Interpretation and Usage of Pharmacometric Simulations and Intervals. Journal of Pharmacokinetics and Pharmacodynamics 2022, 1–5.</li>
<li>Jonsson, E.N.; Nyberg, J. a Quantitative Approach to the Choice of Number of Samples for Percentile Estimation in Bootstrap and Visual Predictive Check Analyses. CPT: Pharmacometrics &amp; Systems Pharmacology 2022.</li>
</ol>
<h1 id="8-附录">8 附录</h1>
<h2 id="a-nonmem代码">A NONMEM代码</h2>
<h3 id="a1--出版物中的协变量模型covariate-model-from-the-publication-run20">A.1  出版物中的协变量模型(Covariate model from the publication) (run20)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fortran" data-lang="fortran"><span style="display:flex;"><span>;; <span style="color:#ae81ff">1.</span> Based on: <span style="color:#ae81ff">11</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>PROBLEM Covariate model from the publication
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">DATA</span>  ..<span style="color:#f92672">/</span><span style="color:#66d9ef">data</span><span style="color:#f92672">/</span>theo_no_missing.csv IGNORE<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">@</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>INPUT  ID TIME THEO AGE WT SEX RACE DIAG DV
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>ESTIMATION METHOD<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> NOABORT MAXEVAL<span style="color:#f92672">=</span><span style="color:#ae81ff">9999</span> POSTHOC
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>COVARIANCE
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">14</span><span style="color:#ae81ff">1.587</span>) ; TV_BASE (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">33</span><span style="color:#ae81ff">6.984</span>) ; TV_NORMAL
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">01</span>,<span style="color:#ae81ff">7.27855</span>) ; TV_T50
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">01</span>,<span style="color:#ae81ff">1</span><span style="color:#ae81ff">1.427</span>) ; TV_C50
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.463118</span>,<span style="color:#ae81ff">1</span>) ; TV_ALPHA
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2.82371</span>,<span style="color:#ae81ff">5</span>) ; TV_HILL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.01</span> ; DIAG
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.01</span> ; FEMALE
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.01</span> ; FYEARS
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>OMEGA <span style="color:#ae81ff">0.160171</span> ;   IIV_BASE <span style="color:#ae81ff">0.143395</span> ; IIV_NORMAL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1.7514</span> ; IIV_T50
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.487499</span> ;   IIV_C50
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>SIGMA <span style="color:#ae81ff">0.0193434</span> ;   RUV_PROP
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>PRED
</span></span><span style="display:flex;"><span>; Group variables (FIXED effects) FDIAG <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>THETA(<span style="color:#ae81ff">7</span>) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>DIAG) FSEX <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>THETA(<span style="color:#ae81ff">8</span>) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>SEX) FAGE <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>THETA(<span style="color:#ae81ff">9</span>) <span style="color:#f92672">*</span> (AGE<span style="color:#f92672">-</span><span style="color:#ae81ff">40</span>)
</span></span><span style="display:flex;"><span>TVNORMAL <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>GRP_NORMAL <span style="color:#f92672">=</span> FDIAG<span style="color:#f92672">*</span>FAGE<span style="color:#f92672">*</span>FSEX<span style="color:#f92672">*</span>TVNORMAL
</span></span><span style="display:flex;"><span>; Individual variables (RANDOM effects) TVBASE   <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>BASE   <span style="color:#f92672">=</span> TVBASE<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">1</span>)) NORMAL <span style="color:#f92672">=</span> GRP_NORMAL<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">2</span>)) TVT50 <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>T50 <span style="color:#f92672">=</span> TVT50<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">3</span>))
</span></span><span style="display:flex;"><span>TVC50  <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>C50 <span style="color:#f92672">=</span> TVC50<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (T50.LE.<span style="color:#ae81ff">0.01</span>) <span style="color:#66d9ef">EXIT</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (C50.LE.<span style="color:#ae81ff">0.01</span>) <span style="color:#66d9ef">EXIT</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (TIME.LT.<span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">THEN</span> LTZERO<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ELSE</span>
</span></span><span style="display:flex;"><span>LTZERO<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ENDIF</span>
</span></span><span style="display:flex;"><span>FTIME<span style="color:#f92672">=</span>LTZERO<span style="color:#f92672">+</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>LTZERO)<span style="color:#f92672">*</span>EXP(<span style="color:#f92672">-</span>LOG(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">/</span>T50<span style="color:#f92672">*</span>TIME) BCF<span style="color:#f92672">=</span>(NORMAL<span style="color:#f92672">/</span>BASE<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>FTIME
</span></span><span style="display:flex;"><span>FEMAX<span style="color:#f92672">=</span>BCF<span style="color:#f92672">/</span>(BCF<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) PEFRT<span style="color:#f92672">=</span>NORMAL<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>FEMAX) HILL <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">6</span>) CPN<span style="color:#f92672">=</span>THEO<span style="color:#f92672">**</span>HILL C50N<span style="color:#f92672">=</span>C50<span style="color:#f92672">**</span>HILL
</span></span><span style="display:flex;"><span>PEFRCT<span style="color:#f92672">=</span>(NORMAL<span style="color:#f92672">-</span>PEFRT)<span style="color:#f92672">*</span>CPN<span style="color:#f92672">/</span>(CPN<span style="color:#f92672">+</span>C50N) ALPHA<span style="color:#f92672">=</span>THETA(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>F <span style="color:#f92672">=</span> PEFRT <span style="color:#f92672">+</span> ALPHA <span style="color:#f92672">*</span> PEFRCT IPRED <span style="color:#f92672">=</span> F
</span></span><span style="display:flex;"><span>IRES <span style="color:#f92672">=</span> DV <span style="color:#f92672">-</span> IPRED IWRES <span style="color:#f92672">=</span> IRES<span style="color:#f92672">/</span>IPRED
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> F<span style="color:#f92672">*</span> ( <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> EPS(<span style="color:#ae81ff">1</span>) )
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME THEO BASE NORMAL T50 C50 ALPHA HILL ETA1 ETA2 ETA3 ETA4 YONEHEADER NOPRINT <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>run20.dat
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME YTHEO IPRED IWRES NOPRINT ONEHEADER
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>sdtab20
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME THEO BASE NORMAL T50 C50 ALPHA HILL ETA1 ETA2 ETA3 ETA4 NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>patab20
</span></span></code></pre></div><h3 id="a2--基础模型base-model-run11">A.2  基础模型(Base model) (run11)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fortran" data-lang="fortran"><span style="display:flex;"><span>;; <span style="color:#ae81ff">1.</span> Based on:
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>PROBLEM  Theophylline and time on PEFR
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">DATA</span>  ..<span style="color:#f92672">/</span><span style="color:#66d9ef">data</span><span style="color:#f92672">/</span>theo_no_missing.csv IGNORE<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">@</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>INPUT  ID TIME THEO AGE WT SEX RACE DIAG DV
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>ESTIMATION METHOD<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> NOABORT MAXEVAL<span style="color:#f92672">=</span><span style="color:#ae81ff">9999</span> POSTHOC
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>COVARIANCE
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">14</span><span style="color:#ae81ff">6.22</span>)    ; TV_BASE
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">32</span><span style="color:#ae81ff">7.575</span>)   ; TV_NORMAL
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">01</span>,<span style="color:#ae81ff">6.06929</span>) ; TV_T50
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">01</span>,<span style="color:#ae81ff">1</span><span style="color:#ae81ff">2.5879</span>)  ; TV_C50
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.474818</span>,<span style="color:#ae81ff">1</span>) ; TV_ALPHA
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2.63332</span>,<span style="color:#ae81ff">5</span>) ; TV_HILL
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>OMEGA
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.164643</span> ; IIV_BASE
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.160737</span> ; IIV_NORMAL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1.59823</span>  ; IIV_T50
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.41132</span>  ; IIV_C50
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>SIGMA <span style="color:#ae81ff">0.0190902</span> ; RUV_PROP
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>PRED
</span></span><span style="display:flex;"><span>; Individual variables (RANDOM effects) TVBASE   <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>BASE   <span style="color:#f92672">=</span> TVBASE<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">1</span>)) TVNORMAL <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>NORMAL    <span style="color:#f92672">=</span> TVNORMAL<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">2</span>)) TVT50   <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>T50 <span style="color:#f92672">=</span> TVT50<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">3</span>))
</span></span><span style="display:flex;"><span>TVC50  <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>C50 <span style="color:#f92672">=</span> TVC50<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (T50.LE.<span style="color:#ae81ff">0.01</span>) <span style="color:#66d9ef">EXIT</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (C50.LE.<span style="color:#ae81ff">0.01</span>) <span style="color:#66d9ef">EXIT</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (TIME.LT.<span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">THEN</span> LTZERO<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ELSE</span>
</span></span><span style="display:flex;"><span>LTZERO<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ENDIF</span>
</span></span><span style="display:flex;"><span>FTIME<span style="color:#f92672">=</span>LTZERO<span style="color:#f92672">+</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>LTZERO)<span style="color:#f92672">*</span>EXP(<span style="color:#f92672">-</span>LOG(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">/</span>T50<span style="color:#f92672">*</span>TIME) BCF<span style="color:#f92672">=</span>(NORMAL<span style="color:#f92672">/</span>BASE<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>FTIME
</span></span><span style="display:flex;"><span>FEMAX<span style="color:#f92672">=</span>BCF<span style="color:#f92672">/</span>(BCF<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) PEFRT<span style="color:#f92672">=</span>NORMAL<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>FEMAX) HILL <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">6</span>) CPN<span style="color:#f92672">=</span>THEO<span style="color:#f92672">**</span>HILL C50N<span style="color:#f92672">=</span>C50<span style="color:#f92672">**</span>HILL
</span></span><span style="display:flex;"><span>PEFRCT<span style="color:#f92672">=</span>(NORMAL<span style="color:#f92672">-</span>PEFRT)<span style="color:#f92672">*</span>CPN<span style="color:#f92672">/</span>(CPN<span style="color:#f92672">+</span>C50N) ALPHA<span style="color:#f92672">=</span>THETA(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>F <span style="color:#f92672">=</span> PEFRT <span style="color:#f92672">+</span> ALPHA <span style="color:#f92672">*</span> PEFRCT IPRED <span style="color:#f92672">=</span> F
</span></span><span style="display:flex;"><span>IRES <span style="color:#f92672">=</span> DV <span style="color:#f92672">-</span> IPRED IWRES <span style="color:#f92672">=</span> IRES<span style="color:#f92672">/</span>IPRED
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> F<span style="color:#f92672">*</span> ( <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> EPS(<span style="color:#ae81ff">1</span>) )
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME THEO BASE NORMAL T50 C50 ALPHA HILL ETA1 ETA2 ETA3 ETA4 AGE WT SEX DIAG YONEHEADER NOPRINT <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>run11.dat
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME YTHEO IPRED IWRES NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>sdtab11
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME THEO BASE NORMAL T50 C50 ALPHA HILL ETA1 ETA2 ETA3 ETA4 NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>patab11
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME AGE WT NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>cotab11
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME SEX DIAG YNOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>catab11
</span></span></code></pre></div><h3 id="a3--ffem-run22">A.3  FFEM (run22)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fortran" data-lang="fortran"><span style="display:flex;"><span>;; <span style="color:#ae81ff">1.</span> Based on: <span style="color:#ae81ff">11</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>PROBLEM  FCM model
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">DATA</span>  ..<span style="color:#f92672">/</span><span style="color:#66d9ef">data</span><span style="color:#f92672">/</span>theo_no_missing.csv IGNORE<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">@</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>INPUT  ID TIME THEO AGE WT SEX RACE DIAG DV
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>ESTIMATION METHOD<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> NOABORT MAXEVAL<span style="color:#f92672">=</span><span style="color:#ae81ff">9999</span> POSTHOC
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>COVARIANCE
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">14</span><span style="color:#ae81ff">6.22</span>) ; TV_BASE (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">32</span><span style="color:#ae81ff">7.575</span>) ; TV_NORMAL
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">01</span>,<span style="color:#ae81ff">6.06929</span>) ; TV_T50
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">01</span>,<span style="color:#ae81ff">1</span><span style="color:#ae81ff">2.5879</span>) ; TV_C50
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.474818</span>,<span style="color:#ae81ff">1</span>) ; TV_ALPHA
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2.63332</span>,<span style="color:#ae81ff">5</span>) ; TV_HILL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.01</span> ; Diag on Base
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.01</span> ; Sex on Base
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.01</span> ; Age on Base
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.01</span> ; WT on Base
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.01</span> ; Diag on Normal
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.01</span> ; Sex on Normal
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.01</span> ; Age on Normal
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.01</span> ; WT on Normal
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>OMEGA <span style="color:#ae81ff">0.164643</span> ;   IIV_BASE <span style="color:#ae81ff">0.160737</span> ; IIV_NORMAL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1.59823</span> ; IIV_T50
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.41132</span> ; IIV_C50
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>SIGMA <span style="color:#ae81ff">0.0190902</span> ;   RUV_PROP
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>PRED
</span></span><span style="display:flex;"><span>; Group variables (FIXED effects) BDIAG <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">7</span>) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>DIAG) BSEX <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">8</span>) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>SEX) BAGE <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">9</span>) <span style="color:#f92672">*</span> (AGE<span style="color:#f92672">-</span><span style="color:#ae81ff">40</span>) BWT <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">10</span>) <span style="color:#f92672">*</span> (WT<span style="color:#f92672">-</span><span style="color:#ae81ff">66</span>) NDIAG <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">11</span>) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>DIAG) NSEX <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">12</span>) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>SEX) NAGE <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">13</span>) <span style="color:#f92672">*</span> (AGE<span style="color:#f92672">-</span><span style="color:#ae81ff">40</span>) NWT <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">14</span>) <span style="color:#f92672">*</span> (WT<span style="color:#f92672">-</span><span style="color:#ae81ff">66</span>)
</span></span><span style="display:flex;"><span>; Individual variables (RANDOM effects)
</span></span><span style="display:flex;"><span>COV_BASE <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>BDIAG)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>BAGE)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>BSEX)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>BWT) TVBASE  <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>COV_BASE
</span></span><span style="display:flex;"><span>BASE   <span style="color:#f92672">=</span> TVBASE<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>COV_NORMAL <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>NDIAG)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>NAGE)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>NSEX)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>NWT) TVNORMAL <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span>COV_NORMAL
</span></span><span style="display:flex;"><span>NORMAL <span style="color:#f92672">=</span> TVNORMAL<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">2</span>)) TVT50   <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>T50 <span style="color:#f92672">=</span> TVT50<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">3</span>))
</span></span><span style="display:flex;"><span>TVC50  <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>C50 <span style="color:#f92672">=</span> TVC50<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (T50.LE.<span style="color:#ae81ff">0.01</span>) <span style="color:#66d9ef">EXIT</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (C50.LE.<span style="color:#ae81ff">0.01</span>) <span style="color:#66d9ef">EXIT</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (TIME.LT.<span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">THEN</span> LTZERO<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ELSE</span>
</span></span><span style="display:flex;"><span>LTZERO<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ENDIF</span>
</span></span><span style="display:flex;"><span>FTIME<span style="color:#f92672">=</span>LTZERO<span style="color:#f92672">+</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>LTZERO)<span style="color:#f92672">*</span>EXP(<span style="color:#f92672">-</span>LOG(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">/</span>T50<span style="color:#f92672">*</span>TIME) BCF<span style="color:#f92672">=</span>(NORMAL<span style="color:#f92672">/</span>BASE<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>FTIME
</span></span><span style="display:flex;"><span>FEMAX<span style="color:#f92672">=</span>BCF<span style="color:#f92672">/</span>(BCF<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) PEFRT<span style="color:#f92672">=</span>NORMAL<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>FEMAX) HILL <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">6</span>) CPN<span style="color:#f92672">=</span>THEO<span style="color:#f92672">**</span>HILL C50N<span style="color:#f92672">=</span>C50<span style="color:#f92672">**</span>HILL
</span></span><span style="display:flex;"><span>PEFRCT<span style="color:#f92672">=</span>(NORMAL<span style="color:#f92672">-</span>PEFRT)<span style="color:#f92672">*</span>CPN<span style="color:#f92672">/</span>(CPN<span style="color:#f92672">+</span>C50N) ALPHA<span style="color:#f92672">=</span>THETA(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>F <span style="color:#f92672">=</span> PEFRT <span style="color:#f92672">+</span> ALPHA <span style="color:#f92672">*</span> PEFRCT IPRED <span style="color:#f92672">=</span> F
</span></span><span style="display:flex;"><span>IRES <span style="color:#f92672">=</span> DV <span style="color:#f92672">-</span> IPRED IWRES <span style="color:#f92672">=</span> IRES<span style="color:#f92672">/</span>IPRED
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> F<span style="color:#f92672">*</span> ( <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> EPS(<span style="color:#ae81ff">1</span>) )
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME THEO BASE NORMAL T50 C50 ALPHA HILL ETA1 ETA2 ETA3 ETA4 AGE WT SEX DIAG YONEHEADER NOPRINT <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>run22.dat
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME YTHEO IPRED IWRES NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>sdtab22
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME THEO BASE NORMAL T50 C50 ALPHA HILL ETA1 ETA2 ETA3 ETA4 NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>patab22
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME AGE WT NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>cotab22
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME SEX DIAG YNOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>catab22
</span></span></code></pre></div><h3 id="a4--wam-run24">A.4  WAM (run24)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fortran" data-lang="fortran"><span style="display:flex;"><span>;; <span style="color:#ae81ff">1.</span> Based on: <span style="color:#ae81ff">22</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>PROBLEM  Covariate model based on WAM
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">DATA</span>  ..<span style="color:#f92672">/</span><span style="color:#66d9ef">data</span><span style="color:#f92672">/</span>theo_no_missing.csv IGNORE<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">@</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>INPUT  ID TIME THEO AGE WT SEX RACE DIAG DV
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>ESTIMATION METHOD<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> NOABORT MAXEVAL<span style="color:#f92672">=</span><span style="color:#ae81ff">9999</span> POSTHOC
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>COVARIANCE
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">16</span><span style="color:#ae81ff">4.582</span>) ; TV_BASE (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">42</span><span style="color:#ae81ff">0.857</span>) ; TV_NORMAL
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">01</span>,<span style="color:#ae81ff">1</span><span style="color:#ae81ff">2.3227</span>) ; TV_T50
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">01</span>,<span style="color:#ae81ff">1</span><span style="color:#ae81ff">0.0245</span>) ; TV_C50
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.359849</span>,<span style="color:#ae81ff">1</span>) ; TV_ALPHA
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">4.54423</span>,<span style="color:#ae81ff">5</span>) ; TV_HILL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span> FIX ; Diag on Base
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span><span style="color:#ae81ff">0.169302</span> ; Sex on Base
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span><span style="color:#ae81ff">0.00533748</span> ; Age on Base
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span> FIX ; WT on Base <span style="color:#ae81ff">0.210587</span> ; Diag on Normal
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span> FIX ; Sex on Normal
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span><span style="color:#ae81ff">0.0111277</span> ; Age on Normal
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span> FIX ; WT on Normal
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>OMEGA <span style="color:#ae81ff">0.140716</span> ;   IIV_BASE <span style="color:#ae81ff">0.0810301</span> ; IIV_NORMAL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1.06199</span> ; IIV_T50
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.318993</span> ;   IIV_C50
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>SIGMA <span style="color:#ae81ff">0.0233773</span> ;   RUV_PROP
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>PRED
</span></span><span style="display:flex;"><span>; Group variables (FIXED effects) BDIAG <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">7</span>) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>DIAG) BSEX <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">8</span>) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>SEX) BAGE <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">9</span>) <span style="color:#f92672">*</span> (AGE<span style="color:#f92672">-</span><span style="color:#ae81ff">40</span>) BWT <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">10</span>) <span style="color:#f92672">*</span> (WT<span style="color:#f92672">-</span><span style="color:#ae81ff">66</span>) NDIAG <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">11</span>) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>DIAG) NSEX <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">12</span>) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>SEX) NAGE <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">13</span>) <span style="color:#f92672">*</span> (AGE<span style="color:#f92672">-</span><span style="color:#ae81ff">40</span>) NWT <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">14</span>) <span style="color:#f92672">*</span> (WT<span style="color:#f92672">-</span><span style="color:#ae81ff">66</span>)
</span></span><span style="display:flex;"><span>; Individual variables (RANDOM effects)
</span></span><span style="display:flex;"><span>COV_BASE <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>BDIAG)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>BAGE)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>BSEX)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>BWT) TVBASE  <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>COV_BASE
</span></span><span style="display:flex;"><span>BASE   <span style="color:#f92672">=</span> TVBASE<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>COV_NORMAL <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>NDIAG)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>NAGE)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>NSEX)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>NWT) TVNORMAL <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span>COV_NORMAL
</span></span><span style="display:flex;"><span>NORMAL <span style="color:#f92672">=</span> TVNORMAL<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">2</span>)) TVT50   <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>T50 <span style="color:#f92672">=</span> TVT50<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">3</span>))
</span></span><span style="display:flex;"><span>TVC50  <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>C50 <span style="color:#f92672">=</span> TVC50<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (T50.LE.<span style="color:#ae81ff">0.01</span>) <span style="color:#66d9ef">EXIT</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (C50.LE.<span style="color:#ae81ff">0.01</span>) <span style="color:#66d9ef">EXIT</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (TIME.LT.<span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">THEN</span> LTZERO<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ELSE</span>
</span></span><span style="display:flex;"><span>LTZERO<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ENDIF</span>
</span></span><span style="display:flex;"><span>FTIME<span style="color:#f92672">=</span>LTZERO<span style="color:#f92672">+</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>LTZERO)<span style="color:#f92672">*</span>EXP(<span style="color:#f92672">-</span>LOG(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">/</span>T50<span style="color:#f92672">*</span>TIME) BCF<span style="color:#f92672">=</span>(NORMAL<span style="color:#f92672">/</span>BASE<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>FTIME
</span></span><span style="display:flex;"><span>FEMAX<span style="color:#f92672">=</span>BCF<span style="color:#f92672">/</span>(BCF<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) PEFRT<span style="color:#f92672">=</span>NORMAL<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>FEMAX) HILL <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">6</span>) CPN<span style="color:#f92672">=</span>THEO<span style="color:#f92672">**</span>HILL C50N<span style="color:#f92672">=</span>C50<span style="color:#f92672">**</span>HILL
</span></span><span style="display:flex;"><span>PEFRCT<span style="color:#f92672">=</span>(NORMAL<span style="color:#f92672">-</span>PEFRT)<span style="color:#f92672">*</span>CPN<span style="color:#f92672">/</span>(CPN<span style="color:#f92672">+</span>C50N) ALPHA<span style="color:#f92672">=</span>THETA(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>F <span style="color:#f92672">=</span> PEFRT <span style="color:#f92672">+</span> ALPHA <span style="color:#f92672">*</span> PEFRCT IPRED <span style="color:#f92672">=</span> F
</span></span><span style="display:flex;"><span>IRES <span style="color:#f92672">=</span> DV <span style="color:#f92672">-</span> IPRED IWRES <span style="color:#f92672">=</span> IRES<span style="color:#f92672">/</span>IPRED
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> F<span style="color:#f92672">*</span> ( <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> EPS(<span style="color:#ae81ff">1</span>) )
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME THEO BASE NORMAL T50 C50 ALPHA HILL ETA1 ETA2 ETA3 ETA4 AGE WT SEX DIAG YONEHEADER NOPRINT <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>run24.dat
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME YTHEO IPRED IWRES NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>sdtab24
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME THEO BASE NORMAL T50 C50 ALPHA HILL ETA1 ETA2 ETA3 ETA4 NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>patab24
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME AGE WT NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>cotab24
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME SEX DIAG YNOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>catab24
</span></span></code></pre></div><h3 id="a5--最终的lasso模型final-lasso-model-run26">A.5  最终的LASSO模型(Final LASSO model) (run26)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fortran" data-lang="fortran"><span style="display:flex;"><span>;; <span style="color:#ae81ff">1.</span> Based on: <span style="color:#ae81ff">11</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>PROBLEM  Covariate model based on LASSO
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">DATA</span>  ..<span style="color:#f92672">/</span><span style="color:#66d9ef">data</span><span style="color:#f92672">/</span>theo_no_missing.csv IGNORE<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">@</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>INPUT  ID TIME THEO AGE WT SEX RACE DIAG DV
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>ESTIMATION METHOD<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> NOABORT MAXEVAL<span style="color:#f92672">=</span><span style="color:#ae81ff">9999</span> POSTHOC MSFO<span style="color:#f92672">=</span>psn_msf
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">13</span><span style="color:#ae81ff">8.879</span>) ; TV_BASE (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">33</span><span style="color:#ae81ff">3.281</span>) ; TV_NORMAL
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">01</span>,<span style="color:#ae81ff">9.51597</span>) ; TV_T50
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">01</span>,<span style="color:#ae81ff">1</span><span style="color:#ae81ff">1.7335</span>) ; TV_C50
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.535447</span>,<span style="color:#ae81ff">1</span>) ; TV_ALPHA
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1.94753</span>,<span style="color:#ae81ff">5</span>) ; TV_HILL
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA <span style="color:#f92672">-</span><span style="color:#ae81ff">0.00270056670791727</span> FIX ; TH7 NORMALAGE
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA <span style="color:#f92672">-</span><span style="color:#ae81ff">0.397630255831705</span> FIX ; TH8 NORMALDIAG2
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA <span style="color:#ae81ff">0</span> FIX ; TH9 NORMALDIAG3
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA <span style="color:#ae81ff">0</span> FIX ; TH10 NORMALSEX1
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA <span style="color:#ae81ff">0</span> FIX ; TH11 NORMALWT
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA (<span style="color:#f92672">-</span><span style="color:#ae81ff">1000000</span>,<span style="color:#ae81ff">0.2</span>) FIX ; TH12 T<span style="color:#f92672">-</span><span style="color:#66d9ef">VALUE</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>OMEGA <span style="color:#ae81ff">0.158528</span> ;   IIV_BASE <span style="color:#ae81ff">0.0615898</span> ; IIV_NORMAL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1.70203</span> ; IIV_T50
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.518568</span> ;   IIV_C50
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>SIGMA <span style="color:#ae81ff">0.0247062</span> ;   RUV_PROP
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>PRED
</span></span><span style="display:flex;"><span>DIAG2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>DIAG3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>SEX1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (DIAG .EQ. <span style="color:#ae81ff">2</span>) DIAG2<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">IF</span> (DIAG .EQ. <span style="color:#ae81ff">3</span>) DIAG3<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#66d9ef">IF</span> (SEX .EQ. <span style="color:#ae81ff">1</span>) SEX1<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>NORMALAGE <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">7</span>)<span style="color:#f92672">*</span>(AGE<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span><span style="color:#ae81ff">8.78030</span>) NORMALDIAG2 <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">8</span>)<span style="color:#f92672">*</span>(DIAG2<span style="color:#f92672">-</span><span style="color:#ae81ff">0.16667</span>) NORMALDIAG3 <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">9</span>)<span style="color:#f92672">*</span>(DIAG3<span style="color:#f92672">-</span><span style="color:#ae81ff">0.01515</span>) NORMALSEX1 <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">10</span>)<span style="color:#f92672">*</span>(SEX1<span style="color:#f92672">-</span><span style="color:#ae81ff">0.37879</span>) NORMALWT <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">11</span>)<span style="color:#f92672">*</span>(WT<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span><span style="color:#ae81ff">7.22576</span>)
</span></span><span style="display:flex;"><span>NORMALCOV <span style="color:#f92672">=</span> (NORMALAGE<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>(NORMALDIAG2<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>(NORMALDIAG3<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>(NORMALSEX1<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) NORMALCOV <span style="color:#f92672">=</span> NORMALCOV<span style="color:#f92672">*</span>(NORMALWT<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>; Individual variables (RANDOM effects) TVBASE   <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>BASE   <span style="color:#f92672">=</span> TVBASE<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">1</span>)) TVNORMAL <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>TVNORMAL <span style="color:#f92672">=</span> TVNORMAL<span style="color:#f92672">*</span>NORMALCOV NORMAL   <span style="color:#f92672">=</span> TVNORMAL<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">2</span>)) TVT50   <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>T50 <span style="color:#f92672">=</span> TVT50<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">3</span>))
</span></span><span style="display:flex;"><span>TVC50  <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>C50 <span style="color:#f92672">=</span> TVC50<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (T50.LE.<span style="color:#ae81ff">0.01</span>) <span style="color:#66d9ef">EXIT</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (C50.LE.<span style="color:#ae81ff">0.01</span>) <span style="color:#66d9ef">EXIT</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (TIME.LT.<span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">THEN</span> LTZERO<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ELSE</span>
</span></span><span style="display:flex;"><span>LTZERO<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ENDIF</span>
</span></span><span style="display:flex;"><span>FTIME<span style="color:#f92672">=</span>LTZERO<span style="color:#f92672">+</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>LTZERO)<span style="color:#f92672">*</span>EXP(<span style="color:#f92672">-</span>LOG(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">/</span>T50<span style="color:#f92672">*</span>TIME) BCF<span style="color:#f92672">=</span>(NORMAL<span style="color:#f92672">/</span>BASE<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>FTIME
</span></span><span style="display:flex;"><span>FEMAX<span style="color:#f92672">=</span>BCF<span style="color:#f92672">/</span>(BCF<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) PEFRT<span style="color:#f92672">=</span>NORMAL<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>FEMAX) HILL <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">6</span>) CPN<span style="color:#f92672">=</span>THEO<span style="color:#f92672">**</span>HILL C50N<span style="color:#f92672">=</span>C50<span style="color:#f92672">**</span>HILL
</span></span><span style="display:flex;"><span>PEFRCT<span style="color:#f92672">=</span>(NORMAL<span style="color:#f92672">-</span>PEFRT)<span style="color:#f92672">*</span>CPN<span style="color:#f92672">/</span>(CPN<span style="color:#f92672">+</span>C50N) ALPHA<span style="color:#f92672">=</span>THETA(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>F <span style="color:#f92672">=</span> PEFRT <span style="color:#f92672">+</span> ALPHA <span style="color:#f92672">*</span> PEFRCT IPRED <span style="color:#f92672">=</span> F
</span></span><span style="display:flex;"><span>IRES <span style="color:#f92672">=</span> DV <span style="color:#f92672">-</span> IPRED IWRES <span style="color:#f92672">=</span> IRES<span style="color:#f92672">/</span>IPRED
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> F<span style="color:#f92672">*</span> ( <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> EPS(<span style="color:#ae81ff">1</span>) )
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME THEO BASE NORMAL T50 C50 ALPHA HILL ETA1 ETA2 ETA3 ETA4 AGE WT SEX DIAG YONEHEADER NOPRINT <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>run26.dat
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME YTHEO IPRED IWRES NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>sdtab26
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME THEO BASE NORMAL T50 C50 ALPHA HILL ETA1 ETA2 ETA3 ETA4 NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>patab26
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME AGE WT NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>cotab26
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME SEX DIAG YNOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>catab26
</span></span></code></pre></div><h3 id="a6--最终的scm模型final-scm-model-run25">A.6  最终的SCM模型(Final SCM model) (run25)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fortran" data-lang="fortran"><span style="display:flex;"><span>;; <span style="color:#ae81ff">1.</span> Based on: <span style="color:#ae81ff">11</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>PROBLEM  Covariate model based on SCM
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">DATA</span>  ..<span style="color:#f92672">/</span><span style="color:#66d9ef">data</span><span style="color:#f92672">/</span>theo_no_missing.csv IGNORE<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">@</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>INPUT  ID TIME THEO AGE WT SEX RACE DIAG DV
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>ESTIMATION METHOD<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> NOABORT MAXEVAL<span style="color:#f92672">=</span><span style="color:#ae81ff">9999</span> POSTHOC MCETA<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>COVARIANCE
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">14</span><span style="color:#ae81ff">6.71</span>) ; TV_BASE (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">42</span><span style="color:#ae81ff">3.76</span>) ; TV_NORMAL
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">01</span>,<span style="color:#ae81ff">4</span><span style="color:#ae81ff">2.4286</span>) ; TV_T50
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">01</span>,<span style="color:#ae81ff">1</span><span style="color:#ae81ff">0.2693</span>) ; TV_C50
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.305535</span>,<span style="color:#ae81ff">1</span>) ; TV_ALPHA
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">4.63383</span>,<span style="color:#ae81ff">5</span>) ; TV_HILL
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA  (<span style="color:#f92672">-</span><span style="color:#ae81ff">0.016</span>,<span style="color:#ae81ff">0.00557403</span>,<span style="color:#ae81ff">0.032</span>) ; BASEWT1
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA (<span style="color:#f92672">-</span><span style="color:#ae81ff">0.024</span>,<span style="color:#ae81ff">0.0226863</span>,<span style="color:#ae81ff">0.051</span>) ; C50AGE1
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">0.496745</span>,<span style="color:#ae81ff">5</span>) ; NORMALDIAG1 (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">0.2698</span>,<span style="color:#ae81ff">5</span>) ; NORMALDIAG2
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA (<span style="color:#f92672">-</span><span style="color:#ae81ff">0.024</span>,<span style="color:#ae81ff">0.0442177</span>,<span style="color:#ae81ff">0.051</span>) ; T50AGE1
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">0.780861</span>,<span style="color:#ae81ff">5</span>) ; T50SEX1
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA (<span style="color:#f92672">-</span><span style="color:#ae81ff">0.016</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">0.0129475</span>,<span style="color:#ae81ff">0.032</span>) ; T50WT1
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>OMEGA <span style="color:#ae81ff">0.118039</span> ;   IIV_BASE <span style="color:#ae81ff">0.0044012</span> ; IIV_NORMAL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2.8273</span> ; IIV_T50
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.328448</span> ;   IIV_C50
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>SIGMA <span style="color:#ae81ff">0.0249899</span> ;   RUV_PROP
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>PRED
</span></span><span style="display:flex;"><span>;;; T50WT<span style="color:#f92672">-</span>DEFINITION START
</span></span><span style="display:flex;"><span>T50WT <span style="color:#f92672">=</span> ( <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> THETA(<span style="color:#ae81ff">13</span>)<span style="color:#f92672">*</span>(WT <span style="color:#f92672">-</span> <span style="color:#ae81ff">66</span>))
</span></span><span style="display:flex;"><span>;;; T50WT<span style="color:#f92672">-</span>DEFINITION <span style="color:#66d9ef">END</span>
</span></span><span style="display:flex;"><span>;;; T50SEX<span style="color:#f92672">-</span>DEFINITION START <span style="color:#66d9ef">IF</span>(SEX.EQ.<span style="color:#ae81ff">0</span>) T50SEX <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> ; Most <span style="color:#66d9ef">common</span> <span style="color:#66d9ef">IF</span>(SEX.EQ.<span style="color:#ae81ff">1</span>) T50SEX <span style="color:#f92672">=</span> ( <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> THETA(<span style="color:#ae81ff">12</span>))
</span></span><span style="display:flex;"><span>;;; T50SEX<span style="color:#f92672">-</span>DEFINITION <span style="color:#66d9ef">END</span>
</span></span><span style="display:flex;"><span>;;; T50AGE<span style="color:#f92672">-</span>DEFINITION START
</span></span><span style="display:flex;"><span>T50AGE <span style="color:#f92672">=</span> ( <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> THETA(<span style="color:#ae81ff">11</span>)<span style="color:#f92672">*</span>(AGE <span style="color:#f92672">-</span> <span style="color:#ae81ff">3</span><span style="color:#ae81ff">4.5</span>))
</span></span><span style="display:flex;"><span>;;; T50AGE<span style="color:#f92672">-</span>DEFINITION <span style="color:#66d9ef">END</span>
</span></span><span style="display:flex;"><span>;;; T50<span style="color:#f92672">-</span>RELATION START T50COV<span style="color:#f92672">=</span>T50AGE<span style="color:#f92672">*</span>T50SEX<span style="color:#f92672">*</span>T50WT
</span></span><span style="display:flex;"><span>;;; T50<span style="color:#f92672">-</span>RELATION <span style="color:#66d9ef">END</span>
</span></span><span style="display:flex;"><span>;;; NORMALDIAG<span style="color:#f92672">-</span>DEFINITION START <span style="color:#66d9ef">IF</span>(DIAG.EQ.<span style="color:#ae81ff">1</span>) NORMALDIAG <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> ; Most <span style="color:#66d9ef">common</span> <span style="color:#66d9ef">IF</span>(DIAG.EQ.<span style="color:#ae81ff">2</span>) NORMALDIAG <span style="color:#f92672">=</span> ( <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> THETA(<span style="color:#ae81ff">9</span>)) <span style="color:#66d9ef">IF</span>(DIAG.EQ.<span style="color:#ae81ff">3</span>) NORMALDIAG <span style="color:#f92672">=</span> ( <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> THETA(<span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span>;;; NORMALDIAG<span style="color:#f92672">-</span>DEFINITION <span style="color:#66d9ef">END</span>
</span></span><span style="display:flex;"><span>;;; NORMAL<span style="color:#f92672">-</span>RELATION START NORMALCOV<span style="color:#f92672">=</span>NORMALDIAG
</span></span><span style="display:flex;"><span>;;; NORMAL<span style="color:#f92672">-</span>RELATION <span style="color:#66d9ef">END</span>
</span></span><span style="display:flex;"><span>;;; C50AGE<span style="color:#f92672">-</span>DEFINITION START
</span></span><span style="display:flex;"><span>C50AGE <span style="color:#f92672">=</span> ( <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> THETA(<span style="color:#ae81ff">8</span>)<span style="color:#f92672">*</span>(AGE <span style="color:#f92672">-</span> <span style="color:#ae81ff">3</span><span style="color:#ae81ff">4.5</span>))
</span></span><span style="display:flex;"><span>;;; C50AGE<span style="color:#f92672">-</span>DEFINITION <span style="color:#66d9ef">END</span>
</span></span><span style="display:flex;"><span>;;; C50<span style="color:#f92672">-</span>RELATION START C50COV<span style="color:#f92672">=</span>C50AGE
</span></span><span style="display:flex;"><span>;;; C50<span style="color:#f92672">-</span>RELATION <span style="color:#66d9ef">END</span>
</span></span><span style="display:flex;"><span>;;; BASEWT<span style="color:#f92672">-</span>DEFINITION START
</span></span><span style="display:flex;"><span>BASEWT <span style="color:#f92672">=</span> ( <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> THETA(<span style="color:#ae81ff">7</span>)<span style="color:#f92672">*</span>(WT <span style="color:#f92672">-</span> <span style="color:#ae81ff">66</span>))
</span></span><span style="display:flex;"><span>;;; BASEWT<span style="color:#f92672">-</span>DEFINITION <span style="color:#66d9ef">END</span>
</span></span><span style="display:flex;"><span>;;; BASE<span style="color:#f92672">-</span>RELATION START BASECOV<span style="color:#f92672">=</span>BASEWT
</span></span><span style="display:flex;"><span>;;; BASE<span style="color:#f92672">-</span>RELATION <span style="color:#66d9ef">END</span>
</span></span><span style="display:flex;"><span>; Individual variables (RANDOM effects) TVBASE   <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>TVBASE <span style="color:#f92672">=</span> BASECOV<span style="color:#f92672">*</span>TVBASE
</span></span><span style="display:flex;"><span>BASE   <span style="color:#f92672">=</span> TVBASE<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">1</span>)) TVNORMAL <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>TVNORMAL <span style="color:#f92672">=</span> NORMALCOV<span style="color:#f92672">*</span>TVNORMAL
</span></span><span style="display:flex;"><span>NORMAL    <span style="color:#f92672">=</span> TVNORMAL<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">2</span>)) TVT50   <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>TVT50 <span style="color:#f92672">=</span> T50COV<span style="color:#f92672">*</span>TVT50
</span></span><span style="display:flex;"><span>T50 <span style="color:#f92672">=</span> TVT50<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">3</span>))
</span></span><span style="display:flex;"><span>TVC50  <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>TVC50 <span style="color:#f92672">=</span> C50COV<span style="color:#f92672">*</span>TVC50
</span></span><span style="display:flex;"><span>C50 <span style="color:#f92672">=</span> TVC50<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (T50.LE.<span style="color:#ae81ff">0.01</span>) <span style="color:#66d9ef">EXIT</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (C50.LE.<span style="color:#ae81ff">0.01</span>) <span style="color:#66d9ef">EXIT</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (TIME.LT.<span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">THEN</span> LTZERO<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ELSE</span>
</span></span><span style="display:flex;"><span>LTZERO<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ENDIF</span>
</span></span><span style="display:flex;"><span>FTIME<span style="color:#f92672">=</span>LTZERO<span style="color:#f92672">+</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>LTZERO)<span style="color:#f92672">*</span>EXP(<span style="color:#f92672">-</span>LOG(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">/</span>T50<span style="color:#f92672">*</span>TIME) BCF<span style="color:#f92672">=</span>(NORMAL<span style="color:#f92672">/</span>BASE<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>FTIME
</span></span><span style="display:flex;"><span>FEMAX<span style="color:#f92672">=</span>BCF<span style="color:#f92672">/</span>(BCF<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) PEFRT<span style="color:#f92672">=</span>NORMAL<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>FEMAX) HILL <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">6</span>) CPN<span style="color:#f92672">=</span>THEO<span style="color:#f92672">**</span>HILL C50N<span style="color:#f92672">=</span>C50<span style="color:#f92672">**</span>HILL
</span></span><span style="display:flex;"><span>PEFRCT<span style="color:#f92672">=</span>(NORMAL<span style="color:#f92672">-</span>PEFRT)<span style="color:#f92672">*</span>CPN<span style="color:#f92672">/</span>(CPN<span style="color:#f92672">+</span>C50N) ALPHA<span style="color:#f92672">=</span>THETA(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>F <span style="color:#f92672">=</span> PEFRT <span style="color:#f92672">+</span> ALPHA <span style="color:#f92672">*</span> PEFRCT IPRED <span style="color:#f92672">=</span> F
</span></span><span style="display:flex;"><span>IRES <span style="color:#f92672">=</span> DV <span style="color:#f92672">-</span> IPRED IWRES <span style="color:#f92672">=</span> IRES<span style="color:#f92672">/</span>IPRED
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> F<span style="color:#f92672">*</span> ( <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> EPS(<span style="color:#ae81ff">1</span>) )
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME THEO BASE NORMAL T50 C50 ALPHA HILL ETA1 ETA2 ETA3 ETA4 AGE WT SEX DIAG YONEHEADER NOPRINT <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>run25.dat
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME YTHEO IPRED IWRES NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>sdtab25
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME THEO BASE NORMAL T50 C50 ALPHA HILL ETA1 ETA2 ETA3 ETA4 NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>patab25
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME AGE WT NOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>cotab25
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE  ID TIME SEX DIAG YNOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>catab25
</span></span></code></pre></div><h3 id="a7--最终的frem模型final-frem-model-run28">A.7  最终的FREM模型(Final FREM model) (run28)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fortran" data-lang="fortran"><span style="display:flex;"><span>;; <span style="color:#ae81ff">1.</span> Based on: <span style="color:#ae81ff">27</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>PROBLEM	FREM <span style="color:#66d9ef">final</span> model (model <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">DATA</span>	frem_run11<span style="color:#f92672">/</span>frem_dataset.dta IGNORE<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">@</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">$</span>INPUT	ID TIME THEO AGE WT SEX RACE DIAG DV FREMTYPE
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>ESTIMATION METHOD<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> NOABORT MAXEVAL<span style="color:#f92672">=</span><span style="color:#ae81ff">9999</span> POSTHOC NONINFETA<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> MCETA<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">14</span><span style="color:#ae81ff">3.207</span>) ; TV_BASE (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">33</span><span style="color:#ae81ff">1.877</span>) ; TV_NORMAL
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">01</span>,<span style="color:#ae81ff">9.53588</span>) ; TV_T50
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">01</span>,<span style="color:#ae81ff">1</span><span style="color:#ae81ff">0.303</span>) ; TV_C50
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0.413845</span>,<span style="color:#ae81ff">1</span>) ; TV_ALPHA
</span></span><span style="display:flex;"><span>(.<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3.25128</span>,<span style="color:#ae81ff">5</span>) ; TV_HILL
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>THETA <span style="color:#ae81ff">6</span><span style="color:#ae81ff">7.2257575758</span> FIX ; TV_WT <span style="color:#ae81ff">3</span><span style="color:#ae81ff">8.7803030303</span> FIX ; TV_AGE
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1.19696969697</span> FIX ; TV_DIAG
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.378787878788</span> FIX ; TV_SEX
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>OMEGA <span style="color:#66d9ef">BLOCK</span>(<span style="color:#ae81ff">8</span>) <span style="color:#ae81ff">0.1632</span>    ;	IIV_BASE
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.00157182</span> <span style="color:#ae81ff">0.151386</span>  ; IIV_NORMAL
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.00491742</span> <span style="color:#ae81ff">0.00473609</span> <span style="color:#ae81ff">1.48168</span> ;	IIV_T50
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.0027459</span> <span style="color:#ae81ff">0.00264465</span> <span style="color:#ae81ff">0.00827375</span> <span style="color:#ae81ff">0.462009</span> ;	IIV_C50
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.0323345</span> <span style="color:#ae81ff">0.0123791</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.153176</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.0670133</span> <span style="color:#ae81ff">1</span>  ;	BSV_WT
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span><span style="color:#ae81ff">0.0864764</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.217291</span> <span style="color:#ae81ff">0.443655</span> <span style="color:#ae81ff">0.145727</span> <span style="color:#ae81ff">0.177913</span> <span style="color:#ae81ff">1</span> ;	BSV_AGE
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span><span style="color:#ae81ff">0.0624184</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.1921</span> <span style="color:#ae81ff">0.24098</span> <span style="color:#ae81ff">0.153299</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.0255564</span> <span style="color:#ae81ff">0.572045</span> <span style="color:#ae81ff">1</span>  ;	BSV_DIAG
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0.0729895</span>  <span style="color:#f92672">-</span><span style="color:#ae81ff">0.0119927</span>  <span style="color:#f92672">-</span><span style="color:#ae81ff">0.174831</span>  <span style="color:#f92672">-</span><span style="color:#ae81ff">0.00915787</span>  <span style="color:#ae81ff">0.153527</span>  <span style="color:#ae81ff">0.225522</span>  <span style="color:#ae81ff">0.32921</span>  <span style="color:#ae81ff">1</span>    ;	BSV_SEX
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>SIGMA  <span style="color:#ae81ff">0.0209202</span>  ;	RUV_PROP
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>SIGMA   <span style="color:#ae81ff">0.0000001</span>   FIX   ;	EPSCOV
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>PRED
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>; INDIVIDUAL VARIABLES (RANDOM EFFECTS) TVBASE	<span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>BASE	<span style="color:#f92672">=</span> TVBASE<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">1</span>)) TVNORMAL <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>NORMAL	<span style="color:#f92672">=</span> TVNORMAL<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">2</span>)) TVT50	<span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>T50	<span style="color:#f92672">=</span> TVT50<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">3</span>))
</span></span><span style="display:flex;"><span>TVC50	<span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>C50	<span style="color:#f92672">=</span> TVC50<span style="color:#f92672">*</span>EXP(ETA(<span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (T50.LE.<span style="color:#ae81ff">0.01</span>) <span style="color:#66d9ef">EXIT</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (C50.LE.<span style="color:#ae81ff">0.01</span>) <span style="color:#66d9ef">EXIT</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (TIME.LT.<span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">THEN</span> LTZERO<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ELSE</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LTZERO<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ENDIF</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>FTIME<span style="color:#f92672">=</span>LTZERO<span style="color:#f92672">+</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>LTZERO)<span style="color:#f92672">*</span>EXP(<span style="color:#f92672">-</span>LOG(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">/</span>T50<span style="color:#f92672">*</span>TIME) BCF<span style="color:#f92672">=</span>(NORMAL<span style="color:#f92672">/</span>BASE<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>FTIME
</span></span><span style="display:flex;"><span>FEMAX<span style="color:#f92672">=</span>BCF<span style="color:#f92672">/</span>(BCF<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) PEFRT<span style="color:#f92672">=</span>NORMAL<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>FEMAX) HILL <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">6</span>) CPN<span style="color:#f92672">=</span>THEO<span style="color:#f92672">**</span>HILL C50N<span style="color:#f92672">=</span>C50<span style="color:#f92672">**</span>HILL
</span></span><span style="display:flex;"><span>PEFRCT<span style="color:#f92672">=</span>(NORMAL<span style="color:#f92672">-</span>PEFRT)<span style="color:#f92672">*</span>CPN<span style="color:#f92672">/</span>(CPN<span style="color:#f92672">+</span>C50N) ALPHA<span style="color:#f92672">=</span>THETA(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>F <span style="color:#f92672">=</span> PEFRT <span style="color:#f92672">+</span> ALPHA <span style="color:#f92672">*</span> PEFRCT IPRED <span style="color:#f92672">=</span> F
</span></span><span style="display:flex;"><span>IRES <span style="color:#f92672">=</span> DV <span style="color:#f92672">-</span> IPRED IWRES <span style="color:#f92672">=</span> IRES<span style="color:#f92672">/</span>IPRED
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> F<span style="color:#f92672">*</span> ( <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> EPS(<span style="color:#ae81ff">1</span>) )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;;;FREM CODE BEGIN COMPACT
</span></span><span style="display:flex;"><span>;;;<span style="color:#66d9ef">DO</span> NOT MODIFY
</span></span><span style="display:flex;"><span>SDC5 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#ae81ff">4.7155140713</span>
</span></span><span style="display:flex;"><span>SDC6 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#ae81ff">8.976206232</span>
</span></span><span style="display:flex;"><span>SDC7 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.43579170631</span>
</span></span><span style="display:flex;"><span>SDC8 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.486933119697</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (FREMTYPE.EQ.<span style="color:#ae81ff">100</span>) <span style="color:#66d9ef">THEN</span>
</span></span><span style="display:flex;"><span>;	WT <span style="color:#ae81ff">1</span><span style="color:#ae81ff">4.7155140713</span>
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">7</span>) <span style="color:#f92672">+</span> ETA(<span style="color:#ae81ff">5</span>)<span style="color:#f92672">*</span>SDC5 <span style="color:#f92672">+</span> EPS(<span style="color:#ae81ff">2</span>) IPRED <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">7</span>) <span style="color:#f92672">+</span> ETA(<span style="color:#ae81ff">5</span>)<span style="color:#f92672">*</span>SDC5
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">END</span> <span style="color:#66d9ef">IF</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (FREMTYPE.EQ.<span style="color:#ae81ff">200</span>) <span style="color:#66d9ef">THEN</span>
</span></span><span style="display:flex;"><span>;	AGE <span style="color:#ae81ff">1</span><span style="color:#ae81ff">8.976206232</span>
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">8</span>) <span style="color:#f92672">+</span> ETA(<span style="color:#ae81ff">6</span>)<span style="color:#f92672">*</span>SDC6 <span style="color:#f92672">+</span> EPS(<span style="color:#ae81ff">2</span>) IPRED <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">8</span>) <span style="color:#f92672">+</span> ETA(<span style="color:#ae81ff">6</span>)<span style="color:#f92672">*</span>SDC6
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">END</span> <span style="color:#66d9ef">IF</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (FREMTYPE.EQ.<span style="color:#ae81ff">300</span>) <span style="color:#66d9ef">THEN</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;	DIAG  <span style="color:#ae81ff">0.43579170631</span>
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">9</span>) <span style="color:#f92672">+</span> ETA(<span style="color:#ae81ff">7</span>)<span style="color:#f92672">*</span>SDC7 <span style="color:#f92672">+</span> EPS(<span style="color:#ae81ff">2</span>) IPRED <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">9</span>) <span style="color:#f92672">+</span> ETA(<span style="color:#ae81ff">7</span>)<span style="color:#f92672">*</span>SDC7
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">END</span> <span style="color:#66d9ef">IF</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">IF</span> (FREMTYPE.EQ.<span style="color:#ae81ff">400</span>) <span style="color:#66d9ef">THEN</span>
</span></span><span style="display:flex;"><span>;	SEX <span style="color:#ae81ff">0.486933119697</span>
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">10</span>) <span style="color:#f92672">+</span> ETA(<span style="color:#ae81ff">8</span>)<span style="color:#f92672">*</span>SDC8 <span style="color:#f92672">+</span> EPS(<span style="color:#ae81ff">2</span>) IPRED <span style="color:#f92672">=</span> THETA(<span style="color:#ae81ff">10</span>) <span style="color:#f92672">+</span> ETA(<span style="color:#ae81ff">8</span>)<span style="color:#f92672">*</span>SDC8
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">END</span> <span style="color:#66d9ef">IF</span>
</span></span><span style="display:flex;"><span>;;;FREM CODE <span style="color:#66d9ef">END</span> COMPACT
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>COVARIANCE  UNCONDITIONAL  PRECOND<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE	ID TIME THEO BASE NORMAL T50 C50 ALPHA HILL ETA1 ETA2 ETA3 ETA4 AGE WT SEX DIAG YNOTITLE ONEHEADER NOPRINT
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>run28.dat
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE	ID TIME YTHEO IPRED IWRES NOPRINT NOTITLE ONEHEADER
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>sdtab28
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE	ID TIME THEO BASE NORMAL T50 C50 ALPHA HILL ETA1 ETA2 ETA3 ETA4 NOPRINT NOTITLE ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>patab28
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE	ID TIME AGE WT NOPRINT NOTITLE ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>cotab28
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>TABLE	ID TIME SEX DIAG YNOPRINT NOTITLE ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>catab28
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span>ETAS	<span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>frem_run11<span style="color:#f92672">/</span>final_models<span style="color:#f92672">/</span>model_4_input.phi
</span></span></code></pre></div><h2 id="b-r代码">B R代码</h2>
<h3 id="b1--数据管理data-management">B.1  数据管理(Data management)</h3>
<p>用于数据管理的 R 代码。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>dm <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fread</span>(<span style="color:#e6db74">&#34;data/theo_no_missing.csv&#34;</span>) <span style="color:#75715e"># 1. Import data</span>
</span></span><span style="display:flex;"><span>dm <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">subset</span>( dm, select <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">c</span>(RACE)) <span style="color:#75715e"># 2. RACE removed from the analysis</span>
</span></span><span style="display:flex;"><span>dm<span style="color:#f92672">$</span>SEX <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.factor</span>(<span style="color:#a6e22e">as.character</span>( dm<span style="color:#f92672">$</span>SEX)) <span style="color:#75715e">#  3. Convert  numerics  to factors</span>
</span></span><span style="display:flex;"><span>dm<span style="color:#f92672">$</span>DIAG <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.factor</span>(<span style="color:#a6e22e">as.character</span>( dm<span style="color:#f92672">$</span>DIAG))
</span></span><span style="display:flex;"><span>dm<span style="color:#f92672">$</span>PEFR <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.numeric</span>( dm<span style="color:#f92672">$</span>PEFR) <span style="color:#75715e">#  4. Set numbers  to numerics</span>
</span></span></code></pre></div><h3 id="b2--数值摘要numerical-summary">B.2  数值摘要(Numerical summary)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>dm_tab <span style="color:#f92672">&lt;-</span> dm <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>( <span style="color:#75715e"># Rename factors</span>
</span></span><span style="display:flex;"><span>    Diagnosis <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>( DIAG <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;1: Asthma&#34;</span>,
</span></span><span style="display:flex;"><span>                        <span style="color:#a6e22e">ifelse</span>( DIAG <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#34;2: COPD&#34;</span>, <span style="color:#e6db74">&#34;3: COPD and asthma&#34;</span>)
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>    Sex <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>( SEX <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#34;0: Female&#34;</span>, <span style="color:#e6db74">&#34;1: Male&#34;</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">`Age </span>(years)` = AGE, # Rename variables
</span></span><span style="display:flex;"><span>    `Theophylline <span style="color:#a6e22e">concentrations </span>(mg<span style="color:#f92672">/</span>L)` = THEO,
</span></span><span style="display:flex;"><span>    `Peak expiratory force <span style="color:#a6e22e">rate </span>(PEFR, L<span style="color:#f92672">/</span>min)` = PEFR,
</span></span><span style="display:flex;"><span>    `<span style="color:#a6e22e">Weight </span>(kg)` = WT
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dp &lt;- data.frame(dm_tab %&gt;% # Extract dependent variables
</span></span><span style="display:flex;"><span>                   select(`Theophylline <span style="color:#a6e22e">concentrations </span>(mg<span style="color:#f92672">/</span>L)`,
</span></span><span style="display:flex;"><span>                          `Peak  expiratory  force  <span style="color:#a6e22e">rate  </span>(PEFR,  L<span style="color:#f92672">/</span>min)`)  %&gt;%
</span></span><span style="display:flex;"><span>                   tbl_summary()  %&gt;%
</span></span><span style="display:flex;"><span>                   as_gt())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cov &lt;- data.frame( dm_tab %&gt;% # Extract covariates
</span></span><span style="display:flex;"><span>                     distinct(ID, .keep_all = TRUE) %&gt;% # Keep 1 row per ID
</span></span><span style="display:flex;"><span>                     select(`<span style="color:#a6e22e">Age </span>(years)`, `<span style="color:#a6e22e">Weight </span>(kg)`, Sex, Diagnosis) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>                     <span style="color:#a6e22e">tbl_summary</span>(digits <span style="color:#f92672">=</span>  <span style="color:#a6e22e">list</span>(
</span></span><span style="display:flex;"><span>                       <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#39;Age (years)&#39;</span>, <span style="color:#e6db74">&#39;Weight (kg)&#39;</span>, Sex, Diagnosis) <span style="color:#f92672">~</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span>))) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>                     <span style="color:#a6e22e">as_gt</span>())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rb <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rbind</span>(dp, cov) <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e"># Merge covariates and dependent variable summary</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">filter</span>(stat_0 <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;&#34;</span>) <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e"># Filter</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(label <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(row_type <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;label&#34;</span>), <span style="color:#e6db74">&#34; &#34;</span>, label))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rb <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e"># Create table</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">select</span>(variable, label, stat_0) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">rename</span>(<span style="color:#e6db74">&#34;Metrics*&#34;</span> <span style="color:#f92672">=</span> stat_0,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;Categories&#34;</span>  <span style="color:#f92672">=</span>  label,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;Variables&#34;</span> <span style="color:#f92672">=</span> variable) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">kable</span>(booktabs  <span style="color:#f92672">=</span>  T,
</span></span><span style="display:flex;"><span>        caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Numerical description of the Theophylline data set&#34;</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">collapse_rows</span>(columns  <span style="color:#f92672">=</span>  <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>                latex_hline  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;none&#34;</span>,
</span></span><span style="display:flex;"><span>                valign <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;top&#34;</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">kable_styling</span>(latex_options  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;H&#34;</span>)  <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pack_rows</span>(<span style="color:#e6db74">&#34;Dependent variables (526 observations)&#34;</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pack_rows</span>(<span style="color:#e6db74">&#34;Continuous covariates (132 subjects)&#34;</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, hline_before <span style="color:#f92672">=</span> T) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pack_rows</span>(<span style="color:#e6db74">&#34;Categorical covariates (132 subjects)&#34;</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, hline_before <span style="color:#f92672">=</span> T) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  kableExtra<span style="color:#f92672">::</span><span style="color:#a6e22e">footnote</span>(
</span></span><span style="display:flex;"><span>    symbol <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Median (inter-quartile range) for continuous variables; n(%) for categorical variables.&#34;</span>,
</span></span><span style="display:flex;"><span>    symbol_title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>)
</span></span></code></pre></div><h3 id="b3--茶碱数据文件详情theophylline-data-file-details">B.3  茶碱数据文件详情(Theophylline data file details)</h3>
<p>表 S9：茶碱数据文件的描述。</p>
<table>
<thead>
<tr>
<th>列</th>
<th>描述</th>
<th>单位</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>ID</td>
<td>受试者唯一标识符</td>
<td>-</td>
<td>整数&gt; 0</td>
</tr>
<tr>
<td>TIME</td>
<td>时间</td>
<td>hours</td>
<td>数值&gt; 0</td>
</tr>
<tr>
<td>THEO</td>
<td>茶碱血清浓度</td>
<td>mg/mL</td>
<td>数值&gt; 0</td>
</tr>
<tr>
<td>AGE</td>
<td>年龄</td>
<td>years</td>
<td>整数&gt; 1</td>
</tr>
<tr>
<td>WT</td>
<td>体重</td>
<td>kg</td>
<td>数值&gt; 1</td>
</tr>
<tr>
<td>SEX</td>
<td>性别</td>
<td>-</td>
<td>0: 女性, 1: 男性</td>
</tr>
<tr>
<td>DIAG</td>
<td>诊断(分类尺度)</td>
<td>-</td>
<td>1:哮喘,2:COPD,3:COPD和哮喘</td>
</tr>
<tr>
<td>PEFR</td>
<td>呼气峰值流速</td>
<td>L/min</td>
<td>数值&gt; 0</td>
</tr>
</tbody>
</table>
<p>COPD: 慢性阻塞性肺病(chronic obstructive pulmonary disease)</p>
<p>表 S10：茶碱数据文件的前 10 行。</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>TIME</th>
<th>THEO</th>
<th>AGE</th>
<th>WT</th>
<th>SEX</th>
<th>DIAG</th>
<th>PEFR</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0.01</td>
<td>1</td>
<td>27</td>
<td>57</td>
<td>0</td>
<td>1</td>
<td>200</td>
</tr>
<tr>
<td>1</td>
<td>1.51</td>
<td>20.7</td>
<td>27</td>
<td>57</td>
<td>0</td>
<td>1</td>
<td>300</td>
</tr>
<tr>
<td>2</td>
<td>0.01</td>
<td>0.1</td>
<td>21</td>
<td>76</td>
<td>0</td>
<td>1</td>
<td>110</td>
</tr>
<tr>
<td>2</td>
<td>1.42</td>
<td>25.5</td>
<td>21</td>
<td>76</td>
<td>0</td>
<td>1</td>
<td>200</td>
</tr>
<tr>
<td>2</td>
<td>4.42</td>
<td>26.2</td>
<td>21</td>
<td>76</td>
<td>0</td>
<td>1</td>
<td>325</td>
</tr>
<tr>
<td>3</td>
<td>0.01</td>
<td>0.1</td>
<td>26</td>
<td>67.5</td>
<td>1</td>
<td>1</td>
<td>150</td>
</tr>
</tbody>
</table>
<h3 id="b4--意大利面条图spaghettis-plots">B.4  意大利面条图(Spaghettis plots)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(dm, <span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> PEFR, x<span style="color:#f92672">=</span> THEO)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(group <span style="color:#f92672">=</span> ID)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_line</span>(<span style="color:#a6e22e">aes</span>(group <span style="color:#f92672">=</span> ID)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_smooth</span>(se <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;red&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xlab</span>(<span style="color:#e6db74">&#34;Observed theophylline concentrations (mg/mL)&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;Observed PEFR (L/min)&#34;</span>)<span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;none&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_bw</span>()
</span></span></code></pre></div><h3 id="b5--散点图矩阵scatter-plot-matrix">B.5  散点图矩阵(Scatter plot matrix)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>dmn <span style="color:#f92672">&lt;-</span> dm <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>( <span style="color:#75715e"># Rename factors</span>
</span></span><span style="display:flex;"><span>    Diagnosis <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>( DIAG <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;Asthma&#34;</span>,
</span></span><span style="display:flex;"><span>                        <span style="color:#a6e22e">ifelse</span>( DIAG <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#34;COPD&#34;</span>, <span style="color:#e6db74">&#34;COPD and asthma&#34;</span>)),
</span></span><span style="display:flex;"><span>    Sex  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">ifelse</span>( SEX  <span style="color:#f92672">==</span>  <span style="color:#ae81ff">0</span>,  <span style="color:#e6db74">&#34;Female&#34;</span>,  <span style="color:#e6db74">&#34;Male&#34;</span>),
</span></span><span style="display:flex;"><span>    Weight <span style="color:#f92672">=</span> WT, <span style="color:#75715e"># Rename covariates</span>
</span></span><span style="display:flex;"><span>    Age <span style="color:#f92672">=</span> AGE
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cov <span style="color:#f92672">&lt;-</span> dmn[, <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Age&#34;</span>, <span style="color:#e6db74">&#34;Weight&#34;</span>, <span style="color:#e6db74">&#34;Sex&#34;</span>, <span style="color:#e6db74">&#34;Diagnosis&#34;</span>)] <span style="color:#75715e"># Select covariates columns</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggpairs</span>(cov,
</span></span><span style="display:flex;"><span>        upper <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(continuous <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;cor&#34;</span>, combo  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;box_no_facet&#34;</span>),
</span></span><span style="display:flex;"><span>        lower <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(continuous <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;smooth&#34;</span>, combo <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dot_no_facet&#34;</span>)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_bw</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(axis.text.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>( angle<span style="color:#f92672">=</span><span style="color:#ae81ff">45</span>, hjust<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> ) )
</span></span></code></pre></div><h3 id="b6--拟合优度图goodness-of-fit-plots">B.6  拟合优度图(Goodness-of-fit plots)</h3>
<h3 id="b7--协变量对经验贝叶斯估计值图covariates-vs-ebes">B.7  协变量对经验贝叶斯估计值图(Covariates vs EBEs)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#75715e">#Loading the data</span>
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fread</span>(<span style="color:#e6db74">&#34;models/run11.dat&#34;</span>) <span style="color:#75715e"># NM output table</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">### Data management</span>
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">&lt;-</span> input[<span style="color:#f92672">!</span><span style="color:#a6e22e">duplicated</span>(input<span style="color:#f92672">$</span>ID) , ] <span style="color:#75715e"># Keep one line per ID</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">names</span>(input)<span style="color:#a6e22e">[names</span>(input) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;AGE&#34;</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;Age&#34;</span> <span style="color:#75715e">#Rename interesting columns</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">names</span>(input)<span style="color:#a6e22e">[names</span>(input) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;WT&#34;</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;Weight&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">names</span>(input)<span style="color:#a6e22e">[names</span>(input) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;SEX&#34;</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;Sex&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">names</span>(input)<span style="color:#a6e22e">[names</span>(input) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;DIAG&#34;</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;Diagnosis&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ebes <span style="color:#f92672">&lt;-</span> <span style="color:#75715e">#  Keep  only  relevant  columns</span>
</span></span><span style="display:flex;"><span>  input[, <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ID&#34;</span>, <span style="color:#e6db74">&#34;ETA1&#34;</span>, <span style="color:#e6db74">&#34;ETA2&#34;</span>, <span style="color:#e6db74">&#34;ETA3&#34;</span>, <span style="color:#e6db74">&#34;ETA4&#34;</span>, <span style="color:#e6db74">&#34;Age&#34;</span>, <span style="color:#e6db74">&#34;Weight&#34;</span>, <span style="color:#e6db74">&#34;Sex&#34;</span>, <span style="color:#e6db74">&#34;Diagnosis&#34;</span>)]
</span></span><span style="display:flex;"><span>ebes <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">melt</span>( <span style="color:#75715e"># Get long format</span>
</span></span><span style="display:flex;"><span>    ebes,
</span></span><span style="display:flex;"><span>    id  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ID&#34;</span>,  <span style="color:#e6db74">&#34;Age&#34;</span>,  <span style="color:#e6db74">&#34;Weight&#34;</span>,  <span style="color:#e6db74">&#34;Sex&#34;</span>,  <span style="color:#e6db74">&#34;Diagnosis&#34;</span>), variable.name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ETA&#34;</span>,
</span></span><span style="display:flex;"><span>    value.name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;EBEs&#34;</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>ebes <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">melt</span>( <span style="color:#75715e">#  Get long  format</span>
</span></span><span style="display:flex;"><span>  ebes,
</span></span><span style="display:flex;"><span>  id <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ID&#34;</span>, <span style="color:#e6db74">&#34;EBEs&#34;</span>, <span style="color:#e6db74">&#34;ETA&#34;</span>),
</span></span><span style="display:flex;"><span>  variable.name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;COV&#34;</span>, value.name  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;Covariates&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Change name for plot</span>
</span></span><span style="display:flex;"><span>ebes<span style="color:#f92672">$</span>ETA  <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.character</span>(ebes<span style="color:#f92672">$</span>ETA)
</span></span><span style="display:flex;"><span>ebes<span style="color:#f92672">$</span>ETA[ ebes<span style="color:#f92672">$</span>ETA <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ETA1&#34;</span>) ] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;Base&#34;</span>
</span></span><span style="display:flex;"><span>ebes<span style="color:#f92672">$</span>ETA[ ebes<span style="color:#f92672">$</span>ETA <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ETA2&#34;</span>) ] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;Normal&#34;</span>
</span></span><span style="display:flex;"><span>ebes<span style="color:#f92672">$</span>ETA[ ebes<span style="color:#f92672">$</span>ETA <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ETA3&#34;</span>) ] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;T50&#34;</span>
</span></span><span style="display:flex;"><span>ebes<span style="color:#f92672">$</span>ETA[ ebes<span style="color:#f92672">$</span>ETA <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ETA4&#34;</span>) ] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;C50&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ebes<span style="color:#f92672">$</span>ETA  <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.factor</span>(ebes<span style="color:#f92672">$</span>ETA)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">levels</span>(ebes<span style="color:#f92672">$</span>ETA)  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">levels</span>(ebes<span style="color:#f92672">$</span>ETA)<span style="color:#a6e22e">[c</span>(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">4</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sum <span style="color:#f92672">&lt;-</span> xpose<span style="color:#f92672">::</span><span style="color:#a6e22e">get_summary</span>(xpdb11) <span style="color:#75715e"># Get etas values</span>
</span></span><span style="display:flex;"><span>etas <span style="color:#f92672">&lt;-</span> sum<span style="color:#f92672">$</span>value[sum<span style="color:#f92672">$</span>descr <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Eta shrinkage&#34;</span>)]
</span></span><span style="display:flex;"><span>etas <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.numeric</span>(<span style="color:#a6e22e">gsub</span>(<span style="color:#e6db74">&#34; .*&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#a6e22e">unlist</span>(<span style="color:#a6e22e">strsplit</span>(etas, <span style="color:#e6db74">&#34;], &#34;</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Add the shrinkage information</span>
</span></span><span style="display:flex;"><span>ebes<span style="color:#f92672">$</span>Shrinkage <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">NA</span>
</span></span><span style="display:flex;"><span>ebes<span style="color:#f92672">$</span>Shrinkage[ebes<span style="color:#f92672">$</span>ETA  <span style="color:#f92672">%in%</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Base&#34;</span>)]  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;S(SD)=&#34;</span>,  etas[1],<span style="color:#e6db74">&#34;%&#34;</span>)
</span></span><span style="display:flex;"><span>ebes<span style="color:#f92672">$</span>Shrinkage[ebes<span style="color:#f92672">$</span>ETA  <span style="color:#f92672">%in%</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Normal&#34;</span>)]  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;S(SD)=&#34;</span>,  etas[2],<span style="color:#e6db74">&#34;%&#34;</span>)
</span></span><span style="display:flex;"><span>ebes<span style="color:#f92672">$</span>Shrinkage[ebes<span style="color:#f92672">$</span>ETA  <span style="color:#f92672">%in%</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;T50&#34;</span>)]  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;S(SD)=&#34;</span>,  etas[3],<span style="color:#e6db74">&#34;%&#34;</span>)
</span></span><span style="display:flex;"><span>ebes<span style="color:#f92672">$</span>Shrinkage[ebes<span style="color:#f92672">$</span>ETA <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;C50&#34;</span>)] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;S(SD)=&#34;</span>, etas[4],<span style="color:#e6db74">&#34;%&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  Divide   into  continuous  and  categorical  cov</span>
</span></span><span style="display:flex;"><span>cont <span style="color:#f92672">&lt;-</span> ebes[ ebes<span style="color:#f92672">$</span>COV <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Age&#34;</span>, <span style="color:#e6db74">&#34;Weight&#34;</span>),]
</span></span><span style="display:flex;"><span>cat <span style="color:#f92672">&lt;-</span> ebes[<span style="color:#f92672">!</span>ebes<span style="color:#f92672">$</span>COV <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Age&#34;</span>, <span style="color:#e6db74">&#34;Weight&#34;</span>), ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create and rename factors</span>
</span></span><span style="display:flex;"><span>cat<span style="color:#f92672">$</span>Covariates[  cat<span style="color:#f92672">$</span>COV  <span style="color:#f92672">%in%</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Sex&#34;</span>)  <span style="color:#f92672">&amp;</span> cat<span style="color:#f92672">$</span>Covariates  <span style="color:#f92672">==</span>  <span style="color:#ae81ff">0</span>  ] <span style="color:#f92672">&lt;-</span>  <span style="color:#e6db74">&#34;Female&#34;</span>
</span></span><span style="display:flex;"><span>cat<span style="color:#f92672">$</span>Covariates[  cat<span style="color:#f92672">$</span>COV  <span style="color:#f92672">%in%</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Sex&#34;</span>)  <span style="color:#f92672">&amp;</span> cat<span style="color:#f92672">$</span>Covariates  <span style="color:#f92672">==</span>  <span style="color:#ae81ff">1</span>  ] <span style="color:#f92672">&lt;-</span>  <span style="color:#e6db74">&#34;Male&#34;</span>
</span></span><span style="display:flex;"><span>cat<span style="color:#f92672">$</span>Covariates[ cat<span style="color:#f92672">$</span>COV  <span style="color:#f92672">%in%</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Diagnosis&#34;</span>) <span style="color:#f92672">&amp;</span> cat<span style="color:#f92672">$</span>Covariates <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> ] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;Asthma&#34;</span>
</span></span><span style="display:flex;"><span>cat<span style="color:#f92672">$</span>Covariates[ cat<span style="color:#f92672">$</span>COV  <span style="color:#f92672">%in%</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Diagnosis&#34;</span>) <span style="color:#f92672">&amp;</span> cat<span style="color:#f92672">$</span>Covariates <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span> ] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;COPD&#34;</span>
</span></span><span style="display:flex;"><span>cat<span style="color:#f92672">$</span>Covariates[ cat<span style="color:#f92672">$</span>COV  <span style="color:#f92672">%in%</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Diagnosis&#34;</span>) <span style="color:#f92672">&amp;</span> cat<span style="color:#f92672">$</span>Covariates <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span> ] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;COPD and asthma&#34;</span>
</span></span><span style="display:flex;"><span>cat<span style="color:#f92672">$</span>Covariates  <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.factor</span>(cat<span style="color:#f92672">$</span>Covariates)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot</span>
</span></span><span style="display:flex;"><span>contp  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">ggplot</span>(cont, <span style="color:#a6e22e">aes</span>(y  <span style="color:#f92672">=</span>  EBEs,  x <span style="color:#f92672">=</span>  Covariates))  <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_grid</span>(ETA <span style="color:#f92672">~</span> COV, scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>,
</span></span><span style="display:flex;"><span>                                                       colour  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;red&#34;</span>, se <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xlab</span>(<span style="color:#e6db74">&#34;Continuous    covariates&#34;</span>)    <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_bw</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(   strip.background.y   <span style="color:#f92672">=</span>   <span style="color:#a6e22e">element_blank</span>(), strip.text.y   <span style="color:#f92672">=</span>    <span style="color:#a6e22e">element_blank</span>())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>catp  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">ggplot</span>(cat, <span style="color:#a6e22e">aes</span>(y  <span style="color:#f92672">=</span>  EBEs,  x <span style="color:#f92672">=</span>  Covariates))  <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_boxplot</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_grid</span>(ETA <span style="color:#f92672">+</span> Shrinkage <span style="color:#f92672">~</span> COV, scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">xlab</span>(<span style="color:#e6db74">&#34;Categorical covariates&#34;</span>)    <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ylab</span>(<span style="color:#66d9ef">NULL</span>)  <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_bw</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(axis.text.x  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">element_text</span>(angle  <span style="color:#f92672">=</span>  <span style="color:#ae81ff">35</span>,  vjust  <span style="color:#f92672">=</span>  <span style="color:#ae81ff">1</span>,  hjust  <span style="color:#f92672">=</span>  <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plot1 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">plot_grid</span>(contp, catp, nrow <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, align <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;h&#34;</span>)
</span></span></code></pre></div><h3 id="b8--协变量对η抽样值图covariates-vs-η-samples">B.8  协变量对η抽样值图(Covariates vs η samples)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#75715e">#Loading the data</span>
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fread</span>(<span style="color:#e6db74">&#34;models/run11.dat&#34;</span>) <span style="color:#75715e"># NM output table</span>
</span></span><span style="display:flex;"><span>phi <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fread</span>( <span style="color:#e6db74">&#34;models/run11.phi&#34;</span> ) <span style="color:#75715e"># phi file</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">### Data management</span>
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">&lt;-</span> input[<span style="color:#f92672">!</span><span style="color:#a6e22e">duplicated</span>(input<span style="color:#f92672">$</span>ID) , ] <span style="color:#75715e"># Keep one line per ID</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">names</span>(input)<span style="color:#a6e22e">[names</span>(input) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;AGE&#34;</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;Age&#34;</span> <span style="color:#75715e">#Rename interesting columns</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">names</span>(input)<span style="color:#a6e22e">[names</span>(input) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;WT&#34;</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;Weight&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">names</span>(input)<span style="color:#a6e22e">[names</span>(input) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;SEX&#34;</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;Sex&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">names</span>(input)<span style="color:#a6e22e">[names</span>(input) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;DIAG&#34;</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;Diagnosis&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">names</span>(phi) <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">gsub</span>(<span style="color:#e6db74">&#34;[()]|,&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#a6e22e">names</span>(phi)) <span style="color:#75715e"># Remove parenthesis and coma from header</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get eta samples from the individual distributions of the phi file</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fun <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(v1, v2) { val <span style="color:#f92672">&lt;-</span>	<span style="color:#a6e22e">rnorm</span>(<span style="color:#ae81ff">1</span>,v1,v2) <span style="color:#66d9ef">return</span>(val)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>phi <span style="color:#f92672">&lt;-</span> phi <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>( ETAS1 <span style="color:#f92672">=</span> purrr<span style="color:#f92672">::</span><span style="color:#a6e22e">pmap_dbl</span>(<span style="color:#a6e22e">list</span>( ETA1, ETC11), fun ),
</span></span><span style="display:flex;"><span>          ETAS2 <span style="color:#f92672">=</span> purrr<span style="color:#f92672">::</span><span style="color:#a6e22e">pmap_dbl</span>(<span style="color:#a6e22e">list</span>( ETA2, ETC22), fun ),
</span></span><span style="display:flex;"><span>          ETAS3 <span style="color:#f92672">=</span> purrr<span style="color:#f92672">::</span><span style="color:#a6e22e">pmap_dbl</span>(<span style="color:#a6e22e">list</span>( ETA3, ETC33), fun ),
</span></span><span style="display:flex;"><span>          ETAS4 <span style="color:#f92672">=</span> purrr<span style="color:#f92672">::</span><span style="color:#a6e22e">pmap_dbl</span>(<span style="color:#a6e22e">list</span>( ETA4, ETC44), fun ) )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>phi <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">merge</span>( input, phi[,<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">18</span><span style="color:#f92672">:</span><span style="color:#ae81ff">21</span>)] ) <span style="color:#75715e"># Merge etas samples and covariates</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>etas <span style="color:#f92672">&lt;-</span> <span style="color:#75715e"># Keep only relevant columns</span>
</span></span><span style="display:flex;"><span>  phi[, <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ID&#34;</span>, <span style="color:#e6db74">&#34;ETAS1&#34;</span>, <span style="color:#e6db74">&#34;ETAS2&#34;</span>, <span style="color:#e6db74">&#34;ETAS3&#34;</span>, <span style="color:#e6db74">&#34;ETAS4&#34;</span>, <span style="color:#e6db74">&#34;Age&#34;</span>, <span style="color:#e6db74">&#34;Weight&#34;</span>, <span style="color:#e6db74">&#34;Sex&#34;</span>, <span style="color:#e6db74">&#34;Diagnosis&#34;</span>)]
</span></span><span style="display:flex;"><span>etas <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">melt</span>( <span style="color:#75715e"># Get long format: stack ETAS</span>
</span></span><span style="display:flex;"><span>  etas,
</span></span><span style="display:flex;"><span>  id  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ID&#34;</span>,  <span style="color:#e6db74">&#34;Age&#34;</span>,  <span style="color:#e6db74">&#34;Weight&#34;</span>,  <span style="color:#e6db74">&#34;Sex&#34;</span>,  <span style="color:#e6db74">&#34;Diagnosis&#34;</span>), variable.name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ETAS&#34;</span>,
</span></span><span style="display:flex;"><span>  value.name  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;Samples&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>etas <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">melt</span>( <span style="color:#75715e"># Get long format: stack covariates</span>
</span></span><span style="display:flex;"><span>  etas,
</span></span><span style="display:flex;"><span>  id <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ID&#34;</span>, <span style="color:#e6db74">&#34;ETAS&#34;</span>, <span style="color:#e6db74">&#34;Samples&#34;</span>), variable.name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;COV&#34;</span>, value.name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Covariates&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Change name for plot</span>
</span></span><span style="display:flex;"><span>etas<span style="color:#f92672">$</span>ETAS <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.character</span>(etas<span style="color:#f92672">$</span>ETAS)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>etas<span style="color:#f92672">$</span>ETAS[ etas<span style="color:#f92672">$</span>ETAS <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ETAS1&#34;</span>) ] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;Base&#34;</span>
</span></span><span style="display:flex;"><span>etas<span style="color:#f92672">$</span>ETAS[ etas<span style="color:#f92672">$</span>ETAS <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ETAS2&#34;</span>) ] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;Normal&#34;</span>
</span></span><span style="display:flex;"><span>etas<span style="color:#f92672">$</span>ETAS[ etas<span style="color:#f92672">$</span>ETAS <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ETAS3&#34;</span>) ] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;T50&#34;</span>
</span></span><span style="display:flex;"><span>etas<span style="color:#f92672">$</span>ETAS[ etas<span style="color:#f92672">$</span>ETAS <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ETAS4&#34;</span>) ] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;C50&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>etas<span style="color:#f92672">$</span>ETAS <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.factor</span>(etas<span style="color:#f92672">$</span>ETAS) <span style="color:#a6e22e">levels</span>(etas<span style="color:#f92672">$</span>ETAS)  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">levels</span>(etas<span style="color:#f92672">$</span>ETAS)<span style="color:#a6e22e">[c</span>(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">4</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sum <span style="color:#f92672">&lt;-</span> xpose<span style="color:#f92672">::</span><span style="color:#a6e22e">get_summary</span>(xpdb11) <span style="color:#75715e"># Get etas values</span>
</span></span><span style="display:flex;"><span>eta_s <span style="color:#f92672">&lt;-</span> sum<span style="color:#f92672">$</span>value[sum<span style="color:#f92672">$</span>descr <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Eta shrinkage&#34;</span>)]
</span></span><span style="display:flex;"><span>eta_s <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.numeric</span>(<span style="color:#a6e22e">gsub</span>(<span style="color:#e6db74">&#34; .*&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#a6e22e">unlist</span>(<span style="color:#a6e22e">strsplit</span>(eta_s, <span style="color:#e6db74">&#34;], &#34;</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Add the shrinkage information</span>
</span></span><span style="display:flex;"><span>etas<span style="color:#f92672">$</span>Shrinkage  <span style="color:#f92672">&lt;-</span>  <span style="color:#66d9ef">NA</span>
</span></span><span style="display:flex;"><span>etas<span style="color:#f92672">$</span>Shrinkage[etas<span style="color:#f92672">$</span>ETAS  <span style="color:#f92672">%in%</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Base&#34;</span>)]  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;S(SD)=&#34;</span>,  eta_s[1],<span style="color:#e6db74">&#34;%&#34;</span>)
</span></span><span style="display:flex;"><span>etas<span style="color:#f92672">$</span>Shrinkage[etas<span style="color:#f92672">$</span>ETAS  <span style="color:#f92672">%in%</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Normal&#34;</span>)]  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;S(SD)=&#34;</span>,  eta_s[2],<span style="color:#e6db74">&#34;%&#34;</span>)
</span></span><span style="display:flex;"><span>etas<span style="color:#f92672">$</span>Shrinkage[etas<span style="color:#f92672">$</span>ETAS  <span style="color:#f92672">%in%</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;T50&#34;</span>)]  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;S(SD)=&#34;</span>,  eta_s[3],<span style="color:#e6db74">&#34;%&#34;</span>)
</span></span><span style="display:flex;"><span>etas<span style="color:#f92672">$</span>Shrinkage[etas<span style="color:#f92672">$</span>ETAS  <span style="color:#f92672">%in%</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;C50&#34;</span>)]  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;S(SD)=&#34;</span>,  eta_s[4],<span style="color:#e6db74">&#34;%&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Divide into continuous and categorical cov</span>
</span></span><span style="display:flex;"><span>conts <span style="color:#f92672">&lt;-</span> etas[ etas<span style="color:#f92672">$</span>COV <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Age&#34;</span>, <span style="color:#e6db74">&#34;Weight&#34;</span>),]
</span></span><span style="display:flex;"><span>cats <span style="color:#f92672">&lt;-</span> etas[ etas<span style="color:#f92672">$</span>COV <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Sex&#34;</span>, <span style="color:#e6db74">&#34;Diagnosis&#34;</span>), ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create and rename factors</span>
</span></span><span style="display:flex;"><span>cats<span style="color:#f92672">$</span>Covariates[  cats<span style="color:#f92672">$</span>COV  <span style="color:#f92672">%in%</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Sex&#34;</span>)  <span style="color:#f92672">&amp;</span> cats<span style="color:#f92672">$</span>Covariates  <span style="color:#f92672">==</span>  <span style="color:#ae81ff">0</span>  ] <span style="color:#f92672">&lt;-</span>  <span style="color:#e6db74">&#34;Female&#34;</span>
</span></span><span style="display:flex;"><span>cats<span style="color:#f92672">$</span>Covariates[  cats<span style="color:#f92672">$</span>COV  <span style="color:#f92672">%in%</span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Sex&#34;</span>)  <span style="color:#f92672">&amp;</span> cats<span style="color:#f92672">$</span>Covariates  <span style="color:#f92672">==</span>  <span style="color:#ae81ff">1</span>  ] <span style="color:#f92672">&lt;-</span>  <span style="color:#e6db74">&#34;Male&#34;</span>
</span></span><span style="display:flex;"><span>cats<span style="color:#f92672">$</span>Covariates[ cats<span style="color:#f92672">$</span>COV <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Diagnosis&#34;</span>) <span style="color:#f92672">&amp;</span> cats<span style="color:#f92672">$</span>Covariates <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> ] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;Asthma&#34;</span>
</span></span><span style="display:flex;"><span>cats<span style="color:#f92672">$</span>Covariates[ cats<span style="color:#f92672">$</span>COV <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Diagnosis&#34;</span>) <span style="color:#f92672">&amp;</span> cats<span style="color:#f92672">$</span>Covariates <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span> ] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;COPD&#34;</span>
</span></span><span style="display:flex;"><span>cats<span style="color:#f92672">$</span>Covariates[ cats<span style="color:#f92672">$</span>COV <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Diagnosis&#34;</span>) <span style="color:#f92672">&amp;</span> cats<span style="color:#f92672">$</span>Covariates <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span> ] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;COPD and asthma&#34;</span>
</span></span><span style="display:flex;"><span>cats<span style="color:#f92672">$</span>Covariates  <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.factor</span>(cats<span style="color:#f92672">$</span>Covariates)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot</span>
</span></span><span style="display:flex;"><span>contps  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">ggplot</span>(conts, <span style="color:#a6e22e">aes</span>(y  <span style="color:#f92672">=</span>  Samples,  x <span style="color:#f92672">=</span>  Covariates))  <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_grid</span>(ETAS <span style="color:#f92672">~</span> COV, scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>,
</span></span><span style="display:flex;"><span>                                                        colour  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;red&#34;</span>, se <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xlab</span>(<span style="color:#e6db74">&#34;Continuous   covariates&#34;</span>)   <span style="color:#f92672">+</span> <span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;Eta  samples&#34;</span>)  <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_bw</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(   strip.background.y   <span style="color:#f92672">=</span>   <span style="color:#a6e22e">element_blank</span>(), strip.text.y   <span style="color:#f92672">=</span>    <span style="color:#a6e22e">element_blank</span>())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>catps <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ggplot</span>(cats, <span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> Samples, x<span style="color:#f92672">=</span> Covariates)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_boxplot</span>()  <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_grid</span>(ETAS <span style="color:#f92672">+</span> Shrinkage <span style="color:#f92672">~</span> COV, scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">xlab</span>(<span style="color:#e6db74">&#34;Categorical    covariates&#34;</span>)    <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ylab</span>(<span style="color:#66d9ef">NULL</span>)  <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_bw</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(axis.text.x  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">element_text</span>(angle  <span style="color:#f92672">=</span>  <span style="color:#ae81ff">35</span>,  vjust  <span style="color:#f92672">=</span>  <span style="color:#ae81ff">1</span>,  hjust  <span style="color:#f92672">=</span>  <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plot2 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">plot_grid</span>(contps, catps, nrow <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, align <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;h&#34;</span>)
</span></span></code></pre></div><h3 id="b9--gam图">B.9  GAM图</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>aic_plot <span style="color:#f92672">&lt;-</span> xpose4<span style="color:#f92672">::</span><span style="color:#a6e22e">xp.akaike.plot</span>(gamobj <span style="color:#f92672">=</span> xpgam) <span style="color:#75715e"># akaike  plot</span>
</span></span><span style="display:flex;"><span>res_plot <span style="color:#f92672">&lt;-</span> xpose4<span style="color:#f92672">::</span><span style="color:#a6e22e">xp.plot</span>(gamobj <span style="color:#f92672">=</span> xpgam) <span style="color:#75715e">#  Residuals  plot</span>
</span></span></code></pre></div><h3 id="b10-wam">B.10 WAM</h3>
<p>•   用于计算FFEM所有协变量子模型的LRT统计量Wald 近似值的函数。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>wam <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(k, <span style="color:#75715e"># no. of covariate thetas in FFEM</span>
</span></span><span style="display:flex;"><span>                p, <span style="color:#75715e"># no. of parameters in theta, omega and sigma in full model</span>
</span></span><span style="display:flex;"><span>                n, <span style="color:#75715e"># no. of observations in data set</span>
</span></span><span style="display:flex;"><span>                theta, <span style="color:#75715e"># Final fixed covariate effect estimates</span>
</span></span><span style="display:flex;"><span>                cov <span style="color:#75715e">#  Fixed  covariate  effect estimates  var-covar  error  matrix</span>
</span></span><span style="display:flex;"><span>) {
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Create a matrix with all possible covariates prm combinations</span>
</span></span><span style="display:flex;"><span>  kk	<span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">2</span> ˆ ((k <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)<span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>  maker <span style="color:#f92672">&lt;-</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">paste</span>(<span style="color:#e6db74">&#34;rep(rep(c(0,1),rep(&#34;</span> , kk , <span style="color:#e6db74">&#34;,2)),&#34;</span> , <span style="color:#a6e22e">rev</span>(kk) , <span style="color:#e6db74">&#34;)&#34;</span> , sep <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>) x<span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">apply</span>(<span style="color:#a6e22e">matrix</span>(maker), <span style="color:#ae81ff">1</span>, <span style="color:#66d9ef">function</span>(x)
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">eval</span>(<span style="color:#a6e22e">parse</span>(text  <span style="color:#f92672">=</span>  x)))
</span></span><span style="display:flex;"><span>  kkk	<span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">dim</span>(x)[1] <span style="color:#75715e"># Nb of columns in the matrix = fixed cov effect</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># i= 1</span>
</span></span><span style="display:flex;"><span>  ireg <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">1</span>, k) idel <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>k
</span></span><span style="display:flex;"><span>  c2	<span style="color:#f92672">&lt;-</span>  cov[idel,  idel] theta2  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">t</span>(theta[idel])
</span></span><span style="display:flex;"><span>  lrt	<span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">t</span>(theta2) <span style="color:#f92672">%*%</span> <span style="color:#a6e22e">solve</span>(c2) <span style="color:#f92672">%*%</span> theta2 s	<span style="color:#f92672">&lt;-</span>  p <span style="color:#f92672">-</span> <span style="color:#a6e22e">length</span>(idel)
</span></span><span style="display:flex;"><span>  sbc	<span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">-0.5</span> <span style="color:#f92672">*</span> (lrt <span style="color:#f92672">+</span> s<span style="color:#f92672">*</span> <span style="color:#a6e22e">log</span>(n)) results <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">data.frame</span>(
</span></span><span style="display:flex;"><span>    i   <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>kkk,
</span></span><span style="display:flex;"><span>    ireg <span style="color:#f92672">=</span> <span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">0</span>, kkk), lrt <span style="color:#f92672">=</span> <span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">0</span>, kkk), sbc   <span style="color:#f92672">=</span> <span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">0</span>, kkk)
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>  results[1, <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#a6e22e">paste</span>(ireg, collapse <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;,&#34;</span>), lrt, sbc)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span>(kkk <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    ireg <span style="color:#f92672">&lt;-</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>k)[x[i, ] <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    idel <span style="color:#f92672">&lt;-</span>  (<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>k)[x[i, ] <span style="color:#f92672">==</span>  <span style="color:#ae81ff">0</span>] c2	<span style="color:#f92672">&lt;-</span>  cov[idel, idel] theta2  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">t</span>(theta[idel])
</span></span><span style="display:flex;"><span>    lrt	<span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">t</span>(theta2) <span style="color:#f92672">%*%</span> <span style="color:#a6e22e">solve</span>(c2) <span style="color:#f92672">%*%</span> theta2 s	<span style="color:#f92672">&lt;-</span>  p <span style="color:#f92672">-</span> <span style="color:#a6e22e">length</span>(idel)
</span></span><span style="display:flex;"><span>    sbc	<span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">-0.5</span> <span style="color:#f92672">*</span> (lrt <span style="color:#f92672">+</span> s<span style="color:#f92672">*</span> <span style="color:#a6e22e">log</span>(n))
</span></span><span style="display:flex;"><span>    results[i, <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#a6e22e">paste</span>(ireg, collapse <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;,&#34;</span>), lrt, sbc)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># i= kkk ireg &lt;- (1:k) lrt	&lt;- 0</span>
</span></span><span style="display:flex;"><span>  sbc	<span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">-0.5</span> <span style="color:#f92672">*</span> (lrt <span style="color:#f92672">+</span> p<span style="color:#f92672">*</span> <span style="color:#a6e22e">log</span>(n))
</span></span><span style="display:flex;"><span>  results[kkk, <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#a6e22e">paste</span>(ireg, collapse <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;,&#34;</span>), lrt, sbc) results <span style="color:#f92672">&lt;-</span> results<span style="color:#a6e22e">[order</span>(<span style="color:#f92672">-</span><span style="color:#a6e22e">as.numeric</span>(results<span style="color:#f92672">$</span>sbc)), ] results[, <span style="color:#e6db74">&#34;i&#34;</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>kkk
</span></span><span style="display:flex;"><span>  results
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>•   提取固定效应协变量参数的方差-协方差误差矩阵和FFEM的最终效应估计。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#75715e"># Information from the FFEM</span>
</span></span><span style="display:flex;"><span>ntheta <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">14</span>	<span style="color:#75715e"># no. of thetas in FFEM</span>
</span></span><span style="display:flex;"><span>ncovtheta <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">8</span>	<span style="color:#75715e"># no. of covariate thetas in FFEM</span>
</span></span><span style="display:flex;"><span>run.no <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">22</span>	<span style="color:#75715e"># your run number</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get the variance-covariance error matrix for fixed covariates effects</span>
</span></span><span style="display:flex;"><span>tc <span style="color:#f92672">&lt;-</span> <span style="color:#75715e"># Import NONMEM .cov file of FFEM</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">read.table</span>( <span style="color:#75715e"># .cov file = full variance-covariance error matrix of thetas, sigmas and omegas</span>
</span></span><span style="display:flex;"><span>    file <span style="color:#f92672">=</span>  <span style="color:#a6e22e">paste</span>(<span style="color:#e6db74">&#34;models/run&#34;</span>,  run.no,  <span style="color:#e6db74">&#34;.cov&#34;</span>,  sep  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;&#34;</span>), skip <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    header <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    row.names <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>fthetas <span style="color:#f92672">&lt;-</span> ntheta <span style="color:#f92672">-</span> ncovtheta <span style="color:#75715e"># Nb of thetas that are not covariate effects</span>
</span></span><span style="display:flex;"><span>tcnames <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">names</span>(tc)<span style="color:#a6e22e">[</span>(tc <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>)[1, ]]<span style="color:#a6e22e">[</span>(fthetas<span style="color:#ae81ff">+1</span>)<span style="color:#f92672">:</span>ntheta] <span style="color:#75715e"># Names of that thetas</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>tc <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">matrix</span>( <span style="color:#75715e"># Var cov matrix with only estimated parameters</span>
</span></span><span style="display:flex;"><span>  tc[tc <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>], ncol <span style="color:#f92672">=</span> <span style="color:#a6e22e">sqrt</span>(<span style="color:#a6e22e">length</span>(tc[tc <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>]))
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>cov <span style="color:#f92672">&lt;-</span> <span style="color:#75715e"># Subset fixed covariates effects and add names</span>
</span></span><span style="display:flex;"><span>  tc<span style="color:#a6e22e">[</span>(fthetas<span style="color:#ae81ff">+1</span>)<span style="color:#f92672">:</span>ntheta,      (fthetas<span style="color:#ae81ff">+1</span>)<span style="color:#f92672">:</span>ntheta] cov<span style="color:#a6e22e">[col</span>(cov) <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">row</span>(cov)] <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>cov <span style="color:#f92672">&lt;-</span> cov <span style="color:#f92672">+</span> <span style="color:#a6e22e">t</span>(cov) <span style="color:#f92672">-</span> <span style="color:#a6e22e">unlist</span>(<span style="color:#a6e22e">diag</span>(<span style="color:#a6e22e">unlist</span>((<span style="color:#a6e22e">diag</span>(cov))))) <span style="color:#a6e22e">dimnames</span>(cov) <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">list</span>(theta <span style="color:#f92672">=</span> tcnames,
</span></span><span style="display:flex;"><span>                                                                              theta <span style="color:#f92672">=</span> tcnames)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get final estimates for fixed covariates effects</span>
</span></span><span style="display:flex;"><span>tp <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read.table</span>( <span style="color:#75715e"># Import NONMEM .ext file of FFEM</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Raw output file with numerical NONMEM results</span>
</span></span><span style="display:flex;"><span>  file <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste</span>(<span style="color:#e6db74">&#34;models/run&#34;</span>, run.no, <span style="color:#e6db74">&#34;.ext&#34;</span>, sep <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>), skip <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  header <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>tp <span style="color:#f92672">&lt;-</span> <span style="color:#75715e"># .ext line with final estimates and OFV</span>
</span></span><span style="display:flex;"><span>  tp[tp<span style="color:#f92672">$</span>ITERATION <span style="color:#f92672">==</span> <span style="color:#ae81ff">-1000000000</span>, ]
</span></span><span style="display:flex;"><span>tp <span style="color:#f92672">&lt;-</span> tp[, tp <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>] <span style="color:#75715e"># Only estimated parameters</span>
</span></span><span style="display:flex;"><span>theta <span style="color:#f92672">&lt;-</span> tp<span style="color:#a6e22e">[</span>(<span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> fthetas <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)<span style="color:#f92672">:</span>(<span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> ntheta)] <span style="color:#75715e"># Only fixed covariates effects thetas &lt;- unlist(strsplit(names(theta), &#34;THETA&#34;)) # Keep only the theta number thetas &lt;- thetas[thetas != &#34;&#34;]</span>
</span></span></code></pre></div><p>•   对来自 FFEM 的信息运行 WAM 算法。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>results <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">wam</span>( <span style="color:#75715e"># Run the WAM  method on the FFEM  (run22)</span>
</span></span><span style="display:flex;"><span>  k  <span style="color:#f92672">=</span>  ncovtheta, <span style="color:#75715e">#  no.  of  covariate  thetas  in  FFEM</span>
</span></span><span style="display:flex;"><span>  p <span style="color:#f92672">=</span> <span style="color:#ae81ff">19</span>, <span style="color:#75715e"># no. of parameters in theta, omega and sigma in full model</span>
</span></span><span style="display:flex;"><span>  n <span style="color:#f92672">=</span> <span style="color:#ae81ff">526</span>, <span style="color:#75715e"># no. of observations in data set</span>
</span></span><span style="display:flex;"><span>  theta <span style="color:#f92672">=</span> theta, <span style="color:#75715e"># Final fixed covariate effect estimates</span>
</span></span><span style="display:flex;"><span>  cov <span style="color:#f92672">=</span> cov <span style="color:#75715e"># Fixed covariate effect estimates var-covar error matrix</span>
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><h3 id="b11-scm">B.11 SCM</h3>
<h4 id="b111-scm的目标函数值下降图ofv-drop-plot-for-scm">B.11.1 SCM的目标函数值下降图(OFV drop plot for SCM)</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>scm.short.log <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;models/scm_run14/short_scmlog.txt&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>list_incl_cov  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">included_covariates</span>(scm.short.log) n1 <span style="color:#f92672">&lt;-</span>
</span></span><span style="display:flex;"><span>  list_incl_cov<span style="color:#f92672">$</span>n1 <span style="color:#75715e">#Number of covariate included after forward step</span>
</span></span><span style="display:flex;"><span>sign <span style="color:#f92672">&lt;-</span> list_incl_cov<span style="color:#f92672">$</span>sign data <span style="color:#f92672">&lt;-</span> list_incl_cov<span style="color:#f92672">$</span>data name <span style="color:#f92672">&lt;-</span> list_incl_cov<span style="color:#f92672">$</span>name
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># plot SCM  results included covariates</span>
</span></span><span style="display:flex;"><span>p  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">plot_included_covariates</span>(data,  sign,  n1,  name)  <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_bw</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggtitle</span>(<span style="color:#66d9ef">NULL</span>)   <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(axis.text.x  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">element_text</span>(angle  <span style="color:#f92672">=</span>  <span style="color:#ae81ff">45</span>,  hjust<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)) <span style="color:#a6e22e">print</span>(p)
</span></span></code></pre></div><h4 id="b112-scm输出的文本摘要scm-text-summary-output">B.11.2 SCM输出的文本摘要(SCM text summary output)</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fortran" data-lang="fortran"><span style="display:flex;"><span><span style="color:#75715e">## Model directory /green/home/USER/estch718/isop_covariates/models/scm_run14/m1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## MODEL  TEST    BASE OFV   NEW OFV   TEST OFV (DROP) GOAL   dDF SIGNIFICANT PVAL
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  BASEAGE-2  PVAL   4962.29196   4952.05523   10.23673 &gt;   3.84150  1   YES! 0.001377
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  BASEDIAG-2 PVAL   4962.29196   4954.45130   7.84066  &gt;   5.99150  2   YES! 0.019835
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  BASESEX-2  PVAL   4962.29196   4955.05010   7.24186  &gt;   3.84150  1   YES! 0.007122
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  BASEWT-2   PVAL   4962.29196   4957.62887   4.66308  &gt;   3.84150  1   YES! 0.030818
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  C50AGE-2   PVAL   4962.29196   4898.86897   63.42299 &gt;   3.84150  1   YES! 1.67e-15
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  C50DIAG-2  PVAL   4962.29196   4937.24279   25.04916 &gt;   5.99150  2   YES! 0.000004
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  C50SEX-2   PVAL   4962.29196   4959.22473   3.06723  &gt;   3.84150  1      0.079886
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  C50WT-2    PVAL   4962.29196   4959.05895   3.23301  &gt;   3.84150  1      0.072168
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  NORMALAGE-2  PVAL   4962.29196   4904.83901   57.45295 &gt;   3.84150  1   YES! 3.46e-14
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALDIAG-2  PVAL   4962.29196   4883.73491   78.55705 &gt; 5.99150  2   YES! 8.74e-18
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALSEX-2    PVAL   4962.29196   4962.13938   0.15257 &gt;  3.84150  1   0.696090
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALWT-2 PVAL   4962.29196   4958.22705   4.06491 &gt;  3.84150  1   YES! 0.043783
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50AGE-2 PVAL   4962.29196   4932.99364   29.29832  &gt; 3.84150  1   YES! 6.20e-08
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50DIAG-2   PVAL   4962.29196   4927.98398   34.30798 &gt; 5.99150  2   YES! 3.55e-08
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50SEX-2 PVAL   4962.29196   4958.15679   4.13516  &gt;  3.84150  1   YES! 0.042001
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50WT-2 PVAL   4962.29196   4956.29366   5.99829  &gt;  3.84150  1   YES! 0.014320
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Parameter-covariate relation chosen in this forward step: NORMAL-DIAG-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## CRITERION   PVAL &lt; 0.05
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASE_MODEL_OFV 4962.29196
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## CHOSEN_MODEL_OFV 4883.73491
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Relations included after this step:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASE
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMAL DIAG-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  --------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Model directory /green/home/USER/estch718/isop_covariates/models/scm_run14/forward_scm_dir1/m1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## MODEL  TEST    BASE OFV   NEW OFV   TEST OFV (DROP) GOAL   dDF SIGNIFICANT PVAL
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASEAGE-2   PVAL   4883.73491   4877.07097   6.66394 &gt;  3.84150  1   YES! 0.009838
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASEDIAG-2  PVAL   4883.73491   4871.76993   11.96498 &gt; 5.99150  2   YES! 0.002523
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASESEX-2   PVAL   4883.73491   4872.96706   10.76786 &gt; 3.84150  1   YES! 0.001033
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASEWT-2    PVAL   4883.73491   4879.35381   4.38110  &gt;  3.84150  1   YES! 0.036340
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50AGE-2 PVAL   4883.73491   4845.35599   38.37893  &gt; 3.84150  1   YES! 5.83e-10
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50DIAG-2   PVAL   4883.73491   4881.28372   2.45119 &gt;  5.99150  2   0.293580
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50SEX-2 PVAL   4883.73491   4880.80471   2.93020  &gt;  3.84150  1   0.086937
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50WT-2 PVAL   4883.73491   4881.35728   2.37763  &gt;  3.84150  1   0.123080
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALAGE-2   PVAL   4883.73491   4870.69693   13.03798 &gt; 3.84150  1   YES! 0.000305
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALSEX-2    PVAL   4883.73491   4866.78023   16.95468 &gt; 3.84150  1   YES! 0.000038
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALWT-2 PVAL   4883.73491   4878.51777   5.21714 &gt;  3.84150  1   YES! 0.022365
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50AGE-2 PVAL   4883.73491   4860.40668   23.32823  &gt; 3.84150  1   YES! 0.000001
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50DIAG-2   PVAL   4883.73491   4881.29294   2.44197 &gt;  5.99150  2   0.294940
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50SEX-2 PVAL   4883.73491   4866.27328   17.46164  &gt; 3.84150  1   YES! 0.000029
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50WT-2 PVAL   4883.73491   4879.11279   4.62212  &gt;  3.84150  1   YES! 0.031562
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Parameter-covariate relation chosen in this forward step: C50-AGE-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## CRITERION   PVAL &lt; 0.05
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASE_MODEL_OFV 4883.73491
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## CHOSEN_MODEL_OFV 4845.35599
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Relations included after this step:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASE
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50  AGE-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMAL DIAG-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  --------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Model directory /green/home/USER/estch718/isop_covariates/models/scm_run14/forward_scm_dir1/scm_dir1/m1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## MODEL  TEST    BASE OFV   NEW OFV   TEST OFV (DROP) GOAL   dDF SIGNIFICANT PVAL
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASEAGE-2   PVAL   4845.35599   4848.65200   -3.29602 &gt; 3.84150  1   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASEDIAG-2  PVAL   4845.35599   4850.96014   -5.60415 &gt; 5.99150  2   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASESEX-2   PVAL   4845.35599   4840.26182   5.09417 &gt;  3.84150  1   YES! 0.024006
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASEWT-2    PVAL   4845.35599   4843.55534   1.80065  &gt;  3.84150  1   0.179630
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50AGE-3 PVAL   4845.35599   4848.54735   -3.19137 &gt; 3.84150  1   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50DIAG-2   PVAL   4845.35599   4848.62926   -3.27327 &gt; 5.99150  2   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50SEX-2 PVAL   4845.35599   4850.38852   -5.03253 &gt; 3.84150  1   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50WT-2 PVAL   4845.35599   4846.56889   -1.21291 &gt; 3.84150  1   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALAGE-2   PVAL   4845.35599   4840.72917   4.62682 &gt;  3.84150  1   YES! 0.031476
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALSEX-2    PVAL   4845.35599   4838.39465   6.96134 &gt;  3.84150  1   YES! 0.008329
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALWT-2 PVAL   4845.35599   4850.53065   -5.17467 &gt; 3.84150  1   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50AGE-2 PVAL   4845.35599   4841.77384   3.58215  &gt;  3.84150  1   0.058404
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50DIAG-2   PVAL   4845.35599   4846.75786   -1.40187 &gt; 5.99150  2   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50SEX-2 PVAL   4845.35599   4836.68161   8.67438  &gt;  3.84150  1   YES! 0.003227
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9999</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Parameter-covariate relation chosen in this forward step: T50-SEX-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## CRITERION   PVAL &lt; 0.05
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASE_MODEL_OFV 4845.35599
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## CHOSEN_MODEL_OFV 4836.68161
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Relations included after this step:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASE
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50  AGE-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMAL DIAG-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50  SEX-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  --------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  Model  directory  /green/home/USER/estch718/isop_covariates/models/scm_run14/forward_scm_dir1/scm_dir1/scm_dir1/m1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## MODEL  TEST    BASE OFV   NEW OFV   TEST OFV (DROP) GOAL   dDF SIGNIFICANT PVAL
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASEAGE-2   PVAL   4836.68161   4825.92119   10.76042 &gt; 3.84150  1   YES! 0.001037
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASEDIAG-2  PVAL   4836.68161   4836.10614   0.57547 &gt;  5.99150  2   0.749960
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASESEX-2   PVAL   4836.68161   4822.16658   14.51502 &gt; 3.84150  1   YES! 0.000139
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASEWT-2    PVAL   4836.68161   4826.67158   10.01003  &gt; 3.84150  1   YES! 0.001557
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50AGE-3 PVAL   4836.68161   4841.00847   -4.32687 &gt; 3.84150  1   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50DIAG-2   PVAL   4836.68161   4832.32558   4.35602 &gt;  5.99150  2   0.113270
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50SEX-2 PVAL   4836.68161   4832.13665   4.54496  &gt;  3.84150  1   YES! 0.033016
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50WT-2 PVAL   4836.68161   4830.37802   6.30359  &gt;  3.84150  1   YES! 0.012049
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALAGE-2   PVAL   4836.68161   4821.43645   15.24515 &gt; 3.84150  1   YES! 0.000094
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALSEX-2    PVAL   4836.68161   4836.79028   -0.10867 &gt; 3.84150  1   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALWT-2 PVAL   4836.68161   4830.99661   5.68499 &gt;  3.84150  1   YES! 0.017111
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50AGE-2 PVAL   4836.68161   4817.49657   19.18504  &gt; 3.84150  1   YES! 0.000012
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50DIAG-2   PVAL   4836.68161   4832.57805   4.10355 &gt;  5.99150  2   0.128510
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50WT-2 PVAL   4836.68161   4832.42314   4.25847  &gt;  3.84150  1   YES! 0.039055
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Parameter-covariate relation chosen in this forward step: T50-AGE-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## CRITERION   PVAL &lt; 0.05
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASE_MODEL_OFV 4836.68161
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## CHOSEN_MODEL_OFV 4817.49657
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Relations included after this step:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASE
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50  AGE-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMAL DIAG-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50  AGE-2  SEX-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  --------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  Model  directory  /green/home/USER/estch718/isop_covariates/models/scm_run14/forward_scm_dir1/scm_dir1/scm_dir1/scm_dir1/m1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## MODEL  TEST    BASE OFV   NEW OFV   TEST OFV (DROP) GOAL   dDF SIGNIFICANT PVAL
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  BASEAGE-2  PVAL   4817.49657   4812.03460   5.46197  &gt;   3.84150  1   YES! 0.019435
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  BASEDIAG-2 PVAL   4817.49657   4812.56759   4.92898  &gt;   5.99150  2      0.085052
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  BASESEX-2  PVAL   4817.49657   4808.11111   9.38545  &gt;   3.84150  1   YES! 0.002187
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  BASEWT-2   PVAL   4817.49657   4806.52627   10.97030 &gt;   3.84150  1   YES! 0.000926
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  C50AGE-3   PVAL   4817.49657   4811.26331   6.23326  &gt;   3.84150  1   YES! 0.012537
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  C50DIAG-2  PVAL   4817.49657   4810.21025   7.28632  &gt;   5.99150  2   YES! 0.026170
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  C50SEX-2   PVAL   4817.49657   4812.85533   4.64124  &gt;   3.84150  1   YES! 0.031213
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  C50WT-2    PVAL   4817.49657   4810.32347   7.17310  &gt;   3.84150  1   YES! 0.007400
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  NORMALAGE-2  PVAL   4817.49657   4810.18411   7.31245  &gt;   3.84150  1   YES! 0.006848
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  NORMALSEX-2   PVAL   4817.49657   4811.63157   5.86499  &gt;   3.84150  1   YES! 0.015445
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  NORMALWT-2   PVAL   4817.49657   4812.08371   5.41286  &gt;   3.84150  1   YES! 0.019989
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  T50AGE-3   PVAL   4817.49657   4808.20832   9.28825  &gt;   3.84150  1   YES! 0.002306
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  T50DIAG-2  PVAL   4817.49657   4810.30762   7.18895  &gt;   5.99150  2   YES! 0.027475
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  T50WT-2    PVAL   4817.49657   4807.36205   10.13451 &gt;   3.84150  1   YES! 0.001455
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##                                 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Parameter-covariate relation chosen in this forward step: BASE-WT-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## CRITERION   PVAL &lt; 0.05
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASE_MODEL_OFV 4817.49657
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## CHOSEN_MODEL_OFV 4806.52627
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Relations included after this step:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASE WT-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50  AGE-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMAL DIAG-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50  AGE-2  SEX-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  --------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  Model  directory  /green/home/USER/estch718/isop_covariates/models/scm_run14/forward_scm_dir1/scm_dir1/scm_dir1/scm_dir1/scm_di
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  MODEL TEST    BASE OFV   NEW OFV   TEST OFV (DROP)    GOAL   dDF SIGNIFICANT PVAL
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  BASEAGE-2  PVAL   4806.52627   4804.62739   1.89888  &gt;   3.84150  1   0.168200
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  BASEDIAG-2 PVAL   4806.52627   4806.26918   0.25709  &gt;   5.99150  2   0.879370
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  BASESEX-2  PVAL   4806.52627   4803.94117   2.58510  &gt;   3.84150  1   0.107870
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  BASEWT-3   PVAL   4806.52627   4806.20029   0.32598  &gt;   3.84150  1   0.568040
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  C50AGE-3   PVAL   4806.52627   4821.39555   -14.86928   &gt;   3.84150  1   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  C50DIAG-2  PVAL   4806.52627   4803.09786   3.42841  &gt;   5.99150  2   0.180110
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  C50SEX-2   PVAL   4806.52627   4806.13601   0.39027  &gt;   3.84150  1   0.532160
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  C50WT-2    PVAL   4806.52627   4804.95121   1.57506  &gt;   3.84150  1   0.209470
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  NORMALAGE-2  PVAL   4806.52627   4804.05143   2.47484  &gt;   3.84150  1   0.115680
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  NORMALSEX-2   PVAL   4806.52627   4806.35661   0.16966  &gt;   3.84150  1   0.680410
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  NORMALWT-2   PVAL   4806.52627   4805.41412   1.11215  &gt;   3.84150  1   0.291620
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  T50AGE-3   PVAL   4806.52627   4814.38508   -7.85881 &gt;   3.84150  1   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  T50DIAG-2  PVAL   4806.52627   4804.45764   2.06864  &gt;   5.99150  2   0.355470
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  T50WT-2    PVAL   4806.52627   4802.43554   4.09073  &gt;   3.84150  1   YES! 0.043119
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##                              
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Parameter-covariate relation chosen in this forward step: T50-WT-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## CRITERION   PVAL &lt; 0.05
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASE_MODEL_OFV 4806.52627
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## CHOSEN_MODEL_OFV 4802.43554
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Relations included after this step:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASE WT-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50  AGE-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMAL DIAG-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50  AGE-2  SEX-2   WT-2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  --------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  Model  directory  /green/home/USER/estch718/isop_covariates/models/scm_run14/forward_scm_dir1/scm_dir1/scm_dir1/scm_dir1/scm_di
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## MODEL  TEST    BASE OFV   NEW OFV   TEST OFV (DROP) GOAL   dDF SIGNIFICANT PVAL
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASEAGE-2   PVAL   4802.43554   4802.08290   0.35264 &gt;  3.84150  1   0.552620
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASEDIAG-2  PVAL   4802.43554   4802.77135   -0.33581 &gt; 5.99150  2   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASESEX-2   PVAL   4802.43554   4801.01227   1.42327 &gt;  3.84150  1   0.232870
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASEWT-3    PVAL   4802.43554   4798.94602   3.48952  &gt;  3.84150  1   0.061759
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50AGE-3 PVAL   4802.43554   4802.13061   0.30494  &gt;  3.84150  1   0.580800
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50DIAG-2   PVAL   4802.43554   4799.46007   2.97547 &gt;  5.99150  2   0.225880
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50SEX-2 PVAL   4802.43554   4802.25033   0.18521  &gt;  3.84150  1   0.666930
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50WT-2 PVAL   4802.43554   4802.28782   0.14772  &gt;  3.84150  1   0.700720
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALAGE-2   PVAL   4802.43554   4802.18536   0.25018 &gt;  3.84150  1   0.616950
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALSEX-2    PVAL   4802.43554   4803.01897   -0.58343 &gt; 3.84150  1   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALWT-2 PVAL   4802.43554   4803.03235   -0.59681 &gt; 3.84150  1   9999
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50AGE-3 PVAL   4802.43554   4799.18664   3.24890  &gt;  3.84150  1   0.071472
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50DIAG-2   PVAL   4802.43554   4800.51755   1.91799 &gt;  5.99150  2   0.383280
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50WT-3 PVAL   4802.43554   4802.02665   0.40889  &gt;  3.84150  1   0.522530
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  --------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  --------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Forward search done. Starting backward search inside forward top level directory
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## Model directory /green/home/USER/estch718/isop_covariates/models/scm_run14/backward_scm_dir1/m1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## MODEL  TEST    BASE OFV   NEW OFV   TEST OFV (DROP) GOAL   dDF INSIGNIFICANT PVAL
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## BASEWT-1    PVAL   4802.43554   4816.49239   -14.05684 &gt; -6.63490  -1  0.000177
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## C50AGE-1 PVAL   4802.43554   4826.36049   -23.92495 &gt; -6.63490  -1  0.000001
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## NORMALDIAG-1  PVAL   4802.43554   4874.50948   -72.07394 &gt; -9.21030  -2  2.24e-16
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50AGE-1 PVAL   4802.43554   4845.45767   -43.02213 &gt; -6.63490  -1  5.41e-11
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50SEX-1 PVAL   4802.43554   4848.49816   -46.06262 &gt; -6.63490  -1  1.15e-11
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">## T50WT-1 PVAL   4802.43554   4819.83165   -17.39611 &gt; -6.63490  -1  0.000030
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##  --------------------
</span></span></span></code></pre></div><h3 id="b12-frem">B.12 FREM</h3>
<h4 id="b121-相关性型矩阵correlation-matrix">B.12.1 相关性型矩阵(Correlation matrix)</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>xpdb28  <span style="color:#f92672">&lt;-</span>  xpose<span style="color:#f92672">::</span><span style="color:#a6e22e">xpose_data</span>(runno  <span style="color:#f92672">=</span>  <span style="color:#ae81ff">28</span>,  dir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;models&#34;</span>)  <span style="color:#75715e">#  Read  model  output</span>
</span></span><span style="display:flex;"><span>prm28 <span style="color:#f92672">&lt;-</span> xpose<span style="color:#f92672">::</span><span style="color:#a6e22e">get_prm</span>(xpdb28) <span style="color:#75715e"># Get final estimates</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>omg28  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">data.frame</span>(  prm28  <span style="color:#f92672">%&gt;%</span>  <span style="color:#75715e">#  Extract  omega  values</span>
</span></span><span style="display:flex;"><span>                          <span style="color:#a6e22e">filter</span>(type <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ome&#34;</span>)) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">select</span>(value,  name))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>lab <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">data.frame</span>( prm28 <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e">#  Get  omega  matrix  labels</span>
</span></span><span style="display:flex;"><span>                     <span style="color:#a6e22e">filter</span>(type <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;ome&#34;</span>),
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">!</span>label <span style="color:#f92672">%in%</span> <span style="color:#e6db74">&#34;&#34;</span> ) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">select</span>(label))
</span></span><span style="display:flex;"><span>labs <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.character</span>(<span style="color:#a6e22e">unique</span>(lab<span style="color:#f92672">$</span>label))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">matrix</span>(<span style="color:#ae81ff">0</span>, nrow <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>) <span style="color:#75715e"># Create empty omega matrix mat[upper.tri(mat, diag = TRUE)] &lt;- omg28$value # Fill upper triangle mat &lt;- t(mat) #  Inverse  matrix  to  get  lower  triangle</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">rownames</span>(mat) <span style="color:#f92672">&lt;-</span> lab<span style="color:#f92672">$</span>label <span style="color:#75715e"># Assign names to the matrix</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">colnames</span>(mat) <span style="color:#f92672">&lt;-</span> lab<span style="color:#f92672">$</span>label
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">diag</span>(mat) <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">gsub</span>(<span style="color:#e6db74">&#34;.*_&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, lab<span style="color:#f92672">$</span>label) <span style="color:#75715e"># Assign names to the diagonal</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dfmat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">melt</span>(mat) <span style="color:#75715e"># Melt for plotting</span>
</span></span><span style="display:flex;"><span>dfmat<span style="color:#f92672">$</span>text <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.numeric</span>(dfmat<span style="color:#f92672">$</span>value) <span style="color:#75715e"># Create info for plot text</span>
</span></span><span style="display:flex;"><span>dfmat<span style="color:#f92672">$</span>text  <span style="color:#f92672">&lt;-</span>  <span style="color:#a6e22e">ifelse</span>(<span style="color:#a6e22e">is.na</span>(dfmat<span style="color:#f92672">$</span>text),  dfmat<span style="color:#f92672">$</span>value,
</span></span><span style="display:flex;"><span>                       <span style="color:#a6e22e">ifelse</span>(dfmat<span style="color:#f92672">$</span>text <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#a6e22e">round</span>(dfmat<span style="color:#f92672">$</span>text, <span style="color:#ae81ff">2</span>))) dfmat<span style="color:#f92672">$</span>text <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ifelse</span>( <span style="color:#75715e"># Prettify for long name</span>
</span></span><span style="display:flex;"><span>                         dfmat<span style="color:#f92672">$</span>text <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;NORMAL&#34;</span>), <span style="color:#e6db74">&#34;	NORMAL&#34;</span>, dfmat<span style="color:#f92672">$</span>text) dfmat<span style="color:#f92672">$</span>value  <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.numeric</span>(dfmat<span style="color:#f92672">$</span>value)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(dfmat, <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> Var2, y<span style="color:#f92672">=</span> Var1, fill <span style="color:#f92672">=</span> value)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_tile</span>(color  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;white&#34;</span>)  <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>(label  <span style="color:#f92672">=</span>  text))  <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_regon</span>(<span style="color:#a6e22e">aes</span>(x0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">2.5</span>, y0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">6.5</span>, sides <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>, angle <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, r<span style="color:#f92672">=</span> <span style="color:#ae81ff">2.8</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Parameter-parameter correlation&#34;</span>), size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_regon</span>(<span style="color:#a6e22e">aes</span>(x0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">2.5</span>, y0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">2.5</span>, sides <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>, angle <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, r<span style="color:#f92672">=</span> <span style="color:#ae81ff">2.8</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Parameter-covariate   correlation&#34;</span>),   size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>,  alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_regon</span>(<span style="color:#a6e22e">aes</span>(x0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">6.5</span>, y0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">2.5</span>, sides <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>, angle <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, r<span style="color:#f92672">=</span> <span style="color:#ae81ff">2.8</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Covariate-covariate   correlation&#34;</span>),   size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>,  alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_gradient2</span>(   na.value   <span style="color:#f92672">=</span>   <span style="color:#e6db74">&#34;white&#34;</span>, low  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;blue&#34;</span>,  high  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;red&#34;</span>,  mid  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;white&#34;</span>, midpoint  <span style="color:#f92672">=</span>  <span style="color:#ae81ff">0</span>,  limit <span style="color:#f92672">=</span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-1.01</span>,  <span style="color:#ae81ff">1.01</span>))  <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_minimal</span>()   <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#  coord_fixed()  +</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_x_discrete</span>(limits<span style="color:#f92672">=</span>labs)  <span style="color:#f92672">+</span>  <span style="color:#75715e">#  Flip  the  x axis</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_y_discrete</span>(limits<span style="color:#f92672">=</span>labs<span style="color:#a6e22e">[length</span>(labs)<span style="color:#f92672">:</span><span style="color:#ae81ff">1</span>]) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(
</span></span><span style="display:flex;"><span>    axis.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(),
</span></span><span style="display:flex;"><span>    axis.title.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(),
</span></span><span style="display:flex;"><span>    axis.title.y <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(),
</span></span><span style="display:flex;"><span>    panel.grid.major <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(),
</span></span><span style="display:flex;"><span>    panel.border   <span style="color:#f92672">=</span>   <span style="color:#a6e22e">element_blank</span>(), panel.background  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">element_blank</span>(), axis.ticks    <span style="color:#f92672">=</span>    <span style="color:#a6e22e">element_blank</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#  legend.position  =  &#34;top&#34;#,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#  legend.direction  =  &#34;horizontal&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">guides</span>(fill  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">guide_colorbar</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># barwidth = 7, barheight = 4, title.position  =  &#34;top&#34;, title.hjust  =  0.5,</span>
</span></span><span style="display:flex;"><span>    title  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;Correlation  value&#34;</span>), color <span style="color:#f92672">=</span> <span style="color:#a6e22e">guide_legend</span>(<span style="color:#e6db74">&#34;&#34;</span>))
</span></span></code></pre></div><h4 id="b122-森林图forest-plot">B.12.2 森林图(Forest plot)</h4>
<p>•   从PsN输出的文件夹中导入数据</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>frem <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read.csv</span>( <span style="color:#75715e"># Get post processing info from PsN after running frem</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;models/frem_run11/results.csv&#34;</span>, fill <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>,
</span></span><span style="display:flex;"><span>  col.names   <span style="color:#f92672">=</span>   <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;V&#34;</span>,   <span style="color:#a6e22e">seq_len</span>(<span style="color:#ae81ff">8</span>)), header <span style="color:#f92672">=</span> F
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Data management</span>
</span></span><span style="display:flex;"><span>frem<span style="color:#f92672">$</span>tbl_id <span style="color:#f92672">&lt;-</span> <span style="color:#75715e"># Add unique ID for the different tables</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">cumsum</span>(frem<span style="color:#f92672">$</span>V2 <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cov_coef <span style="color:#f92672">&lt;-</span> <span style="color:#75715e"># Select lines with info for forest plots</span>
</span></span><span style="display:flex;"><span>  frem[frem<span style="color:#f92672">$</span>tbl_id <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>, ] <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">slice</span>(<span style="color:#ae81ff">-1</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">select</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">6</span>) <span style="color:#a6e22e">names</span>(cov_coef) <span style="color:#f92672">&lt;-</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lapply</span>(cov_coef[1,], as.character) <span style="color:#75715e"># rename columns</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cov_unex <span style="color:#f92672">&lt;-</span> <span style="color:#75715e"># Select lines with info for unexplained variability plots</span>
</span></span><span style="display:flex;"><span>  frem[frem<span style="color:#f92672">$</span>tbl_id  <span style="color:#f92672">==</span>  <span style="color:#ae81ff">5</span>,  ] <span style="color:#a6e22e">names</span>(cov_unex) <span style="color:#f92672">&lt;-</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lapply</span>(cov_unex[2,], as.character) <span style="color:#75715e"># rename columns</span>
</span></span><span style="display:flex;"><span>cov_unex <span style="color:#f92672">&lt;-</span> cov_unex[<span style="color:#f92672">-</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>), ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cov_stat <span style="color:#f92672">&lt;-</span> <span style="color:#75715e"># Select lines with cov stat info</span>
</span></span><span style="display:flex;"><span>  frem[frem<span style="color:#f92672">$</span>tbl_id <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>, ] <span style="color:#a6e22e">names</span>(cov_stat) <span style="color:#f92672">&lt;-</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lapply</span>(cov_stat[2,], as.character) <span style="color:#75715e">#  rename  columns</span>
</span></span><span style="display:flex;"><span>cov_stat <span style="color:#f92672">&lt;-</span> cov_stat[<span style="color:#f92672">-</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>), ] <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(`5th` <span style="color:#f92672">=</span>  p5,  `95th` <span style="color:#f92672">=</span>  p95)  <span style="color:#f92672">%&gt;%</span>  <span style="color:#75715e">#  Get  long  format</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">select</span>(covariate,  `5th`,  `95th`,  other)  <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">gather</span>(key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;condition&#34;</span>, value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;cov_stat&#34;</span>, `5th`, `95th`, other)
</span></span></code></pre></div><p>•   森林图</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>cov <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">merge</span>(cov_coef, cov_stat) <span style="color:#75715e"># Merge cov stat and cov coefficients and uncertainty</span>
</span></span><span style="display:flex;"><span>cov_p <span style="color:#f92672">&lt;-</span> cov <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate_at</span>(<span style="color:#a6e22e">list</span>(as.character), .vars <span style="color:#f92672">=</span> <span style="color:#a6e22e">vars</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span><span style="color:#f92672">:</span><span style="color:#ae81ff">6</span>)) <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e"># Format to numerics</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate_at</span>(<span style="color:#a6e22e">vars</span>(<span style="color:#ae81ff">4</span><span style="color:#f92672">:</span><span style="color:#ae81ff">6</span>), <span style="color:#a6e22e">list</span>(as.numeric)) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(
</span></span><span style="display:flex;"><span>    rp5 <span style="color:#f92672">=</span> p5 <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span><span style="color:#f92672">-</span> <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>    rp95 <span style="color:#f92672">=</span> p95 <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span><span style="color:#f92672">-</span> <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>    rmean <span style="color:#f92672">=</span> mean <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span><span style="color:#f92672">-</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e"># Convert to % and normalize to 0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(covariate <span style="color:#f92672">=</span> <span style="color:#a6e22e">recode</span>(
</span></span><span style="display:flex;"><span>    covariate,
</span></span><span style="display:flex;"><span>    AGE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Age&#34;</span>,
</span></span><span style="display:flex;"><span>    SEX <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sex&#34;</span>,
</span></span><span style="display:flex;"><span>    WT <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Weight&#34;</span>,
</span></span><span style="display:flex;"><span>    DIAG_2 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;COPD&#34;</span>,
</span></span><span style="display:flex;"><span>    DIAG_3 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;COPD and asthma&#34;</span>
</span></span><span style="display:flex;"><span>  ),
</span></span><span style="display:flex;"><span>  parameter <span style="color:#f92672">=</span> <span style="color:#a6e22e">recode</span>(
</span></span><span style="display:flex;"><span>    parameter,
</span></span><span style="display:flex;"><span>    BASE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Base&#34;</span>,
</span></span><span style="display:flex;"><span>    NORMAL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Normal&#34;</span>,
</span></span><span style="display:flex;"><span>    C50 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;C50&#34;</span>,
</span></span><span style="display:flex;"><span>    T50 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;T50&#34;</span>
</span></span><span style="display:flex;"><span>  )) <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e"># Rename</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(condition <span style="color:#f92672">=</span> <span style="color:#a6e22e">fct_relevel</span>(condition, <span style="color:#e6db74">&#34;other&#34;</span>, <span style="color:#e6db74">&#34;95th&#34;</span>, <span style="color:#e6db74">&#34;5th&#34;</span>)) <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e"># Reorder</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(covariate <span style="color:#f92672">=</span> <span style="color:#a6e22e">fct_relevel</span>(covariate, <span style="color:#e6db74">&#34;Age&#34;</span>, <span style="color:#e6db74">&#34;Weight&#34;</span>, <span style="color:#e6db74">&#34;COPD&#34;</span>, <span style="color:#e6db74">&#34;COPD and asthma&#34;</span>, <span style="color:#e6db74">&#34;Sex&#34;</span>))
</span></span><span style="display:flex;"><span>cov_p <span style="color:#f92672">&lt;-</span> cov_p <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e"># Remove infinite values from the plot</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(rmean <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(rmean <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2e+20</span>, <span style="color:#66d9ef">NA</span>, rmean),
</span></span><span style="display:flex;"><span>         rp5 <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(rp5 <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2e+20</span>, <span style="color:#66d9ef">NA</span>, rp5),
</span></span><span style="display:flex;"><span>         rp95 <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(rp95 <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2e+20</span>, <span style="color:#66d9ef">NA</span>, rp95))
</span></span><span style="display:flex;"><span>p1 <span style="color:#f92672">&lt;-</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(data <span style="color:#f92672">=</span> cov_p[cov_p<span style="color:#f92672">$</span>parameter <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Base&#34;</span>), ],
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">aes</span>(
</span></span><span style="display:flex;"><span>           y <span style="color:#f92672">=</span> condition,
</span></span><span style="display:flex;"><span>           x <span style="color:#f92672">=</span> rmean,
</span></span><span style="display:flex;"><span>           xmin <span style="color:#f92672">=</span> rp5,
</span></span><span style="display:flex;"><span>           xmax <span style="color:#f92672">=</span> rp95,
</span></span><span style="display:flex;"><span>           label <span style="color:#f92672">=</span> cov_stat
</span></span><span style="display:flex;"><span>         )) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_grid</span>(covariate<span style="color:#f92672">~</span>., scale<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;free&#34;</span>, labeller <span style="color:#f92672">=</span> <span style="color:#a6e22e">label_wrap_gen</span>(width<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>))<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>, linetype<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dashed&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept<span style="color:#f92672">=</span><span style="color:#ae81ff">-20</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>, linetype<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dotted&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept<span style="color:#f92672">=</span><span style="color:#ae81ff">+20</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>, linetype<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dotted&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_bw</span>()<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(nudge_y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.4</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_x_continuous</span>( name<span style="color:#f92672">=</span><span style="color:#66d9ef">NULL</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_y_discrete</span>( name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Base&#34;</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_errorbarh</span>(height<span style="color:#f92672">=</span><span style="color:#ae81ff">.1</span>) <span style="color:#f92672">+</span> <span style="color:#75715e">#adds the CIs</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">force_panelsizes</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>p2 <span style="color:#f92672">&lt;-</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(data <span style="color:#f92672">=</span> cov_p[cov_p<span style="color:#f92672">$</span>parameter <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Normal&#34;</span>), ],
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">aes</span>(
</span></span><span style="display:flex;"><span>           y <span style="color:#f92672">=</span> condition,
</span></span><span style="display:flex;"><span>           x <span style="color:#f92672">=</span> rmean,
</span></span><span style="display:flex;"><span>           xmin <span style="color:#f92672">=</span> rp5,
</span></span><span style="display:flex;"><span>           xmax <span style="color:#f92672">=</span> rp95,
</span></span><span style="display:flex;"><span>           label <span style="color:#f92672">=</span> cov_stat
</span></span><span style="display:flex;"><span>         )) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_grid</span>(covariate<span style="color:#f92672">~</span>., scale<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;free&#34;</span>, labeller <span style="color:#f92672">=</span> <span style="color:#a6e22e">label_wrap_gen</span>(width<span style="color:#f92672">=</span><span style="color:#ae81ff">1.5</span>))<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>, linetype<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dashed&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept<span style="color:#f92672">=</span><span style="color:#ae81ff">-20</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>, linetype<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dotted&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept<span style="color:#f92672">=</span><span style="color:#ae81ff">+20</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>, linetype<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dotted&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_bw</span>()<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(nudge_y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.4</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_x_continuous</span>( name<span style="color:#f92672">=</span><span style="color:#66d9ef">NULL</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_y_discrete</span>( name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Normal&#34;</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_errorbarh</span>(height<span style="color:#f92672">=</span><span style="color:#ae81ff">.1</span>)<span style="color:#f92672">+</span> <span style="color:#75715e">#adds the CIs</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">force_panelsizes</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>p3 <span style="color:#f92672">&lt;-</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(data <span style="color:#f92672">=</span> cov_p[cov_p<span style="color:#f92672">$</span>parameter <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;T50&#34;</span>), ],
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">aes</span>(
</span></span><span style="display:flex;"><span>           y <span style="color:#f92672">=</span> condition,
</span></span><span style="display:flex;"><span>           x <span style="color:#f92672">=</span> rmean,
</span></span><span style="display:flex;"><span>           xmin <span style="color:#f92672">=</span> rp5,
</span></span><span style="display:flex;"><span>           xmax <span style="color:#f92672">=</span> rp95,
</span></span><span style="display:flex;"><span>           label <span style="color:#f92672">=</span> cov_stat
</span></span><span style="display:flex;"><span>         )) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_grid</span>(covariate<span style="color:#f92672">~</span>., scale<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;free&#34;</span>, labeller <span style="color:#f92672">=</span> <span style="color:#a6e22e">label_wrap_gen</span>(width<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>))<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>, linetype<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dashed&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept<span style="color:#f92672">=</span><span style="color:#ae81ff">-20</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>, linetype<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dotted&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept<span style="color:#f92672">=</span><span style="color:#ae81ff">+20</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>, linetype<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dotted&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_bw</span>()<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(nudge_y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.4</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_x_continuous</span>( name<span style="color:#f92672">=</span><span style="color:#66d9ef">NULL</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_y_discrete</span>( name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;T50&#34;</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_errorbarh</span>(height<span style="color:#f92672">=</span><span style="color:#ae81ff">.1</span>) <span style="color:#f92672">+</span> <span style="color:#75715e">#adds the CIs</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">force_panelsizes</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>p4 <span style="color:#f92672">&lt;-</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(data <span style="color:#f92672">=</span> cov_p[cov_p<span style="color:#f92672">$</span>parameter <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;C50&#34;</span>), ],
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">aes</span>(
</span></span><span style="display:flex;"><span>           y <span style="color:#f92672">=</span> condition,
</span></span><span style="display:flex;"><span>           x <span style="color:#f92672">=</span> rmean,
</span></span><span style="display:flex;"><span>           xmin <span style="color:#f92672">=</span> rp5,
</span></span><span style="display:flex;"><span>           xmax <span style="color:#f92672">=</span> rp95,
</span></span><span style="display:flex;"><span>           label<span style="color:#f92672">=</span>cov_stat
</span></span><span style="display:flex;"><span>         )) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_point</span>()<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_grid</span>(covariate<span style="color:#f92672">~</span>.,scale<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;free&#34;</span>,labeller<span style="color:#f92672">=</span><span style="color:#a6e22e">label_wrap_gen</span>(width<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>))<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>,linetype<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dashed&#34;</span>,alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept<span style="color:#f92672">=</span><span style="color:#ae81ff">-20</span>,color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>,linetype<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dotted&#34;</span>,alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept<span style="color:#f92672">=</span><span style="color:#ae81ff">+20</span>,color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>,linetype<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dotted&#34;</span>,alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_bw</span>()<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">force_panelsizes</span>()<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(nudge_y<span style="color:#f92672">=</span><span style="color:#ae81ff">0.4</span>,size<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_x_continuous</span>(name<span style="color:#f92672">=</span><span style="color:#66d9ef">NULL</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_y_discrete</span>(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;C50&#34;</span>)<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_errorbarh</span>(height<span style="color:#f92672">=</span><span style="color:#ae81ff">.1</span>)<span style="color:#f92672">+</span><span style="color:#75715e">#addstheCIs</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(text<span style="color:#f92672">=</span><span style="color:#a6e22e">element_text</span>(size<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>gridExtra<span style="color:#f92672">::</span><span style="color:#a6e22e">grid.arrange</span>(p1,p2,p3,p4, nrow<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>                        bottom<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Effectsizeinpercent&#34;</span>)
</span></span></code></pre></div><h4 id="b123-无法解释的变异unexplained-variability">B.12.3 无法解释的变异(Unexplained variability)</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>cov_u <span style="color:#f92672">&lt;-</span> cov_unex <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">select</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate_at</span>(<span style="color:#a6e22e">list</span>(as.character),    .vars    <span style="color:#f92672">=</span>	<span style="color:#a6e22e">vars</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>)) <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e"># Convert to numerics</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate_at</span>(<span style="color:#a6e22e">vars</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>),    <span style="color:#a6e22e">list</span>(as.numeric))    <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">mutate</span>(	<span style="color:#75715e"># Rename</span>
</span></span><span style="display:flex;"><span>    covariate <span style="color:#f92672">=</span> <span style="color:#a6e22e">recode</span>( covariate,
</span></span><span style="display:flex;"><span>                        none <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;None&#34;</span>, all <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;All&#34;</span>, AGE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Age&#34;</span>, SEX <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Sex&#34;</span>,
</span></span><span style="display:flex;"><span>                        WT <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Weight&#34;</span>, DIAG_2 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;COPD&#34;</span>,
</span></span><span style="display:flex;"><span>                        DIAG_3 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;COPD and asthma&#34;</span>
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>    parameter <span style="color:#f92672">=</span> <span style="color:#a6e22e">recode</span>( parameter,
</span></span><span style="display:flex;"><span>                        BASE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Base&#34;</span>,
</span></span><span style="display:flex;"><span>                        NORMAL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Normal&#34;</span>, C50 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;C50&#34;</span>,
</span></span><span style="display:flex;"><span>                        T50 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;T50&#34;</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(covariate  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">fct_relevel</span>(covariate,  <span style="color:#75715e">#   Reorder</span>
</span></span><span style="display:flex;"><span>                                   <span style="color:#e6db74">&#34;All&#34;</span>, <span style="color:#e6db74">&#34;Age&#34;</span>, <span style="color:#e6db74">&#34;Weight&#34;</span>, <span style="color:#e6db74">&#34;COPD&#34;</span>, <span style="color:#e6db74">&#34;COPD and asthma&#34;</span>, <span style="color:#e6db74">&#34;Sex&#34;</span>, <span style="color:#e6db74">&#34;None&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(data  <span style="color:#f92672">=</span>  cov_u,
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">aes</span>(
</span></span><span style="display:flex;"><span>         y  <span style="color:#f92672">=</span>  covariate,
</span></span><span style="display:flex;"><span>         x  <span style="color:#f92672">=</span>  sd_observed, xmin  <span style="color:#f92672">=</span>  sd_5th, xmax <span style="color:#f92672">=</span> sd_95th
</span></span><span style="display:flex;"><span>       )) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_wrap</span>(parameter <span style="color:#f92672">~</span> ., scale <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_bw</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_x_continuous</span>(name  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;Standard  deviation  of  unexplained  variability&#34;</span>)  <span style="color:#f92672">+</span> <span style="color:#a6e22e">scale_y_discrete</span>(name  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;Covariate&#34;</span>)  <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_errorbarh</span>(height <span style="color:#f92672">=</span> <span style="color:#ae81ff">.1</span>) <span style="color:#75715e">#adds the CIs</span>
</span></span></code></pre></div><h3 id="b13-森林图forest-plots">B.13 森林图(Forest plots)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>xpdb20  <span style="color:#f92672">&lt;-</span>  xpose<span style="color:#f92672">::</span><span style="color:#a6e22e">xpose_data</span>(runno<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>,  dir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;models/&#34;</span>) prm20f <span style="color:#f92672">&lt;-</span> xpose<span style="color:#f92672">::</span><span style="color:#a6e22e">get_prm</span>(xpdb20)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>prm20f<span style="color:#f92672">$</span>se <span style="color:#f92672">&lt;-</span> <span style="color:#75715e">#  Values  from  SIR</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">8.75124</span>, <span style="color:#ae81ff">29.85375</span>, <span style="color:#ae81ff">5.166212</span>, <span style="color:#ae81ff">2.273961</span>, <span style="color:#ae81ff">0.07364673</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0.7777551</span>, <span style="color:#ae81ff">0.03512398</span>, <span style="color:#ae81ff">0.04976547</span>, <span style="color:#ae81ff">0.001446226</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0.04206618</span>, <span style="color:#ae81ff">0.009734037</span>, <span style="color:#ae81ff">0.6732954</span>, <span style="color:#ae81ff">0.268544</span>, <span style="color:#ae81ff">0.003135913</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>prmp <span style="color:#f92672">&lt;-</span> prm20f <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">filter</span>(type <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;the&#34;</span>), <span style="color:#75715e"># Select only  covariates effects</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">!</span><span style="color:#a6e22e">grepl</span>(<span style="color:#e6db74">&#34;TV_&#34;</span>, label) ) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">select</span>(label, value, se)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (i <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">75</span>)){ <span style="color:#75715e"># Covariate effect at different ages</span>
</span></span><span style="display:flex;"><span>  prmp <span style="color:#f92672">&lt;-</span> prmp <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">slice</span>(<span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">1</span>))  <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mutate</span>(label <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;Age &#34;</span>, i, <span style="color:#e6db74">&#34; years&#34;</span>), value <span style="color:#f92672">=</span> value <span style="color:#f92672">*</span> (i <span style="color:#f92672">-</span> <span style="color:#ae81ff">40</span>),
</span></span><span style="display:flex;"><span>           se <span style="color:#f92672">=</span> se <span style="color:#f92672">*</span> (i <span style="color:#f92672">-</span> <span style="color:#ae81ff">40</span>)) <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e"># SE value from SIR</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">add_row</span>(., .before<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, prmp)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (i <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>)){ <span style="color:#75715e">#  Covariate  effect for  the  DIAG  categories</span>
</span></span><span style="display:flex;"><span>  prmp <span style="color:#f92672">&lt;-</span> prmp <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">slice</span>(<span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>))  <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mutate</span>(label <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(i <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;Asthma&#34;</span>,
</span></span><span style="display:flex;"><span>                          <span style="color:#a6e22e">ifelse</span>(i <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#34;COPD&#34;</span>,
</span></span><span style="display:flex;"><span>                                 <span style="color:#e6db74">&#34;COPD and Asthma&#34;</span>)), value  <span style="color:#f92672">=</span>  value  <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> i),
</span></span><span style="display:flex;"><span>           se <span style="color:#f92672">=</span> se <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> i)) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">add_row</span>(., .before<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, prmp)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>prmp <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e"># Create the plot</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">filter</span>(<span style="color:#f92672">!</span>label <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;FYEARS&#34;</span>, <span style="color:#e6db74">&#34;DIAG&#34;</span>)) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>( ci5	<span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> (value <span style="color:#f92672">-</span> <span style="color:#ae81ff">1.96</span><span style="color:#f92672">*</span>se), <span style="color:#75715e"># Get the 95 CI</span>
</span></span><span style="display:flex;"><span>          ci95  <span style="color:#f92672">=</span>  <span style="color:#ae81ff">1</span>  <span style="color:#f92672">+</span>  (value  <span style="color:#f92672">+</span>  <span style="color:#ae81ff">1.96</span><span style="color:#f92672">*</span>se),
</span></span><span style="display:flex;"><span>          value <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> value, <span style="color:#75715e">#  Covariate  equation</span>
</span></span><span style="display:flex;"><span>          nb <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(value <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">paste0</span>(<span style="color:#a6e22e">round</span>(value, <span style="color:#ae81ff">3</span>), <span style="color:#e6db74">&#34; [&#34;</span>, <span style="color:#75715e"># Text</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#a6e22e">round</span>(ci5, <span style="color:#ae81ff">3</span>), <span style="color:#e6db74">&#34; - &#34;</span>,
</span></span><span style="display:flex;"><span>                                        <span style="color:#a6e22e">round</span>(ci95, <span style="color:#ae81ff">3</span>), <span style="color:#e6db74">&#34;]&#34;</span>),
</span></span><span style="display:flex;"><span>                      
</span></span><span style="display:flex;"><span>                      <span style="color:#a6e22e">paste0</span>(<span style="color:#a6e22e">round</span>(value, <span style="color:#ae81ff">3</span>), <span style="color:#e6db74">&#34; [&#34;</span>,
</span></span><span style="display:flex;"><span>                             <span style="color:#a6e22e">round</span>(ci95, <span style="color:#ae81ff">3</span>), <span style="color:#e6db74">&#34; - &#34;</span>,
</span></span><span style="display:flex;"><span>                             <span style="color:#a6e22e">round</span>(ci5, <span style="color:#ae81ff">3</span>), <span style="color:#e6db74">&#34;]&#34;</span>))) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">ggplot</span>(., <span style="color:#a6e22e">aes</span>( y<span style="color:#f92672">=</span> label, x<span style="color:#f92672">=</span> value,
</span></span><span style="display:flex;"><span>                                                                      xmin <span style="color:#f92672">=</span> ci5, xmax <span style="color:#f92672">=</span> ci95 )) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(color <span style="color:#f92672">=</span> label), shape<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_errorbarh</span>(<span style="color:#a6e22e">aes</span>(color  <span style="color:#f92672">=</span>  label),  height<span style="color:#f92672">=</span><span style="color:#ae81ff">.1</span>)  <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,  color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>,  linetype<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dashed&#34;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>)<span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>(label<span style="color:#f92672">=</span>nb, x<span style="color:#f92672">=</span> <span style="color:#ae81ff">1.5</span>), hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_x_continuous</span>( name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Covariate effect on Normal&#34;</span>,
</span></span><span style="display:flex;"><span>                      limits  <span style="color:#f92672">=</span>   <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.35</span>,<span style="color:#ae81ff">2</span>))   <span style="color:#f92672">+</span> <span style="color:#a6e22e">scale_y_discrete</span>( name<span style="color:#f92672">=</span><span style="color:#66d9ef">NULL</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_bw</span>() <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme</span>(legend.position   <span style="color:#f92672">=</span>   <span style="color:#e6db74">&#34;none&#34;</span>)
</span></span></code></pre></div><h3 id="b14-vpcs">B.14 VPCs</h3>
<h4 id="b141-默认的可视化预测检验default-vpcs">B.14.1 默认的可视化预测检验(Default VPCs)</h4>
<p>图S16中左侧面板的默认的可视化预测检验</p>
<p>•   PsN命令:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>vpc run11.mod -samples=500 -auto_bin=auto -rplots=1 -dir=run11_vpc_n500
</span></span></code></pre></div><p>•   R代码:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>vpc <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(n) { <span style="color:#75715e"># Function to create non stratified VPC</span>
</span></span><span style="display:flex;"><span>  xpdb <span style="color:#f92672">&lt;-</span> <span style="color:#75715e"># Read model information from PsN model folder</span>
</span></span><span style="display:flex;"><span>    xpose<span style="color:#f92672">::</span><span style="color:#a6e22e">xpose_data</span>(runno <span style="color:#f92672">=</span> n, dir <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;models&#34;</span>)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  p  <span style="color:#f92672">&lt;-</span>  vpc<span style="color:#f92672">::</span><span style="color:#a6e22e">vpc</span>(
</span></span><span style="display:flex;"><span>    psn_folder  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;models/run&#34;</span>,  n,  <span style="color:#e6db74">&#34;_vpc_n500&#34;</span>), show <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(
</span></span><span style="display:flex;"><span>      obs_dv <span style="color:#f92672">=</span> T, sim_median <span style="color:#f92672">=</span> T, <span style="color:#66d9ef">pi</span> <span style="color:#f92672">=</span>  T
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pi</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.05</span>, <span style="color:#ae81ff">0.95</span>),
</span></span><span style="display:flex;"><span>    ci <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.025</span>, <span style="color:#ae81ff">0.975</span>),
</span></span><span style="display:flex;"><span>    xlab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Time (h)&#34;</span>, ylab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PEFR (L/min)&#34;</span>, title <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    vpc_theme <span style="color:#f92672">=</span> vpc<span style="color:#f92672">::</span><span style="color:#a6e22e">new_vpc_theme</span>( update <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(
</span></span><span style="display:flex;"><span>      obs_shape <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;.&#34;</span>, obs_median_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, obs_median_linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;solid&#34;</span>, obs_median_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, obs_ci_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#3388cc&#34;</span>, obs_ci_linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;solid&#34;</span>,
</span></span><span style="display:flex;"><span>      sim_pi_linetype  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#39;dashed&#39;</span>,
</span></span><span style="display:flex;"><span>      sim_pi_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, sim_pi_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#3388cc&#34;</span>, sim_median_fill  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;black&#34;</span>, sim_median_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>,
</span></span><span style="display:flex;"><span>      sim_median_linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dashed&#34;</span>, sim_median_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_bw</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scale_x_continuous</span>(limits  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">450</span>))  <span style="color:#f92672">+</span> <span style="color:#a6e22e">scale_y_continuous</span>(limits  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">900</span>))
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>(p)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>vpc11 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">vpc</span>(<span style="color:#ae81ff">11</span>) <span style="color:#f92672">+</span> <span style="color:#75715e"># Create VPC for run n</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(subtitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Model without covariates (run11)&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>vpc25 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">vpc</span>(<span style="color:#ae81ff">25</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(subtitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Covariate model from SCM (run25)&#34;</span>, y<span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">grid.arrange</span>(vpc11, vpc25, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>)
</span></span></code></pre></div><h4 id="b142-分层的可视化预测检验stratified-vpcs">B.14.2 分层的可视化预测检验(Stratified VPCs)</h4>
<p>将连续协变量转化为二分类以分层绘制可视化预测检验图 S17.</p>
<p>•   PsN命令:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>vpc run110.mod  -samples=500  -auto_bin=auto  -stratify_on=AGEC -rplots=1  -dir=run110_vpc_n500_stratAGEC
</span></span></code></pre></div><p>•  添加到 NONMEM 代码行以用于将连续协变量转化为二分类变量:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fortran" data-lang="fortran"><span style="display:flex;"><span><span style="color:#f92672">&gt;</span> AGEC<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">IF</span>(AGE.GT.<span style="color:#ae81ff">34</span>)AGEC<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;</span> <span style="color:#960050;background-color:#1e0010">$</span>TABLE ID TIME SEX DIAG AGEC YNOPRINT ONEHEADER <span style="color:#66d9ef">FILE</span><span style="color:#f92672">=</span>catab110
</span></span></code></pre></div><p>•   R代码:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>lab <span style="color:#f92672">&lt;-</span> <span style="color:#75715e"># Custom strip labels</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AGE =&lt; 34 years&#34;</span>, <span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AGE &gt; 34 years&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>vpc_strat <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(n, cov) { <span style="color:#75715e"># VPC function with stratification</span>
</span></span><span style="display:flex;"><span>  xpdb <span style="color:#f92672">&lt;-</span> <span style="color:#75715e"># Read model information from PsN model folder</span>
</span></span><span style="display:flex;"><span>    xpose<span style="color:#f92672">::</span><span style="color:#a6e22e">xpose_data</span>(runno <span style="color:#f92672">=</span> n, dir <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;models&#34;</span>)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  p  <span style="color:#f92672">&lt;-</span>  vpc<span style="color:#f92672">::</span><span style="color:#a6e22e">vpc</span>(
</span></span><span style="display:flex;"><span>    psn_folder  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;models/run&#34;</span>,  n,  <span style="color:#e6db74">&#34;_vpc_n500_strat&#34;</span>,  cov), show <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(
</span></span><span style="display:flex;"><span>      obs_dv <span style="color:#f92672">=</span> T, sim_median <span style="color:#f92672">=</span> T, <span style="color:#66d9ef">pi</span> <span style="color:#f92672">=</span>  T
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>    stratify  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">c</span>(cov), facet <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;rows&#34;</span>,
</span></span><span style="display:flex;"><span>    labeller  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">labeller</span>(AGEC  <span style="color:#f92672">=</span>  lab), <span style="color:#66d9ef">pi</span>  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.05</span>,  <span style="color:#ae81ff">0.95</span>),
</span></span><span style="display:flex;"><span>    ci <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.025</span>, <span style="color:#ae81ff">0.975</span>),
</span></span><span style="display:flex;"><span>    xlab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Time (h)&#34;</span>, ylab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PEFR (L/min)&#34;</span>, title <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    vpc_theme <span style="color:#f92672">=</span> vpc<span style="color:#f92672">::</span><span style="color:#a6e22e">new_vpc_theme</span>( update <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(
</span></span><span style="display:flex;"><span>      obs_shape <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;.&#34;</span>, obs_median_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, obs_median_linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;solid&#34;</span>, obs_median_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, obs_ci_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#3388cc&#34;</span>, obs_ci_linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;solid&#34;</span>,
</span></span><span style="display:flex;"><span>      sim_pi_linetype  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#39;dashed&#39;</span>,
</span></span><span style="display:flex;"><span>      sim_pi_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, sim_pi_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#3388cc&#34;</span>, sim_median_fill  <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;black&#34;</span>, sim_median_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>,
</span></span><span style="display:flex;"><span>      sim_median_linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dashed&#34;</span>, sim_median_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_bw</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scale_x_continuous</span>(limits  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">450</span>))  <span style="color:#f92672">+</span> <span style="color:#a6e22e">scale_y_continuous</span>(limits  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,  <span style="color:#ae81ff">950</span>))
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>(p)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>vpc110 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">vpc_strat</span>(<span style="color:#ae81ff">110</span>, <span style="color:#e6db74">&#34;AGEC&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(subtitle <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;Model without  covariates  (run11)&#34;</span>, x <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>vpc250 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">vpc_strat</span>(<span style="color:#ae81ff">250</span>, <span style="color:#e6db74">&#34;AGEC&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(subtitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Covariate model from SCM (run25)&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">grid.arrange</span>(vpc110, vpc250, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)
</span></span></code></pre></div><h4 id="b143-使用协变量最为作为自变量的可视化预测检验vpcs-using-a-covariate-as-independent-variable">B.14.3 使用协变量最为作为自变量的可视化预测检验(VPCs using a covariate as independent variable)</h4>
<p>使用协变量最为作为自变量的可视化预测检验 (图 S18)</p>
<p>•   PsN 命令:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>vpc run11.mod -samples=500 -auto_bin=auto -idv=AGE -rplots=1 -dir=run11_vpc_n500_idvAGE
</span></span></code></pre></div><p>•   R 代码:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>vpc <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(n) { <span style="color:#75715e"># Function to create non stratified VPC</span>
</span></span><span style="display:flex;"><span>  xpdb <span style="color:#f92672">&lt;-</span> <span style="color:#75715e"># Read model information from PsN model folder</span>
</span></span><span style="display:flex;"><span>    xpose<span style="color:#f92672">::</span><span style="color:#a6e22e">xpose_data</span>(runno <span style="color:#f92672">=</span> n, dir <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;models&#34;</span>)
</span></span><span style="display:flex;"><span>  p <span style="color:#f92672">&lt;-</span> vpc<span style="color:#f92672">::</span><span style="color:#a6e22e">vpc</span>(
</span></span><span style="display:flex;"><span>    psn_folder <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;models/run&#34;</span>, n, <span style="color:#e6db74">&#34;_vpc_n500_idvAGE&#34;</span>),
</span></span><span style="display:flex;"><span>    obs_cols <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(idv<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;AGE&#34;</span>),
</span></span><span style="display:flex;"><span>    sim_cols <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(idv<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;AGE&#34;</span>),
</span></span><span style="display:flex;"><span>    show <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(
</span></span><span style="display:flex;"><span>      obs_dv <span style="color:#f92672">=</span> T,
</span></span><span style="display:flex;"><span>      sim_median <span style="color:#f92672">=</span> T,
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">pi</span> <span style="color:#f92672">=</span> T
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pi</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.05</span>, <span style="color:#ae81ff">0.95</span>),
</span></span><span style="display:flex;"><span>    ci <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.025</span>, <span style="color:#ae81ff">0.975</span>),
</span></span><span style="display:flex;"><span>    xlab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Age (year)&#34;</span>,
</span></span><span style="display:flex;"><span>    ylab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PEFR (L/min)&#34;</span>,
</span></span><span style="display:flex;"><span>    title <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    vpc_theme <span style="color:#f92672">=</span> vpc<span style="color:#f92672">::</span><span style="color:#a6e22e">new_vpc_theme</span>(
</span></span><span style="display:flex;"><span>      update <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(
</span></span><span style="display:flex;"><span>        obs_shape <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;.&#34;</span>,
</span></span><span style="display:flex;"><span>        obs_median_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>,
</span></span><span style="display:flex;"><span>        obs_median_linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;solid&#34;</span>,
</span></span><span style="display:flex;"><span>        obs_median_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>,
</span></span><span style="display:flex;"><span>        obs_ci_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#3388cc&#34;</span>,
</span></span><span style="display:flex;"><span>        obs_ci_linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;solid&#34;</span>,
</span></span><span style="display:flex;"><span>        sim_pi_linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;dashed&#39;</span>,
</span></span><span style="display:flex;"><span>        sim_pi_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>,
</span></span><span style="display:flex;"><span>        sim_pi_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#3388cc&#34;</span>,
</span></span><span style="display:flex;"><span>        sim_median_fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>,
</span></span><span style="display:flex;"><span>        sim_median_color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>,
</span></span><span style="display:flex;"><span>        sim_median_linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dashed&#34;</span>,
</span></span><span style="display:flex;"><span>        sim_median_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_bw</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scale_y_continuous</span>(limits <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">850</span>))
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>(p)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>vpc11 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">vpc</span>(<span style="color:#ae81ff">11</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(subtitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Model without covariates (run11)&#34;</span>)
</span></span><span style="display:flex;"><span>vpc25 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">vpc</span>(<span style="color:#ae81ff">25</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(subtitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Covariate model from SCM (run25)&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">grid.arrange</span>(vpc11, vpc25, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>)
</span></span></code></pre></div><h2 id="c-添加包与环境libraries-and-environment">C 添加包与环境(Libraries and environment)</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#75715e">## R version 4.1.2 (2021-11-01)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Platform: x86_64-apple-darwin17.0 (64-bit)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Running under: macOS Big Sur 10.16</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Matrix products: default</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## BLAS: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## LAPACK:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## locale:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## attached base packages:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [1] stats  graphics  grDevices utils  datasets methods base</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## other attached packages:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [1] xpose_0.4.13   forcats_0.5.1  stringr_1.4.0  readr_2.1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [5] tidyr_1.1.4 tibble_3.1.6   tidyverse_1.3.1   summarytools_1.0.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [9] reshape2_1.4.4 purrr_0.3.4   PsNR_0.2.0   plyr_1.8.6</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [13] patchwork_1.1.1   knitr_1.36    kableExtra_1.3.4   huxtable_5.4.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [17] ggh4x_0.2.1   ggpubr_0.4.0 ggiraphExtra_0.3.0 ggiraph_0.7.10</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [21] ggforce_0.3.3  GGally_2.1.2  ggplot2_3.3.5 gtsummary_1.5.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [25] ftExtra_0.2.0   dplyr_1.0.7   data.table_1.14.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## loaded via a namespace (and not attached):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [1] colorspace_2.0-2    ggsignif_0.6.3 pryr_0.1.5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [4] ellipsis_0.3.2   sjlabelled_1.1.8   flextable_0.6.10</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [7] fs_1.5.0   base64enc_0.1-3  rstudioapi_0.13</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [10] farver_2.1.0   bit64_4.0.5   fansi_0.5.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [13] lubridate_1.8.0 xml2_1.3.2   codetools_0.2-18</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [16] splines_4.1.2   sjmisc_2.8.7  polyclip_1.10-0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [19] jsonlite_1.7.2   gt_0.3.1  broom_0.7.10</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [22] dbplyr_2.1.1   compiler_4.1.2    httr_1.4.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [25] backports_1.3.0    assertthat_0.2.1   Matrix_1.3-4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [28] fastmap_1.1.0  cli_3.1.0  tweenr_1.0.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [31] htmltools_0.5.2 tools_4.1.2   gtable_0.3.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [34] glue_1.5.0 Rcpp_1.0.7   carData_3.0-4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [37] cellranger_1.1.0    vctrs_0.3.8   svglite_2.0.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [40] nlme_3.1-153  broom.helpers_1.4.0  insight_0.14.5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [43] xfun_0.28 rvest_1.0.2   lifecycle_1.0.1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [46]  rstatix_0.7.0 MASS_7.3-54 scales_1.1.1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [49] vroom_1.5.6   hms_1.1.1   parallel_4.1.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [52] mycor_0.1.1   RColorBrewer_1.1-2 yaml_2.2.1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [55] pander_0.6.4  gdtools_0.2.3 reshape_0.8.8</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [58]  stringi_1.7.5 checkmate_2.0.0  ppcor_1.1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [61] zip_2.2.0  commonmark_1.7 rlang_0.4.12</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [64] pkgconfig_2.0.3    systemfonts_1.0.2 matrixStats_0.61.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [67] evaluate_0.14  lattice_0.20-45    rapportools_1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [70] htmlwidgets_1.5.4  bit_4.0.4 tidyselect_1.1.1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [73] magrittr_2.0.1  bookdown_0.24  R6_2.5.1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [76] magick_2.7.3  generics_0.1.1    DBI_1.1.1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [79] pillar_1.6.4 haven_2.4.3  withr_2.4.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [82] mgcv_1.8-38  abind_1.4-5  modelr_0.1.8</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [85] crayon_1.4.2   car_3.0-12   uuid_1.0-3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [88] utf8_1.2.2 tzdb_0.2.0   rmarkdown_2.11</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [91] officer_0.4.1   grid_4.1.2    readxl_1.3.1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [94] reprex_2.0.1   digest_0.6.28 webshot_0.5.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [97] munsell_0.5.0  viridisLite_0.4.0   tcltk_4.1.2</span>
</span></span></code></pre></div><h1 id="附件二">附件二：</h1>
<h1 id="组合协变量关系的示例">组合协变量关系的示例</h1>
<p>协变量模型通常由多个单独的协变量效应通过相乘进行组合而成。如果协变量效应是根据标准协变量值定义的，当协变量具有标准值时，协变量效应的值为 1，则群体参数值$CL_{pop}$将表示标准个体的值，例如 70 公斤、176 厘米、年龄 40 岁、肾功能正常、男性。预测参数$CL_{grp}$描述了一组具有相同协变量的受试者的典型参数。
</p>
$$
CL_{grp}= CL_{pop}  \times fsize   \times fmat   \times fof  \times fgeno   \times fconmed \tag{方程 1}
$$
<p>其中</p>
$$
fsize=(\frac{NFM}{NFMstd})^{3/4} \tag{方程 2}
$$
$$
fmat=(\frac{1}{1+(\frac{PMA}{Tmat50})^{-HillMat}}) \tag{方程 3}
$$
$$
fof=\frac{CLcr}{CLcrstd} \tag{方程 4}
$$
<p>$fgeno$ = if $sex$==$female$ then $Ffemale$ else $1$ (方程 5)</p>
<p>$fconmed$ = if $conmed$ == $amiodarone$  then  $Famio$  else  $1$ (方程 6)</p>
<p>体型大小的协变量函数fsize表示使用标准个体（总体重70公斤，身高176厘米，男性）的NFM标准化后的个体正常脂肪量（NFM）。它被嵌入到一个幂函数中，使用一个基于理论的适合于清除率的异速缩放指数。</p>
<p>对于新生儿、婴儿和幼儿来说，器官成熟的影响fmat可以用sigmoid模型来描述，该模型包括成熟半衰Tmat50、成熟陡峭因子HillMat和月经后年龄 PMA（通常以周为单位表示）。使用标准肌酐清除率CLcr对个体的CLcr进行标准化用于表示肾功能，表示器官功能效应，即器官功能协变量fof。由于器官功能通常随着体型大小和成熟而变化，因此应调整器官功能的标准值，使其与CLcr预测值中隐含的大小和成熟度一致，例如，利用肾小球滤过率的大小和成熟开发[1]。基因型函数 fgeno ，用性别来说明。当性别为女性时，该函数已通过参数 Ffemale 预测。伴随药物，如fgeno，通常是分类的，但也可能是剂量的函数。</p>
<p>清除率可以被分为两个或多个组分，每个组分可以有自己的一组协变量函数，例如，可以使用肾器官功能$fof_{rf}$来区分与肾功能相关联的分量$CL_{rf}$和与肾功能无关的分量$CL_{nrf}$。所有清除率组分可能共享与公式 7 所示相同的体型大小函数，但这不是必需的。</p>
$$
\small{CL_{grp}=\left( \begin{align} CL_{nrf} \times fmat_{nrf} \times fof_{nrf} \times fgeno \times fconmed \\ + CL_{rf} \times fmat_{rf} \times fof_{rf} \end{align} \right)}  \tag{方程 7}
$$
<h1 id="参考文献中文翻译">参考文献(中文翻译):</h1>
<ol>
<li>Rhodin, M.M., et al., 人类肾脏功能成熟：使用体重和经后年龄的定量描述。Pediatric nephrology, 2009. 24(1): p. 67-76.</li>
</ol>
<h1 id="参考文献英文原文">参考文献(英文原文):</h1>
<ol>
<li>Rhodin, M.M., et al., Human renal function maturation: a quantitative description using weight and postmenstrual age. Pediatric nephrology, 2009. 24(1): p. 67-76.</li>
</ol>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/cn/2024/06/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%9C%80%E8%A6%81%E8%80%83%E8%99%91%E7%9A%84%E4%B8%80%E8%88%AC%E8%A6%81%E7%82%B9/">文献_定量药理学中的协变量建模_需要考虑的一般要点</a></span>
  <span class="nav-next"></span>
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
    url = '\/cn\/2024\/06\/%E6%96%87%E7%8C%AE_%E5%AE%9A%E9%87%8F%E8%8D%AF%E7%90%86%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%8D%8F%E5%8F%98%E9%87%8F%E5%BB%BA%E6%A8%A1_%E9%9C%80%E8%A6%81%E8%80%83%E8%99%91%E7%9A%84%E4%B8%80%E8%88%AC%E8%A6%81%E7%82%B9\/';
    
  } else if (e.which == 39) {  
    
  }
  if (url) window.location = url;
});
</script>


<script src="https://giscus.app/client.js"
        data-repo="s0521/s0521.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxNzUwMDEyNjU="
        data-category="General"
        data-category-id="DIC_kwDOCm5Osc4CUqXV"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>



  



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/R.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/tex.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/vbnet.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/SAS.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/sas.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">© <a href="https://s0521.github.io/">Yongchao Fu</a> 2019 - 2024</div>
  
  </footer>
  </article>
  
  
    
      
    
  


  </body>
</html>
