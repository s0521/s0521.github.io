<!DOCTYPE html>
<html lang="utf-8">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<script type="text/javascript"
        async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]'],['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>
    
    <title>NONMEM控制文件编写辅助插件 - Yongchao Fu | 付永超</title>
    <meta property="og:title" content="NONMEM控制文件编写辅助插件 - Yongchao Fu | 付永超">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="最近我自己写了一个NONMEM的控制文件编写的辅助插件“nonmem_cn”，这个插件是基于VSCode实现的，可以在VSCode的应用扩展插件市场中，搜索nonmem轻松下载到：
[&amp;hellip;] 1.最近在学习Pirana，并且脑海中在构思另一个作品——PML的代码编写辅助工具，因为NONMEM的语法与内容较为简单所以拉出来练手，训练下自己。
2.在查看和编辑NONMEM配置文件的时候确实 &amp;hellip;">
      <meta property="og:description" content="最近我自己写了一个NONMEM的控制文件编写的辅助插件“nonmem_cn”，这个插件是基于VSCode实现的，可以在VSCode的应用扩展插件市场中，搜索nonmem轻松下载到：
[&amp;hellip;] 1.最近在学习Pirana，并且脑海中在构思另一个作品——PML的代码编写辅助工具，因为NONMEM的语法与内容较为简单所以拉出来练手，训练下自己。
2.在查看和编辑NONMEM配置文件的时候确实 &amp;hellip;">
      
    

    
    

    

    
    

    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
<script async src="/js/load-typekit.js"></script>


<link rel="stylesheet" href="/css/custom.css" />

  </head>

  
  <body class="cn">
    <header class="masthead">
      

<h1><a href="/"><img src="/images/logo.png" alt="Yongchao Fu" /></a></h1>



      <nav class="menu">
  <ul>
  
  
  <li><a href="/">主页</a></li>
  
  <li><a href="/cn/about/">关于</a></li>
  
  <li><a href="/cn/">博客</a></li>
  
  <li><a href="/cn/vitae/">简历</a></li>
  
  <li><a href="/en/">English</a></li>
  
  <li><a href="/cn/gift/">捐助</a></li>
  
  

<li class="menu-extra"></li>



<li><a href="https://github.com/s0521/Phoenix/edit/master/content/cn/2021/02/NONMEM%e6%8e%a7%e5%88%b6%e6%96%87%e4%bb%b6%e7%bc%96%e5%86%99%e8%be%85%e5%8a%a9%e6%8f%92%e4%bb%b6.md" target="_blank">编辑</a></li>


<li><a href="/cn/index.xml" type="application/rss+xml" title="RSS feed">订阅</a></li>

<li><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="Attribution-NonCommercial-ShareAlike 4.0 International">版权</a></li>


  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>NONMEM控制文件编写辅助插件</h1>


<h3>付永超 / 
2021-02-18</h3>

<hr>


      </header>



<p>最近我自己写了一个NONMEM的控制文件编写的辅助插件“nonmem_cn”，这个插件是基于VSCode实现的，可以在VSCode的应用扩展插件市场中，搜索nonmem轻松下载到：</p>
<p><img src="/images/NONMEM%E6%8E%A7%E5%88%B6%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99%E8%BE%85%E5%8A%A9%E6%8F%92%E4%BB%B6/image-20210218213914967.png" alt="image-20210218213914967"></p>
<h1 id="初衷">初衷：</h1>
<p>1.最近在学习Pirana，并且脑海中在构思另一个作品——PML的代码编写辅助工具，因为NONMEM的语法与内容较为简单所以拉出来练手，训练下自己。</p>
<p>2.在查看和编辑NONMEM配置文件的时候确实感到一系列的不便，比如不能折叠代码，代码的高亮很奇怪，没有中文的提示，等等，进行了大量的搜索后，发现市面上有一些NONMEM语法高亮的工具，比如Pirana的内置编辑器、VSCode中已有的一个插件、Notepad++中他人贡献的自定义语法高亮配置等等，这些功能都十分孱弱与简陋，都不趁手。既然没有，那就自己写一个吧！</p>
<p><strong>如此就诞生了现在的作品。</strong></p>
<h1 id="基本信息">基本信息：</h1>
<p>扩展插件名称：nonmem_cn</p>
<p>发布日期：2021年2月18日</p>
<p>支持的后缀名：.ctl .mod .clt .lst</p>
<p>核心功能：代码块折叠、语法高亮、自动补全</p>
<p>GitHub仓库地址：<a href="https://github.com/s0521/nonmem_cn">https://github.com/s0521/nonmem_cn</a></p>
<p>nonmem_cn包介绍页面：<a href="https://s0521.github.io/nonmem_cn/about/">https://s0521.github.io/nonmem_cn/about/</a></p>
<p>扩展插件的宿主：Visual Studio Code <a href="https://code.visualstudio.com/">https://code.visualstudio.com/</a></p>
<h1 id="主要实现功能">主要实现功能：</h1>
<ul>
<li>
<h2 id="代码块折叠">代码块折叠</h2>
</li>
</ul>
<p><img src="/images/NONMEM%E6%8E%A7%E5%88%B6%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99%E8%BE%85%E5%8A%A9%E6%8F%92%E4%BB%B6/Folding.gif" alt=""></p>
<p>此项功能是目前市面上所有其他NONMEM控制文件编写辅助工具中都没有的功能，目前是我开发的“nonmem_cn”扩展插件所独有的~！</p>
<ul>
<li>
<h2 id="自动补全">自动补全</h2>
</li>
</ul>
<p><img src="/images/NONMEM%E6%8E%A7%E5%88%B6%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99%E8%BE%85%E5%8A%A9%E6%8F%92%E4%BB%B6/snippets.gif" alt=""></p>
<p>代码自动补全功能，此功能实现不能，但想实现的足够好很难，无论是代码层面还是对关键字的注释能力层面，我实现了一些基础的代码补全功能，给与了中英文双语直观简洁的非官方的注释，看起来格外清晰。</p>
<p>另外，当前的代码补全功能中包含的中文注释信息也是目前“nonmem_cn”扩展插件所独有的~！</p>
<ul>
<li>
<h2 id="语法高亮">语法高亮</h2>
<p><img src="/images/NONMEM%E6%8E%A7%E5%88%B6%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99%E8%BE%85%E5%8A%A9%E6%8F%92%E4%BB%B6/Highlight.png" alt=""></p>
</li>
</ul>
<p>语法高亮没啥说的，如果硬要说亮点，就是一下这些：</p>
<p>当前的亮点是我特别突出的等号、运算法、数字这三者，</p>
<p>高亮的颜色会随者你使用的VSCode主题不同而发生变化。</p>
<h1 id="读者你可以做的贡献">读者你可以做的贡献</h1>
<p>当前的自动补全的注释信息和补全的内容其实还不够多，只有105个关键词，所以如果想变得更好还需要额外的在补充与添加。</p>
<p>我已经将补充额外新的内容的工作做了极大的简化，在该插件所对应的github仓库<a href="https://github.com/s0521/nonmem_cn">https://github.com/s0521/nonmem_cn</a>中，其主页下可以看到两个csv文件（“Highlight.csv”、“snippets.csv”），和一个excel文件（“语法高亮.xlsx”）。</p>
<p><img src="/images/NONMEM%E6%8E%A7%E5%88%B6%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99%E8%BE%85%E5%8A%A9%E6%8F%92%E4%BB%B6/image-20210218220402917.png" alt="image-20210218220402917"></p>
<p>两个CSV文件来自于Excel另存为获得。</p>
<p>读者你可下载其中的某个CSV文件，来通过增加行的方式仿照已有的行来增加内容，进而丰富语法高亮规则，或者代码补全关键词。</p>
<h2 id="hightlightcsv">Hightlight.csv</h2>
<p>该表格是语法高亮规则，内容如下图：</p>
<p><img src="/images/NONMEM%E6%8E%A7%E5%88%B6%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99%E8%BE%85%E5%8A%A9%E6%8F%92%E4%BB%B6/image-20210218220805731.png" alt="image-20210218220805731"></p>
<p>该表格中，第一行是列名，其余行是具体的规则，唯一重要的部分是C列和F列，其余列是用来辅助说明的，便于读者的你理解用，</p>
<p>所以如果你有能力可以在新增的行中完成所有列的及内容撰写，</p>
<p>如果能力不强，也可以完成B列和E列的内容，然后我有空时额外进行补全。</p>
<h2 id="snippetscsv">snippets.csv</h2>
<p>该表格是代码补全的候选关键字列表，内容如下图：</p>
<p><img src="/images/NONMEM%E6%8E%A7%E5%88%B6%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99%E8%BE%85%E5%8A%A9%E6%8F%92%E4%BB%B6/image-20210218221212469.png" alt="image-20210218221212469"></p>
<p>该表格中，第1行至第6行都是对列的介绍性文字，便于读者理解列的用于与含义，从第7行开始到最后是具体的候选词及注释列表。</p>
<p>从列来看，第1列没有用主要是添加了对第一行至第六行内容的说明，第2列也没啥用仅仅用来表示下序号，</p>
<p>C列：自动补全时匹配的内容；</p>
<p>D列：选择候选列表中某一项后，实际在代码中写入的内容；</p>
<p>E列：候选列表中右侧的那些提示性文字，这些文字必须相对其他行的内容来说独一无二，位置如下图所示；</p>
<p><img src="/images/NONMEM%E6%8E%A7%E5%88%B6%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99%E8%BE%85%E5%8A%A9%E6%8F%92%E4%BB%B6/image-20210218221836270.png" alt="image-20210218221836270"></p>
<p>F列：英文注释，选填，注释内容是出现在选则候选列表中的某一项时，额外出现在右侧或下侧等位置的一个方框中的上半部分区域的内容，我将英文注释与中问注释通过分号“；”和在一起同时显示；</p>
<p>E列：中文注释，选填，注释内容是出现在选则候选列表中的某一项时，额外出现在右侧或下侧等位置的一个方框中的上半部分区域的内容，我将英文注释与中问注释通过分号“；”和在一起同时显示。</p>
<p>该表格是代码补全的核心内容，也是最需要耗费时间、精力、知识来添加的地方。</p>
<p>所以如果你愿意，可以贡献下你的知识帮助我来进一步丰富“nonmem_cn”的功能，未来我也会考虑将此列表的内容加入到悬停提示中去。</p>
<h1 id="结语">结语</h1>
<p>好了，就到这里告一段落吧！</p>
<p>愿此插件能够帮助到你，帮助到NONMEM社区中的更多的人。</p>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/cn/2021/01/%E4%B8%AD%E5%9B%BDcde_2020%E5%B9%B4_%E7%BE%A4%E4%BD%93%E8%8D%AF%E4%BB%A3%E5%8A%A8%E5%8A%9B%E5%AD%A6%E7%A0%94%E7%A9%B6%E6%8A%80%E6%9C%AF%E6%8C%87%E5%AF%BC%E5%8E%9F%E5%88%99/">中国CDE_2020年_群体药代动力学研究技术指导原则</a></span>
  <span class="nav-next"><a href="/cn/2021/07/%E5%9C%A8phoenix%E4%B8%AD%E5%A4%84%E7%90%86bql%E5%80%BC%E7%9A%84%E5%A4%9A%E7%A7%8D%E6%96%B9%E6%B3%95%E5%8F%8A%E5%85%B6%E5%AE%9E%E7%8E%B0/">在Phoenix中处理BQL值的多种方法及其实现</a> &rarr;</span>
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
    url = '\/cn\/2021\/01\/%E4%B8%AD%E5%9B%BDcde_2020%E5%B9%B4_%E7%BE%A4%E4%BD%93%E8%8D%AF%E4%BB%A3%E5%8A%A8%E5%8A%9B%E5%AD%A6%E7%A0%94%E7%A9%B6%E6%8A%80%E6%9C%AF%E6%8C%87%E5%AF%BC%E5%8E%9F%E5%88%99\/';
    
  } else if (e.which == 39) {  
    
    url = '\/cn\/2021\/07\/%E5%9C%A8phoenix%E4%B8%AD%E5%A4%84%E7%90%86bql%E5%80%BC%E7%9A%84%E5%A4%9A%E7%A7%8D%E6%96%B9%E6%B3%95%E5%8F%8A%E5%85%B6%E5%AE%9E%E7%8E%B0\/';
    
  }
  if (url) window.location = url;
});
</script>


<script src="https://giscus.app/client.js"
        data-repo="s0521/s0521.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxNzUwMDEyNjU="
        data-category="General"
        data-category-id="DIC_kwDOCm5Osc4CUqXV"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>


<script async src="/js/fix-toc.js"></script>

<script async src="/js/center-img.js"></script>

<script async src="/js/right-quote.js"></script>

<script async src="/js/no-highlight.js"></script>

<script async src="/js/fix-footnote.js"></script>

<script async src="/js/math-code.js"></script>

<script async src="/js/external-link.js"></script>

<script async src="/js/alt-title.js"></script>

<script async src="/js/header-link.js"></script>




  

  
  <hr>
  <div class="copyright">© <a href="https://s0521.github.io/">Yongchao Fu</a> 2019 - 2020</div>
  
  </footer>
  </article>
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-138584476-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </body>
</html>
